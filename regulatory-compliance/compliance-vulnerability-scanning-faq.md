# Compliance & Vulnerability Scanning Frequently Asked Questions
Many customers employ security & compliance scanning tools to assist them during audits of their environments. This is a collection of common questions posed to VMware about this process.

Questions
---------

## Can VMware recommend a vulnerability scanning tool?
VMware cannot recommend specific scanning tools. While we don't directly support scanning tools, we do support the use of approved APIs and clients. We recommend choosing a solution that specifically lists vSphere as a supported scanning target, as this indicates the vendor understands vSphere's architecture and deployment model.

## My scanning tool is asking me whether ESXi is Linux or UNIX. Which one should I pick?
VMware ESXi is its own distinct operating system - it is neither Linux nor UNIX. If your scanning tool doesn't specifically support VMware vSphere components, you should either avoid using it on your environment or limit it to network-based scanning only. Attempting to scan ESXi as if it were a Linux or UNIX host will, at best, generate false positives and waste staff time investigating these incorrect findings.

## What is the best way to scan ESXi via SSH?
SSH and command shells (ESXi Shell) on vSphere components, like ESXi and vCenter Server, are maintenance and support tools designed for temporary use only. ESXi ships with both SSH and the ESXi Shell disabled by default, and vCenter Server raises alarms if either is enabled and running. Neither is intended for operational use on the host.

There are no customer-serviceable components inside ESXi. ESXi is delivered and maintained as a single software image, similar to network switch firmware, and modifying permissions or software within that image may impact both system availability and supportability.

We strongly recommend keeping SSH disabled and having scanning tools check version information to determine if updates are available.

## What distribution of Linux do vCenter Server, SDDC Manager, and other appliances use?
[Photon Linux](https://vmware.github.io/photon/) is the foundation, a Linux distribution maintained by Broadcom.

While VMware virtual appliances are built on Linux, they are not general-purpose computing platforms. Modifying them in any way outside of official guidance is unsupported. These appliances are designed to be updated only through official APIs and interfaces.

It's more appropriate to think of these appliances like network switch firmware, where the OS would be "VMware vCenter" rather than a Linux distribution. This perspective helps change management teams and other organizational staff understand that these appliances require different management approaches than typical Linux systems.

## My scanner says it found insecure TLS ciphers. Am I vulnerable?
Probably not.

Security scanners are designed to identify all potential vulnerabilities in a system and cast a wide net in doing so. They typically flag anything as a vulnerability if it doesn't specifically match their known "good state." While this thoroughness is generally beneficial, it means that a human needs to review the report and determine if each finding represents a genuine vulnerability. Unfortunately, most people reviewing these reports aren't experts in cryptographic details!

When evaluating TLS ciphers, scanners rely on current best-practice guidance. If they find a cipher that isn't listed in their current recommendations, they'll flag it as a vulnerability. However, scanners don't consider factors like interoperability, backward compatibility, performance, or other system design and operational requirements.

vSphere uses TLS 1.2 and TLS 1.3 for communication, unless you've explicitly configured an insecure connection (see [Network Encryption in VMware vSphere 8](https://github.com/vmware/vcf-security-and-compliance-guidelines/blob/main/regulatory-compliance/vsphere/8.0/VMware-vSphere-8-Network-Encryption.md) for details). We've thoroughly evaluated the default cipher configurations and don't consider any of them to be insecure or vulnerable. These defaults are re-evaluated with each major release.

However, cryptographic standards evolve, and newer ciphers may offer improved security when your environment can support them. For this reason, we've introduced TLS Profiles in vSphere 8.0.3 and later versions, allowing you to enable modern, NIST-compliant ciphers. For implementation guidance, consult the [Security Configuration Guide](https://bit.ly/vcf-scg) and/or the product documentation.

## My scanner says it found web servers that don't use HSTS. Am I vulnerable?
Probably not, similar to the situation with TLS ciphers.

HSTS (HTTP Strict Transport Security) is a web security feature that helps protect against attacks attempting to downgrade a website's security. It's a feature of the HTTP protocol and isn't specific to vSphere or VMware. While HSTS enforcement is supported by modern browsers and is browser-driven, this actually makes it a relatively weak way to establish trust inside a system like vSphere, especially when connections aren't coming from browsers.

When a browser first visits a website, it receives an HSTS header from the server. The browser stores this information and uses it on subsequent visits to determine if the website should be accessed securely.

This approach has several limitations:
1. There's a "bootstrapping" problem - you have to trust the website on your first visit
2. It relies on browser caches, so clearing your cache removes all HSTS data
3. It doesn't provide any additional certificate validation beyond what browsers normally do

Since HSTS is a browser technology, VMware products support it only on interfaces designed for browser access - typically port 443/TCP for management UIs and port 5480/TCP for VAMI/appliance management.

While there are many other network ports used by internal VMware product components that use TLS for communication, these don't use HSTS because they aren't browser-facing. Instead, VMware vSphere, vSAN, and Cloud Foundation use other, more robust methods to establish trust between components.

## My scanner says it found critical vulnerabilities or other issues. How do I fix those?
VMware tracks all software installed and used within our products. When security or functional issues are reported in external projects, VMware assesses their impact according to the VMware Security Response Policy (below). If necessary, product updates are made available through supported update mechanisms following the response policy schedule.

Scanners can make mistakes, and reported issues need careful investigation. For example, many scanners test for specific malware or web shells. When web applications redirect requests to landing pages or login screens, scanners may misinterpret these redirects as vulnerabilities if they don't receive an expected "404 File Not Found" response. While these findings warrant investigation, they don't always indicate actual vulnerabilities.

If you're uncertain about an issue or its severity, please open a case with VMware Global Support. They can help validate the report and escalate to VMware Product Security staff as necessary.

Modifying file permissions or software components without explicit guidance from VMware Global Support is unsupported and may impact:
- System availability
- Serviceability
- Support status of your infrastructure

VMware is committed to the security and stability of our products and customers. If you have concerns, the first step should be opening a support case with VMware Global Support.

[VMware Product Security: An Overview of VMware's Security Programs and Practices](https://www.vmware.com/docs/vmware-product-security-white-paper)
[VMware External Vulnerability Response and Remediation Policy](https://www.broadcom.com/support/vmware-services/security-response)

## My scanning tool discovered permission problems when scanning ESXi. How do I fix those?
ESXi is neither Linux nor UNIX and does not follow their permission models. Because SSH and the ESXi Shell are intended for maintenance only, and ESXi is not a traditional multiuser operating system, users logging in through these mechanisms intentionally have administrator/root-level permissions.

ESXi 7 and newer loads its operating system image into a RAMdisk at system boot. Any direct changes to configuration files will not persist across system reboots.

## My scanning tool discovered a vulnerability in an appliance component, and I replaced the package with one from another Linux distribution. Now things don't work right. How do I fix this?
Manually changing components is unsupported and can cause severe availability and functionality problems. Please open a support case with VMware Global Support for assistance.

## If I shouldn't use SSH how will I configure my ESXi host?
There are several supported methods for configuring ESXi and vCenter Server, through both GUI and API/CLI interfaces:
- Host Profiles
- Configuration Profiles
- PowerCLI
- esxcli
- SDDC Manager

The developer.broadcom.com site provides numerous examples and options in various scripting and programming languages. By managing ESXi through vCenter Server, you can also leverage vCenter's comprehensive role-based access control (RBAC) capabilities.

## Can I disable SSH if it is enabled?
Yes, and we recommend doing so to improve security and reduce audit scope. Please consult the vSphere documentation and [Security Configuration Guide](https://bit.ly/vcf-scg) for your version.

## Are there any problems with network-based scanning?
vSphere is a robust and mature infrastructure product that can handle routine network scanning. We recommend this testing progression:
1. Test your scanner in a test environment (nested ESXi works well for this)
2. Scan a subset of production hosts in maintenance mode
3. Proceed to scanning your full environment

This approach builds confidence and helps you evaluate results more effectively.

## Is there a way to limit users logging in to ESXi?
Yes, you can control access through:
- The DCUI.Access advanced option
- Lockdown Mode
- Shell access restrictions (new in ESXi 8.0.0)

We recommend:
1. Limiting ESXi shell access to staff directly involved with hardware support
2. Carefully considering dependencies to ensure support teams can recover systems during incidents
3. Having staff interact with ESXi through vCenter Server to leverage its comprehensive role-based access control (RBAC)

Note that disabling local account shell access (ESXi 8.0.0+) can have side effects. For detailed guidance, consult the vSphere 8 [Security Configuration Guide](https://bit.ly/vcf-scg).

## Are there default accounts created on vCenter Server or ESXi?
Yes, there are several default accounts:

For vCenter Server:
- administrator@vsphere.local (or your specified domain) is created during installation with your specified password

For ESXi:
- 'root' account with installation-specified password
- 'vpxuser' account for privilege separation
- 'dcui' account for console application access

Additional service accounts exist in appliances like vCenter Server for privilege separation and least privilege implementation.

System accounts in Linux-based appliances are secured by default, with locked passwords and login-prevented shells (/sbin/nologin or /bin/false).

For comprehensive information about default accounts and their purposes, please refer to [Default Accounts in vSphere 8](https://github.com/vmware/vcf-security-and-compliance-guidelines/blob/main/regulatory-compliance/vsphere/8.0/VMware-vSphere-8-Default-Accounts.md).

## My compliance folks are insisting that they be granted SSH access to vSphere. What do I tell them?
SSH is a troubleshooting and support interface that is:
- Not enabled in default installations
- Only intended for temporary use during troubleshooting
- Unable to implement least-privilege access due to ESXi Shell's permission model

Important points to consider:
1. There are no user-serviceable components accessible via SSH
2. Component replacement through SSH voids support
3. vCenter Server and ESXi must be evaluated as complete units
4. Enabling SSH reduces security and increases attack surface
5. VMware's best practices and documentation explicitly recommend keeping SSH disabled

Compliance implications:
- Enabling SSH for scanning typically generates false findings
- This wastes staff time and increases audit costs with no security benefit
- It creates a paradox where auditors request a configuration that their own audit will then flag as insecure
- These findings would not exist if SSH remained disabled as designed

This situation is analogous to storage array controllers, where vendors don't permit access even though SSH may be running for support purposes.

Consider scanning environments in their standard operational state. Enabling SSH for scanning:
- Decreases security
- Increases management complexity
- Goes against vendor recommendations
- Creates artificial compliance issues

## If we still want to scan vCenter Server and/or ESXi via SSH, what's the best way?
We strongly recommend using a test environment for this purpose. You can:
1. Deploy a secondary, non-production vCenter Server
2. Install ESXi inside virtual machines (nested ESXi)
3. Use identical software versions to your production environment
4. Create representative configurations
5. Leverage snapshots when the nested environment is powered off for easy testing rollback

This approach minimizes the risk of operational and support incidents in your production environments.

Note: While nested vSphere (used in VMware Hands-on Labs) makes this testing possible, it is not supported by VMware Global Support. However, numerous community resources exist for creating these test environments.