SCG ID,"Secure Controls
Framework ID",DISA STIG ID,PCI DSS 4.0.1 ID,"Component
Name",Component Version,Feature/Function,Description/Title,Discussion,Potential Functional Impact if Default Value is Changed,"Implementation
Priority",Configuration Parameter,Installation Default Value,Baseline Suggested Value,Is the Default?,Action Needed,Setting Location,PowerCLI Command Assessment,PowerCLI Command Remediation
esx-9.account-lockout-duration,"IAC-22
IAC-10
IAC-10.1",VCFE-9X-000108,8.3.4,ESX,9.0.0,Base,The ESX host must enforce an unlock timeout of 15 minutes.,"By enforcing a reasonable unlock timeout after multiple failed logon attempts, the risk of unauthorized access via user password guessing, otherwise known as brute forcing, is reduced. Users must wait for the timeout period to elapse before subsequent logon attempts are allowed.",None.,P2,Security.AccountUnlockTime,900,900,YES,Audit,"ESX Advanced
System Settings",Get-VMHost -Name $ESX | Get-AdvancedSetting Security.AccountUnlockTime,Get-VMHost -Name $ESX | Get-AdvancedSetting Security.AccountUnlockTime | Set-AdvancedSetting -Value 900
esx-9.account-lockout-max-attempts,"IAC-22
IAC-10
IAC-10.1",VCFE-9X-000005,8.3.4,ESX,9.0.0,Base,The ESX host must enforce the limit of five consecutive invalid logon attempts by a user.,"Protects against brute-force attacks and unauthorized access attempts by temporarily disabling the affected account, preventing further login attempts until the lockout period expires or is manually reset by an administrator.","A low threshold for login failures can create an avenue for denial-of-service attacks, whether intentional or unintentional, such as with SSH connection retries.",P2,Security.AccountLockFailures,5,5,YES,Audit,"ESX Advanced
System Settings",Get-VMHost -Name $ESX | Get-AdvancedSetting Security.AccountLockFailures,Get-VMHost -Name $ESX | Get-AdvancedSetting Security.AccountLockFailures | Set-AdvancedSetting -Value 5
esx-9.account-password-history,"IAC-10.1
IAC-10",N/A,8.3.7,ESX,9.0.0,Base,The ESX host must enforce password history for users.,Protects against reuse of passwords.,None.,P2,Security.PasswordHistory,5,5,YES,Audit,"ESX Advanced
System Settings",Get-VMHost -Name $ESX | Get-AdvancedSetting Security.PasswordHistory,Get-VMHost -Name $ESX | Get-AdvancedSetting Security.PasswordHistory | Set-AdvancedSetting -Value 5
esx-9.ad-admin-group-autoadd,IAC-21,VCFE-9X-000240,7.2.2,ESX,9.0.0,Active Directory,The ESX host must not automatically grant administrative permissions to Active Directory groups.,"When adding ESX hosts to Active Directory, the group specified by the ""Config.HostAgent.plugins.hostsvc.esxAdminsGroup"" advanced setting can be automatically granted administrative access to ESX. This behavior should be disabled and access intentionally granted if appropriate.",Access must be granted manually.,P2,Config.HostAgent.plugins.hostsvc.esxAdminsGroupAutoAdd,FALSE,FALSE,YES,Audit,"ESX Advanced
System Settings",Get-VMHost -Name $ESX | Get-AdvancedSetting Config.HostAgent.plugins.hostsvc.esxAdminsGroupAutoAdd,Get-VMHost -Name $ESX | Get-AdvancedSetting Config.HostAgent.plugins.hostsvc.esxAdminsGroupAutoAdd | Set-AdvancedSetting -Value FALSE
esx-9.ad-admin-group-name,IAC-10.8,VCFE-9X-000239,7.2.2,ESX,9.0.0,Active Directory,The ESX host must not use the default Active Directory ESX Admin group.,"When adding ESX hosts to Active Directory, all user/group accounts assigned to the Active Directory group ""ESX Admins"" will have full administrative access to the host.
 
If this group is not controlled or known to the system administrators, it may be used for inappropriate access to the host. Therefore, the default group must be changed to a site-specific Active Directory group and membership must be severely restricted.",None.,P0,Config.HostAgent.plugins.hostsvc.esxAdminsGroup,"""ESX Admins""","Anything But ""ESX Admins""",NO,Modify,"ESX Advanced
System Settings",Get-VMHost -Name $ESX | Get-AdvancedSetting Config.HostAgent.plugins.hostsvc.esxAdminsGroup,Get-VMHost -Name $ESX | Get-AdvancedSetting Config.HostAgent.plugins.hostsvc.esxAdminsGroup | Set-AdvancedSetting -Value $ANYTHING_ELSE
esx-9.ad-admin-validate-interval,IAC-17,VCFE-9X-000241,7.2.4,ESX,9.0.0,Active Directory,The ESX host must not disable validation of users and groups.,"When joined to Active Directory, ESX will periodically validate group membership for any groups with permissions to the host. This process ensures any changes made to groups in Active Directory are synced to ESX and must not be disabled.",None.,P2,Config.HostAgent.plugins.vimsvc.authValidateInterval,90,90,YES,Audit,"ESX Advanced
System Settings",Get-VMHost -Name $ESX | Get-AdvancedSetting Config.HostAgent.plugins.vimsvc.authValidateInterval,Get-VMHost -Name $ESX | Get-AdvancedSetting Config.HostAgent.plugins.vimsvc.authValidateInterval | Set-AdvancedSetting -Value 90
esx-9.api-soap-timeout,IAC-25,VCFE-9X-000226,8.2.8,ESX,9.0.0,Base,The ESX host must configure a session timeout for the vSphere API.,"This practice helps mitigate potential security risks by ensuring that unattended sessions, which could be exploited by unauthorized users or malicious software, are not left open indefinitely.",None.,P2,Config.HostAgent.vmacore.soap.sessionTimeout,30,30,YES,Audit,"ESX Advanced
System Settings",Get-VMHost -Name $ESX | Get-AdvancedSetting Config.HostAgent.vmacore.soap.sessionTimeout,Get-VMHost -Name $ESX | Get-AdvancedSetting Config.HostAgent.vmacore.soap.sessionTimeout | Set-AdvancedSetting -Value 30
esx-9.cpu-hyperthread-warning,END-04.7,VCFE-9X-000227,5.3.5,ESX,9.0.0,Base,The ESX host must not suppress warnings about unmitigated hyperthreading vulnerabilities.,"Hyperthreading security warnings signify unaddressed CPU vulnerabilities in the system, and ignoring these could mask potential risks. Ensure that hardware remediations align with your organization's accepted risk, and if suppressing a warning, document the decision and rationale.",None.,P2,UserVars.SuppressHyperthreadWarning,0,0,YES,Audit,"ESX Advanced
System Settings",Get-VMHost -Name $ESX | Get-AdvancedSetting UserVars.SuppressHyperthreadWarning,Get-VMHost -Name $ESX | Get-AdvancedSetting UserVars.SuppressHyperthreadWarning | Set-AdvancedSetting -Value 0
esx-9.dcui-timeout,IAC-25,VCFE-9X-000201,8.2.8,ESX,9.0.0,Base,Set a timeout to automatically terminate idle DCUI sessions on the ESX host.,"DCUI allows direct login to the ESX host for managing tasks. To prevent unintended DCUI usage from leftover login sessions, It is essential to terminate idle connections.",None.,P2,UserVars.DcuiTimeOut,600,600,YES,Audit,"ESX Advanced
System Settings",Get-VMHost -Name $ESX | Get-AdvancedSetting UserVars.DcuiTimeOut,Get-VMHost -Name $ESX | Get-AdvancedSetting UserVars.DcuiTimeOut | Set-AdvancedSetting -Value 600
esx-9.deactivate-mob,CFG-03,VCFE-9X-000046,2.2.4,ESX,9.0.0,Base,The ESX Managed Object Browser (MOB) should be deactivated.,Services which are not in use and are not essential for operations should be deactivated.,None.,P2,Config.HostAgent.plugins.solo.enableMob,False,False,YES,Audit,"ESX Advanced
System Settings",Get-VMHost -Name $ESX | Get-AdvancedSetting Config.HostAgent.plugins.solo.enableMob,Get-VMHost -Name $ESX | Get-AdvancedSetting Config.HostAgent.plugins.solo.enableMob | Set-AdvancedSetting -Value False
esx-9.deactivate-shell,CFG-03,VCFE-9X-000199,2.2.4,ESX,9.0.0,Base,The ESX shell should be deactivated.,Services which are not in use and are not essential for operations should be deactivated.,None.,P2,N/A,"Stopped,
Start and stop manually","Stopped,
Start and stop manually",YES,Audit,ESX Services Configuration,"Get-VMHostService -VMHost $ESX | Where-Object {$_.Key -eq 'TSM' -and $_.Running -eq 'True'}
Get-VMHostService -VMHost $ESX | Where-Object {$_.Key -eq 'TSM' -and $_.Policy -eq 'On'}","Get-VMHostService -VMHost $ESX | where {$_.Key -eq 'TSM'} | Set-VMHostService -Policy Off
Get-VMHostService -VMHost $ESX | where {$_.Key -eq 'TSM'} | Stop-VMHostService"
esx-9.disable-accounts-dcui,IAC-15.7,VCFE-9X-000237,2.2.4,ESX,9.0.0,Base,VMware ESX must have the dcui account disabled.,"Disabling expired, inactive, unused, or otherwise anomalous accounts supports the concepts of least privilege and least functionality which reduce the attack surface of the system.

ESX ships with a 'dcui' account used for privilege separation whose shell access should be restricted.",None.,P0,N/A,Enabled,Disabled,NO,Modify,esxcli,"$ESXcli = Get-EsxCli -VMHost $ESX -V2
$ESXcli.system.account.list.Invoke() | Where-Object { $_.UserID -eq 'dcui' } | Select-Object -ExpandProperty Shellaccess","$ESXcli = Get-EsxCli -VMHost $ESX -V2
$arguments = $ESXcli.system.account.set.CreateArgs()
$arguments.id = ""dcui""
$arguments.shellaccess = ""false""
$ESXcli.system.account.set.Invoke($arguments)"
esx-9.entropy,CRY-01,VCFE-9X-000234,"2.2.7
3.3.2
3.3.3
8.3.2",ESX,9.0.0,Base,The ESX host must use sufficient entropy for cryptographic operations.,"Starting in vSphere 8.0, the ESX Entropy implementation supports the FIPS 140-3 and EAL4 certifications. Kernel boot options control which entropy sources to activate on an ESX host.",None.,P2,N/A,"disableHwrng = FALSE
entropySources = 0","disableHwrng = FALSE
entropySources = 0",YES,Audit,ESX Shell,"$ESXcli = Get-EsxCli -VMHost $ESX -V2
$ESXcli.system.settings.kernel.list.Invoke() | Where {$_.Name -eq ""disableHwrng"" -or $_.Name -eq ""entropySources""}","$ESXcli = Get-EsxCli -VMHost $ESX -V2
$arguments = $ESXcli.system.settings.kernel.set.CreateArgs()
$arguments.setting = ""disableHwrng""
$arguments.value = ""FALSE""
$ESXcli.system.settings.kernel.set.invoke($arguments)
$arguments.setting = ""entropySources""
$arguments.value = ""0""
$ESXcli.system.settings.kernel.set.invoke($arguments)"
esx-9.etc-issue,SEA-18,"VCFE-9X-000196
VCFE-9X-000197",2.2.6,ESX,9.0.0,Base,Configure the login banner for ESX host SSH connections.,"ESX enables a login message display, often used to deter intruders and inform authorized users about system use obligations. This parameter defines the text shown during an SSH connection. It is highly recommended to keep SSH in the stopped state unless troubleshooting.

An implementation inconsistency between ESX and vCenter Server requires that ""issue"" in Config.Etc.issue be lowercase, to work in both scenarios.",None.,P1,Config.Etc.issue,Undefined,"Consult your organization's legal advisors for text that is applicable to your environment.

An example is: ""Authorized users only. Actual or attempted unauthorized use of this system is prohibited and may result in criminal, civil, security, or administrative proceedings and/or penalties. Use of this information system indicates consent to monitoring and recording, without notice or permission. Users have no expectation of privacy in any use of this system. Any information stored on, or transiting this system, or obtained by monitoring and/or recording, may be disclosed to law enforcement and/or used in accordance with Federal law, State statute, and organization policy. If you are not an authorized user of this system, exit the system at this time.""",NO,Modify,"ESX Advanced
System Settings",Get-VMHost -Name $ESX | Get-AdvancedSetting Config.Etc.issue,"Get-VMHost -Name $ESX | Get-AdvancedSetting Config.Etc.issue | Set-AdvancedSetting -Value ""****************************************************************************`n* Authorized users only. Actual or attempted unauthorized use of this      *`n* system is prohibited and may result in criminal, civil, security, or     *`n* administrative proceedings and/or penalties. Use of this information     *`n* system indicates consent to monitoring and recording, without notice     *`n* or permission. Users have no expectation of privacy. Any information     *`n* stored on or transiting this system, or obtained by monitoring and/or    *`n* recording, may be disclosed to law enforcement and/or used in accordance *`n* with Federal law, State statute, and organization policy. If you are not *`n* an authorized user of this system, exit the system at this time.         *`n****************************************************************************`n"""
esx-9.firewall-incoming-default,NET-04.1,VCFE-9X-000216,"1.4.1
1.4.2",ESX,9.0.0,Base,The ESX host must configure the firewall to block network traffic by default.,"Ensures that all incoming and outgoing network traffic is blocked unless explicitly allowed, reducing the attack surface and preventing unauthorized access to the host.",None.,P2,N/A,Enabled,Enabled,YES,Audit,esxcli,Get-VMHost -Name $ESX | Get-VMHostFirewallDefaultPolicy,"$ESXcli = Get-EsxCli -VMHost $ESX -V2
$arguments = $ESXcli.network.firewall.set.CreateArgs()
$arguments.defaultaction = $FALSE
$arguments.enabled = $true
$ESXcli.network.firewall.set.Invoke($arguments)"
esx-9.firewall-restrict-access,NET-04.1,VCFE-9X-000217,"1.4.1
1.4.2",ESX,9.0.0,Base,Configure the ESX host firewall to only allow traffic from authorized networks.,"Ensures that all incoming and outgoing network traffic is blocked unless explicitly allowed, reducing the attack surface and helping to prevent unauthorized access to the host.

As of vSphere 8.0.2, firewall rules are categorized as 'user' or 'system' owned, where only 'user' owned rules are configurable. Beginning in vSphere 8 Update 2b and PowerCLI 13.2.1 there are additional queryable parameters to automate setting and checking for configurable rules.","Firewall is simplistic, akin to router ACLs, and may need reflexive rules configured.",P1,N/A,Connections allowed from any IP address,Connections allowed only from authorized infrastructure and administration workstations,NO,Modify,ESX Firewall Configuration,"$ESXcli = Get-EsxCli -VMHost $ESX -V2
$list = $ESXcli.network.firewall.ruleset.list.Invoke() | Where {($_.AllowedIPconfigurable -eq $true) -and ($_.EnableDisableconfigurable -eq $true)} | Select -ExpandProperty Name

$arguments = $ESXcli.network.firewall.ruleset.allowedip.list.CreateArgs()
foreach ($rule in $list) {
    $arguments.rulesetid = $rule
    $ESXcli.network.firewall.ruleset.allowedip.list.Invoke($arguments) 
}","# This is an example which you will want to customize!
$ESXcli = Get-EsxCli -VMHost $ESX -V2
# Deactivate firewall temporarily so we don't lose connectivity
$arguments = $ESXcli.network.firewall.set.CreateArgs()
$arguments.enabled = $false
$ESXcli.network.firewall.set.Invoke($arguments)

# Unset the ""allow all"" flag
$arguments = $ESXcli.network.firewall.ruleset.set.CreateArgs()
$arguments.allowedall = $false
$arguments.rulesetid = ""sshServer""
$ESXcli.network.firewall.ruleset.set.Invoke($arguments)

# Add an IP range
$arguments = $ESXcli.network.firewall.ruleset.allowedip.add.CreateArgs()
$arguments.ipaddress = ""192.168.0.0/16""
$arguments.rulesetid = ""sshServer""
$ESXcli.network.firewall.ruleset.allowedip.add.Invoke($arguments)

# Enable the firewall
$arguments = $ESXcli.network.firewall.set.CreateArgs()
$arguments.enabled = $true
$ESXcli.network.firewall.set.Invoke($arguments)"
esx-9.hardware-boot,"END-06.5
MON-04",N/A,2.2.6,ESX,9.0.0,Hardware,"The environment must use adequately sized persistent, non-SD, non-USB devices for ESX boot volumes.","Flash memory is a component that wears out over time, with each data write shortening its lifespan. SSDs and NVMe devices have built-in features to reduce this wear, making them more reliable. However, SD cards and most USB flash drives don't have these features and can develop reliability issues, like bad sectors, often without any obvious signs.

To lessen wear and make SD and USB devices last longer, ESX, when installed on these devices, saves audit and system logs to a RAM disk instead of constantly writing to the device. This means a virtual infrastructure administrator needs to set up new, long-term storage spots for these logs and change the log output to go to these new places.

Choosing a reliable boot device removes these extra steps and helps ESX automatically pass security audits.",None.,P0,N/A,N/A,N/A,N/A,Audit,Hardware,N/A,N/A
esx-9.hardware-cpu-amd-cc,"SEA-10
CRY-01
END-06.6",N/A,5.2.3,ESX,9.0.0,Hardware,"Ensure that AMD SEV-ES and/or SEV-SNP is enabled, if available in the system firmware, and is configured for a reasonable number of protected VMs (Minimum SEV non-ES ASID).","AMD EPYC platforms support SEV-ES and SEV-SNP, technology to encrypt memory and CPU register state and attest workloads in order to increase workload security and decrease exposure to certain types of attacks. When configured properly, VCF supprots the use of these technologies inside guest virtual machines and containers. Enabling them in system firmware eases future enablement inside virtual machines, containers, and guest OSes.","Use of SEV-ES/SEV-SNP in a particular VM requires the guest OS to support it, and will limit some operational features such as vMotion, snapshots, and so on. Consult the documentation for more information about these tradeoffs.",P1,N/A,N/A,N/A,N/A,Audit,Hardware,N/A,N/A
esx-9.hardware-cpu-intel-cc,"SEA-10
CRY-01
END-06.6",N/A,5.2.3,ESX,9.0.0,Hardware,"Ensure that Intel SGX and/or TDX is enabled, if available in the system firmware.","Intel Xeon Scalable Processor platforms have SGX and TDX, technologies that help applications protect data in system memory. When configured properly, VCF supports the use of SGX inside guest virtual machines. Enabling them in system firmware eases future enablement inside virtual machines and guest OSes.","Use of SGX/TDX requires guest OS support, and will limit some operational features, such as vMotion, snapshots, fault tolerance, and suspend/resume.",P1,N/A,N/A,N/A,N/A,Audit,Hardware,N/A,N/A
esx-9.hardware-cpu-intel-txt,"END-06.5
END-06.6
END-06.1
TDA-14.1",N/A,5.2.3,ESX,9.0.0,Hardware,"Ensure that Intel TXT is enabled, if available in the system firmware.","Intel Xeon Scalable Processor platforms have Trusted Execution Technology, or TXT, that help harden systems against malware, rootkits, BIOS & firmware attacks, and more. When enabled, ESX will take advantage of security benefits offered by this technology.","There have been some situations in early implementations where operations like firmware updates and sudden system shutdowns trigger attestation alarms in vCenter Server, or even failures while booting. In these cases a cold system restart resolves the problem temporarily, while an update to system firmware usually resolves it permanently. See KB 78243.",P0,N/A,N/A,N/A,N/A,Audit,Hardware,(Get-VMHost -Name $ESX | Get-View).Capability.TxtEnabled,N/A
esx-9.hardware-firmware-updates,"VPM-05
VPM-05.8
TDA-14.1
VPM-04",N/A,6.3.3,ESX,9.0.0,Hardware,"Ensure that all system & device firmware is auditable, authentic, and up to date.","Hardware firmware is not immune to serious issues affecting confidentiality, integrity, or availability. Vulnerable system management controllers & management engines can provide places for attackers to establish persistence, in order to re-infect and re-compromise hosts after reboots and updates.

Ensure that the latest firmware updates are applied to all components of your systems and that the firmware is authentic and supplied by your hardware manufacturer.",If you are a vSAN customer please ensure that storage device & controller firmware versions are certified.,P0,N/A,N/A,N/A,N/A,Audit,Hardware,N/A,N/A
esx-9.hardware-management-authentication,"MNT-05
NET-06.4",N/A,8.2.7,ESX,9.0.0,Hardware,Ensure integrated hardware management controllers use of Active Directory does not create a dependency loop nor an attack vector.,"Connections to centralized authentication sources, like Active Directory, should be disabled or carefully considered as attack vectors and dependency loops (for authentication, authorization, DNS, DHCP, and time). Consider managing local accounts on these devices through the APIs and CLI interfaces provided. If Active Directory must be used for authentication do authorization locally so that an attacker with access to Active Directory cannot promote themselves through group membership.",Not connecting hardware management controllers to centralized authentication & authorization sources entails additional management. Most hardware management controllers have CLI toolkits or APIs to automate management of user accounts and/or authorization levels.,P0,N/A,N/A,N/A,N/A,Audit,Hardware,N/A,N/A
esx-9.hardware-management-log-forwarding,"MON-02
MON-02.2
",VCFA-9X-000141,"10.2.1
10.3.3",ESX,9.0.0,Hardware,Component must securely forward system and audit logs to a remote log collection point.,"By gathering host log files onto a central host, you can more easily monitor all hosts using a single tool. Additionally, you can perform aggregate analysis and searching to identify coordinated attacks on multiple hosts. Logging to a secure and centralized log server helps prevent log tampering and ensures a unified, long-term audit record.",None.,P0,N/A,N/A,N/A,N/A,Audit,Hardware,N/A,N/A
esx-9.hardware-management-security,"CFG-03
IAC-10.8
AST-02.2
DCH-12",N/A,2.2.4,ESX,9.0.0,Hardware,Ensure that integrated hardware management controllers are fully secured.,"Many servers have integrated hardware management controllers that can be extremely helpful when monitoring and updating hardware, settings, and firmware. These controllers should be checked to ensure that ALL unused functionality is disabled, ALL unused access methods are disabled, passwords and password controls are set, and firewalling and access control is in place so that the only access is from authorized access workstations for the virtualization administration team.

All ""first boot"" configuration options should be disabled, especially ones that reconfigure the system from USB devices or NFC/wireless/""zero touch"" devices. Disable or protect USB ports attached to the management controllers. Where possible, USB ports should be set to only permit keyboards.

Default passwords for accounts should be changed.

External information displays should be secured to prevent information leakage. Power and information buttons should be secured against unauthorized use.

Many hardware management controllers provide mechanisms for alerting when hardware faults & configuration changes occur. You should consider those if you are not using another method for hardware monitoring.","Disablement of connection methods may mean that future monitoring and management efforts require changes to the hardware management controller configurations across your fleet of servers.

Most hardware management controllers have CLI and API management methods that can be scripted and used from a management workstation, in lieu of additional management software or applications. Learning these techniques saves time, avoids the additional effort of installing and maintaining additional tools, and allows for timely changes to configurations.",P0,N/A,N/A,N/A,N/A,Audit,Hardware,N/A,N/A
esx-9.hardware-management-time,"MON-07.1
SEA-20",N/A,"10.6.1
10.6.2",ESX,9.0.0,Hardware,Ensure that integrated hardware management controllers have their time synchronized.,"Cryptography, audit logging, cluster operations, and incident response/forensics depend deeply on synchronized time. This recommendation extends to all devices in infrastructure. The recommendation for NTP is to have at least four sources. Do not have two sources (one source is preferable to two).",None.,P0,N/A,N/A,N/A,N/A,Audit,Hardware,N/A,N/A
esx-9.hardware-ports,"CFG-03
END-12",N/A,2.2.4,ESX,9.0.0,Hardware,Ensure that unused external ports are disabled or protected against unauthorized use.,"Unused ports, especially USB, can be used by attackers to attach storage, networking, and keyboards. Take reasonable steps to control access to these ports through disablement, access control, and/or with other means such as solid rack doors, rack side panels, and flooring that makes the ports inaccessible from outside the rack when the rack door is closed. Cables fit easily through many gaps in and around racks and rack doors, and stiff wires can be used to push them into sockets from outside the rack, as well as to dislodge cables to create a service disruption.

Where possible, USB ports should also be set to only permit keyboards.

When disabling functionality like this please consider that you may need to access the server using a USB keyboard during an outage or as part of lifecycle operations, and plan accordingly.","Security is always a tradeoff, and ease of recovery from an outage or incident should always be part of the equation when considering a security control like this. In this case, disablement of external ports will affect the ability to use the ESX console in case of emergency.

Some servers have the ability to dynamically disable and enable certain USB ports for management. Ensure that whatever you choose meets your organization's needs, and that you have tested these methods before an incident.",P1,N/A,N/A,N/A,N/A,Audit,Hardware,N/A,N/A
esx-9.hardware-secureboot,END-04.6,VCFE-9X-000091,5.2.3,ESX,9.0.0,Hardware,Ensure that UEFI Secure Boot is enabled.,Enabling UEFI Secure Boot on the ESX host's hardware helps prevent malware and untrusted configurations.,"Improvements in ESX have made enabling this easy, and you should be able to simply enable it in the system firmware and have ESX boot normally. However, you should test the change and roll it out in a controlled manner to avoid issues.",P0,N/A,N/A,N/A,N/A,Audit,Hardware,(Get-VMHost -Name $ESX | Get-View).Capability.UefiSecureBoot,N/A
esx-9.hardware-tpm,"END-04.6
IAC-12.1",N/A,5.2.3,ESX,9.0.0,Hardware,Ensure that a TPM 2.0 is installed and enabled on the host.,"ESX can use Trusted Platform Modules (TPM) 2.0 to enable advanced security features that prevent malware, remove dependencies, and secure hardware lifecycle operations. We strongly recommend all servers be configured with a TPM 2.0 and the TPM be enabled in the system firmware. ",None.,P0,N/A,N/A,"TPM 2.0 installed, enabled.
SHA-256 hashing, TIS/FIFO interface",N/A,Audit,Hardware,"(Get-VMHost -Name $ESX | Get-View).Capability.TpmSupported
(Get-VMHost -Name $ESX | Get-View).Capability.TpmVersion",N/A
esx-9.hardware-virtual-nic,"NET-04.1
CFG-03",VCFE-9X-000238,"1.3.1
1.4.1
1.4.2
1.4.4",ESX,9.0.0,Base,The ESX host must not enable virtual hardware management network interfaces.,Hardware management controllers often present virtual or USB NICs to the ESX host. These can be used as backdoors and should be deactivated both in the hardware configuration and in ESX.,Some third-party managed solutions may require this.,P0,Net.BMCNetworkEnable,1,0,NO,Modify,"ESX Advanced
System Settings",Get-VMHost -Name $ESX | Get-AdvancedSetting Net.BMCNetworkEnable,Get-VMHost -Name $ESX | Get-AdvancedSetting Net.BMCNetworkEnable | Set-AdvancedSetting -Value 0
esx-9.iscsi-mutual-chap,"IAC-04
CRY-03",VCFE-9X-000138,8.3.2,ESX,9.0.0,iSCSI,Enable bidirectional/mutual CHAP authentication for iSCSI traffic.,"Mutual CHAP provides an additional layer of protection by requiring both the initiator (client) and the target (server) to verify their identities to each other, thereby ensuring data transmitted between the two is not intercepted or altered by unauthorized entities.",None.,"P0
Upon Feature Enablement","Set iSCSI storage adapter authentication to ""Use bidirectional CHAP"" and supply credentials",Not Configured,Enabled,NO,Modify if Feature in Use,ESX iSCSI Configuration,"Get-VMHost -Name $ESX | Get-VMHostHba | Where {$_.Type -eq ""Iscsi""} | Select VMHost, Device, ChapType, @{N=""CHAPName"";E={$_.AuthenticationProperties.ChapName}}","Get-VMHost -Name $ESX | Get-VMHostHba | Where {$_.Type -eq ""Iscsi""} | Set-VMHostHba <parameters>"
esx-9.key-persistence,"CRY-09
PES-02",VCFE-9X-000236,"3.3.2
3.3.3
3.5.1",ESX,9.0.0,TPM,The ESX host must not store encryption keys on ESX hosts without securing physical access to the hosts.,"Key Persistence is a mechanism that uses a local Trusted Platform Module (TPM) to store Standard Key Provider keys, usually found only in an external Key Management System (KMS). While this setup can improve management of dependencies, using Key Persistence changes the encryption risks. If an attacker steals the host, they will have access to the encryption keys for data on that host, bypassing the access controls of the external KMS. Therefore, Key Persistence should be used only when the physical security of the hosts is assured. If the physical hosts are not secure and an attacker can steal the host, they will also have the means to access and use encrypted workloads.

Key Persistence and Native Key Provider are often conflated because both store encryption data on hosts. However, the Native Key Provider does not use Key Persistence, so turning off Key Persistence won't affect it. Like Key Persistence, the Native Key Provider also requires careful consideration of physical security, as outlined in the 'design-9.native-key-provider' and 'design-9.hardware-physical-security' controls.",Default is desired behavior. Change away from the default may negatively impact confidentiality in environments where physical access by attackers is possible.,"P2
Upon Feature Enablement",N/A,false,false,YES,Audit,esxcli,"$ESXcli = Get-EsxCli -VMHost $ESX -V2
$ESXcli.system.security.keypersistence.get.invoke() | Select-Object -ExpandProperty Enabled","$ESXcli = Get-EsxCli -VMHost $ESX -V2
$arguments = $ESXcli.system.security.keypersistence.disable.CreateArgs()
$arguments.removeallstoredkeys = $true
$ESXcli.system.security.keypersistence.disable.Invoke($arguments)"
esx-9.lockdown-dcui-access,IAC-21,VCFE-9X-000181,7.2.2,ESX,9.0.0,Base,The ESX host must have an accurate DCUI.Access list.,"Ensures that only authorized users have direct console user interface (DCUI) access to the ESX host when Lockdown Mode is enabled. The root user cannot be removed from the list.

To control ESX Shell and/or SSH access use the Lockdown Mode Exception Users list.",Potential for loss of administrative access to hosts. Ensure that the host is attached to the vCenter Server and that access lists and exception lists are configured prior to configuring lockdown mode.,P2,DCUI.Access,root,root,YES,Audit,"ESX Advanced
System Settings",Get-VMHost -Name $ESX | Get-AdvancedSetting DCUI.Access,Get-VMHost -Name $ESX | Get-AdvancedSetting DCUI.Access | Set-AdvancedSetting -Value root
esx-9.lockdown-exception-users,IAC-21,VCFE-9X-000205,7.2.2,ESX,9.0.0,Base,The ESX host must have an accurate Exception Users list.,"Users on the Lockdown Mode ""Exception Users"" list do not lose their privileges when the host enters lockdown mode, which can potentially defeat the purpose of lockdown mode.",Potential for loss of administrative access to hosts. Ensure that the host is attached to the vCenter Server and that access lists and exception lists are configured prior to configuring lockdown mode.,P2,N/A,Null,Null,YES,Audit,ESX Security Profile,(Get-View (Get-VMHost -Name $ESX | Get-View).ConfigManager.HostAccessManager).QueryLockdownExceptions(),(Get-View (Get-VMHost -Name $ESX | Get-View).ConfigManager.HostAccessManager).UpdateLockdownExceptions($NULL)
esx-9.lockdown-mode,"IAC-20
CFG-03",VCFE-9X-000008,2.2.4,ESX,9.0.0,Base,The ESX host must enable lockdown mode.,"Enabling lockdown mode deactivates direct access to an ESX host and requires that the host be managed remotely from vCenter Server. This is done to ensure that the roles and access controls implemented in vCenter are always enforced, and users cannot bypass them by logging into a host directly. By forcing all interactions to occur through vCenter Server, the risk of someone attaining elevated privileges or performing tasks that are not properly audited is greatly reduced.

Note that users listed in the Exception Users list for each host are allowed to override lockdown mode and log in. By default, no users are present on the Exception Users list.

There are three settings for lockdown mode: disabled, normal, and strict. Choosing strict means that if the ESX host loses contact with vCenter Server, it cannot be managed in any way until that connection is restored. If the connection cannot be restored, the host will need to be rebuilt. This level of lockdown mode is typically not necessary for most deployments and can present significant operational challenges. Therefore, we recommend using normal lockdown mode.","Potential for loss of administrative access to hosts. Ensure that the host is attached to vCenter Server and that access lists and exception lists are configured prior to configuring lockdown mode.

There are some operations, such as backup and troubleshooting, that require direct access to the host. In these cases, Lockdown Mode can be deactivated on a temporary basis for specific hosts as needed, and then re-enabled when the task is completed.",P0,N/A,lockdownDisabled,lockdownNormal,NO,Modify,ESX Security Profile,(Get-View (Get-VMHost -Name $ESX | Get-View).ConfigManager.HostAccessManager).LockdownMode,(Get-View (Get-VMHost -Name $ESX | Get-View).ConfigManager.HostAccessManager).ChangeLockdownMode('lockdownNormal')
esx-9.log-audit-forwarding,"MON-02
MON-03",VCFE-9X-000111,"10.2.1
10.3.3",ESX,9.0.0,Base,The ESX host must transmit audit records to a remote host.,ESX will transmit audit records to the configured log collector.,None.,P0,Syslog.global.auditRecord.remoteEnable,FALSE,TRUE,NO,Modify,"ESX Advanced
System Settings",Get-VMHost -Name $ESX | Get-AdvancedSetting Syslog.global.auditRecord.remoteEnable,Get-VMHost -Name $ESX | Get-AdvancedSetting Syslog.global.auditRecord.remoteEnable | Set-AdvancedSetting -Value TRUE
esx-9.log-audit-local,"MON-03
MON-01",VCFE-9X-000198,10.2.1,ESX,9.0.0,Base,The ESX host must enable audit record logging.,ESX will store audit records locally.,Additional storage space consumed by logs.,P0,Syslog.global.auditRecord.storageEnable,FALSE,TRUE,NO,Modify,"ESX Advanced
System Settings",Get-VMHost -Name $ESX | Get-AdvancedSetting Syslog.global.auditRecord.storageEnable,Get-VMHost -Name $ESX | Get-AdvancedSetting Syslog.global.auditRecord.storageEnable | Set-AdvancedSetting -Value TRUE
esx-9.log-audit-local-capacity,MON-04,VCFE-9X-000110,10.5.1,ESX,9.0.0,Base,The ESX host must store audit records for a time period consistent with your records retention policy.,"If a remote audit record storage facility is available, it is essential to ensure that the local storage capacity is sufficient to hold audit records that may accumulate during anticipated interruptions in the delivery of records to the facility. This ensures that audit records are not lost or overwritten during periods when the remote storage is unavailable, allowing for seamless continuity of the audit trail and compliance requirements.",Additional storage space consumed by logs.,P1,Syslog.global.auditRecord.storageCapacity,4,100,NO,Modify,"ESX Advanced
System Settings",Get-VMHost -Name $ESX | Get-AdvancedSetting Syslog.global.auditRecord.storageCapacity,Get-VMHost -Name $ESX | Get-AdvancedSetting Syslog.global.auditRecord.storageCapacity | Set-AdvancedSetting -Value 100
esx-9.log-audit-persistent,"MON-04
MON-08",VCFE-9X-000202,10.5.1,ESX,9.0.0,Base,Configure a persistent log location for all locally stored audit records on the ESX host.,"ESX can be configured to store audit records on an in-memory file system.  This occurs when the host's ""/scratch"" directory is linked to ""/tmp/scratch"". When this is done only a single day's worth of records are stored at any time. In addition audit records will be reinitialized upon each reboot.  This presents a security risk as user activity logged on the host is only stored temporarily and will not persistent across reboots.  This can also complicate auditing and make it harder to monitor events and diagnose issues.  ESX host audit record logging should always be configured to a persistent datastore.

You can detect if the scratch volume is temporary or persistent by querying the ScratchConfig.CurrentScratchLocation advanced parameter. If, when queried, it returns ""/tmp/scratch"" then the volume is temporary and you should remap the audit record storage to a persistent device.

Cannot be a vSAN datastore. If your only local, non-vSAN storage is SD or USB media (which can become unreliable with repeated writes from logs) you might consider leaving the logs in the ramdisk and ensuring that a remote logging host is configured instead. Document the decision and rationale in preparation for future audits.",Additional storage space consumed by logs.,P0,"ScratchConfig.CurrentScratchLocation
Syslog.global.auditRecord.storageDirectory","Depends on boot device
[] /scratch/auditLog",Persistent Storage Location,NO,Modify,"ESX Advanced
System Settings","$ESXcli = Get-EsxCli -VMHost $ESX -V2
$ESXcli.system.syslog.config.get.Invoke() | Select LocalLogOutput,LocalLogOutputIsPersistent

If your LocalLogOutput is set to a directory in /scratch, and LocalLogOutputIsPersistent is true, that means your boot device is of a type and size that makes /scratch persistent. Verify that your audit storage is also on /scratch, and that /scratch points to a VMFS datastore:

Get-VMHost -Name $ESX | Get-AdvancedSetting ScratchConfig.CurrentScratchLocation
Get-VMHost -Name $ESX | Get-AdvancedSetting Syslog.global.auditRecord.storageDirectory","Get-VMHost -Name $ESX | Get-AdvancedSetting Syslog.global.auditRecord.storageDirectory | Set-AdvancedSetting -Value ""<PERSISTENT LOCATION>/audit"""
esx-9.log-filter,MON-03,VCFE-9X-000235,10.2.1,ESX,9.0.0,Base,The ESX host must not enable log filtering.,"You can create log filters to reduce the number of repetitive entries, and to deny specific log events entirely.",None.,P2,N/A,false,false,YES,Audit,"ESX Advanced
System Settings","$ESXcli = Get-EsxCli -VMHost $ESX -V2
$ESXcli.system.syslog.config.logfilter.get.invoke() | Select -ExpandProperty LogFilteringEnabled ","$ESXcli = Get-EsxCli -VMHost $ESX -V2
$arguments = $esxcli.system.syslog.config.logfilter.set.CreateArgs()
$arguments.logfilteringenabled = $false
$ESXcli.system.syslog.config.logfilter.set.invoke($arguments)"
esx-9.log-forwarding,MON-02,VCFA-9X-000141,10.3.3,ESX,9.0.0,Base,Component must forward system and audit logs to a remote log collection point.,"By gathering host log files onto a central host, you can more easily monitor all hosts using a single tool. Additionally, you can perform aggregate analysis and searching to identify coordinated attacks on multiple hosts. Logging to a secure and centralized log server helps prevent log tampering and ensures a unified, long-term audit record.",None.,P0,Syslog.global.logHost,Undefined,Site-Specific Log Server,NO,Modify,"ESX Advanced
System Settings",Get-VMHost -Name $ESX | Get-AdvancedSetting Syslog.global.logHost,"Get-VMHost -Name $ESX | Get-AdvancedSetting Syslog.global.logHost | Set-AdvancedSetting -Value ""<log collector>"""
esx-9.log-forwarding-tls-ciphers,CRY-02,N/A,2.2.7,ESX,9.0.0,Base,The ESX host must verify certificates for TLS remote logging endpoints.,TLS certificates help ensure that the endpoint is authentic and trustworthy.,"Changes to cipher suites impact connectivity with other components and external systems, and may require a restart of the component to implement.",P2,Syslog.global.certificate.checkSSLCerts,TRUE,TRUE,YES,Audit,"ESX Advanced
System Settings",Get-VMHost -Name $ESX | Get-AdvancedSetting Syslog.global.certificate.checkSSLCerts,Get-VMHost -Name $ESX | Get-AdvancedSetting Syslog.global.certificate.checkSSLCerts | Set-AdvancedSetting -Value TRUE
esx-9.log-forwarding-tls-x509,"CRY-02
IAC-10.2",VCFE-9X-000230,2.2.7,ESX,9.0.0,Base,The ESX host must use strict x509 verification for TLS-enabled remote logging endpoints.,"This ""x509-strict"" option performs additional validity checks on CA root certificates during verification.",None.,P0,Syslog.global.certificate.strictX509Compliance,FALSE,TRUE,NO,Modify,"ESX Advanced
System Settings",Get-VMHost -Name $ESX | Get-AdvancedSetting Syslog.global.certificate.strictX509Compliance,Get-VMHost -Name $ESX | Get-AdvancedSetting Syslog.global.certificate.strictX509Compliance | Set-AdvancedSetting -Value TRUE
esx-9.login-message,SEA-18,VCFE-9X-000006,2.2.6,ESX,9.0.0,Base,Configure the ESX host login banner for the DCUI and Host Client.,"While not a direct security control, a login message or banner is  used to inform authorized users of their responsibilities and conditions for system use, as well as to enable disciplinary action and/or prosecution of unauthorized behavior.","Masks the ""F2/F12"" and IP address information on the DCUI, which can be a benefit, but may also require documentation and/or training.",P1,Annotations.WelcomeMessage,Undefined,"Consult your organization's legal advisors for text that is applicable to your environment.

An example is: ""Authorized users only. Actual or attempted unauthorized use of this system is prohibited and may result in criminal, civil, security, or administrative proceedings and/or penalties. Use of this information system indicates consent to monitoring and recording, without notice or permission. Users have no expectation of privacy in any use of this system. Any information stored on, or transiting this system, or obtained by monitoring and/or recording, may be disclosed to law enforcement and/or used in accordance with Federal law, State statute, and organization policy. If you are not an authorized user of this system, exit the system at this time.""",NO,Modify,"ESX Advanced
System Settings",Get-VMHost -Name $ESX | Get-AdvancedSetting Annotations.WelcomeMessage,"Get-VMHost -Name $ESX | Get-AdvancedSetting Annotations.WelcomeMessage | Set-AdvancedSetting -Value ""Authorized users only. Actual or attempted unauthorized use of this system is prohibited and may result in criminal, civil, security, or administrative proceedings and/or penalties. Use of this information system indicates consent to monitoring and recording, without notice or permission. Users have no expectation of privacy in any use of this system. Any information stored on, or transiting this system, or obtained by monitoring and/or recording, may be disclosed to law enforcement and/or used in accordance with Federal law, State statute, and organization policy. If you are not an authorized user of this system, exit the system at this time."""
esx-9.log-level,MON-03,VCFE-9X-000015,10.2.1,ESX,9.0.0,Base,The ESX host must produce audit records containing information to establish what type of events occurred.,It is important to ensure that sufficient information is present in audit logs for diagnostics and forensics purposes.,Additional storage space consumed by logs.,P2,Config.HostAgent.log.level,info,info,YES,Audit,"ESX Advanced
System Settings",Get-VMHost -Name $ESX | Get-AdvancedSetting Config.HostAgent.log.level,Get-VMHost -Name $ESX | Get-AdvancedSetting Config.HostAgent.log.level | Set-AdvancedSetting -Value info
esx-9.log-level-global,MON-03,N/A,10.2.1,ESX,9.0.0,Base,The ESX host must log sufficient information for events.,"It is important to ensure that sufficient information is present in audit logs for diagnostics and forensics purposes. The recommendation for this parameter in the Security Configuration Guide has traditionally been ""info"" but with the introduction of the audit logging subsystems there is no longer a need for the extra log traffic. As such, the recommendation has changed to use the product default of ""error"" unless debugging or troubleshooting.","Additional storage space consumed by logs, as well as sent to remote collectors.",P2,Syslog.global.logLevel,error,error,YES,Audit,"ESX Advanced
System Settings",Get-VMHost -Name $ESX | Get-AdvancedSetting Syslog.global.logLevel,Get-VMHost -Name $ESX | Get-AdvancedSetting Syslog.global.logLevel | Set-AdvancedSetting -Value info
esx-9.log-persistent,"MON-04
MON-08",VCFE-9X-000202,10.5.1,ESX,9.0.0,Base,Configure a persistent log location for all locally stored logs on the ESX host.,"ESX can be configured to store log files on an in-memory file system. This occurs when the host's ""/scratch"" directory is linked to ""/tmp/scratch"". When this is done, only a single day's worth of logs is stored at any time. Additionally, log files will be reinitialized upon each reboot. This presents a security risk as user activity logged on the host is only stored temporarily and will not persist across reboots. It can also complicate auditing and make it harder to monitor events and diagnose issues. Therefore, it is recommended to configure ESX host logging to a persistent datastore.

You can detect if the scratch volume is temporary or persistent by querying the ScratchConfig.CurrentScratchLocation advanced parameter. If, when queried, it returns ""/tmp/scratch"" then the volume is temporary and you should remap the audit record storage to a persistent device.

Cannot be a vSAN datastore unless Syslog.global.vsanBacking is set, which has caveats & dependencies. If your only local, non-vSAN storage is SD or USB media (which can become unreliable with repeated writes from logs) you might consider leaving the logs in the ramdisk and ensuring that a remote logging host is configured instead. Document the decision and rationale in preparation for future audits.",None.,P0,"LocalLogOutputIsPersistent
ScratchConfig.CurrentScratchLocation
Syslog.global.logDir","Depends on boot device
[] /scratch/log",Persistent Storage Location,NO,Modify,"ESX Advanced
System Settings","$ESXcli = Get-EsxCli -VMHost $ESX -V2
$ESXcli.system.syslog.config.get.Invoke() | Select LocalLogOutput,LocalLogOutputIsPersistent

If your LocalLogOutput is set to a directory in /scratch, and LocalLogOutputIsPersistent is true, that means your boot device is of a type and size that makes /scratch persistent. Verify that your log storage is also on /scratch, , and that /scratch points to a VMFS datastore:

Get-VMHost -Name $ESX | Get-AdvancedSetting ScratchConfig.CurrentScratchLocation
Get-VMHost -Name $ESX | Get-AdvancedSetting Syslog.global.logDir","Get-VMHost -Name $ESX | Get-AdvancedSetting Syslog.global.logDir | Set-AdvancedSetting -Value ""<PERSISTENT LOCATION>""
"
esx-9.memeagerzero,"CRY-08
DCH-17",VCFE-9X-000225,3.6.1,ESX,9.0.0,Base,The ESX host must enable volatile key destruction.,"By default, ESX zeroes out pages allocated for virtual machines (VMs), userspace applications, and kernel threads at the time of allocation. This ensures that no non-zero pages are exposed to VMs or userspace applications. This measure is in place to prevent the exposure of cryptographic keys from VMs or userworlds to other clients.

However, if memory is not reused, these keys can remain present in host memory for an extended period. To address this, MemEagerZero can be configured to enforce the zeroing out of userworld and guest memory pages when a userworld process or guest exits. For kernel threads, memory spaces holding keys are zeroed out as soon as the secret is no longer required.","Additional shutdown time required for virtual machines, corresponding to the amount of allocated memory.",P0,Mem.MemEagerZero,0,1,NO,Modify,"ESX Advanced
System Settings",Get-VMHost -Name $ESX | Get-AdvancedSetting Mem.MemEagerZero,Get-VMHost -Name $ESX | Get-AdvancedSetting Mem.MemEagerZero | Set-AdvancedSetting -Value 1
esx-9.memory-tiering-encryption,"CRY-05
DCH-17",N/A,"3.3.2
3.3.3
3.5.1",ESX,9.0.0,Memory Tiering,The ESX host should encrypt data written to tiered memory devices.,"Due to its architecture, flash memory is difficult to sanitize at the end of its lifespan. Memory tiering copies data from virtual machines to NVMe flash devices. Either encrypt the tiered memory data or plan to securely sanitize or destroy the tiering device.","All encryption comes at the cost of CPU cycles and potential storage latency. How much this impacts workloads depends on a variety of factors, such as the configuration of the underlying hardware and the type and frequency of storage I/O by the workload.",P0,Mem.EncryptTierNvme,0,1,NO,Modify,"ESX Advanced
System Settings",Get-VMHost -Name $ESX | Get-AdvancedSetting Mem.EncryptTierNvme,Get-VMHost -Name $ESX | Get-AdvancedSetting Mem.EncryptTierNvme | Set-AdvancedSetting -Value 1
esx-9.network-bpdu,NET-04,VCFE-9X-000218,2.2.6,ESX,9.0.0,Base,Enable the Bridge Protocol Data Unit (BPDU) filter on the ESX host.,"BPDUs (Bridge Protocol Data Units) are used to transmit Spanning Tree Protocol (STP) information and detect network loops. BPDU Guard and Portfast are commonly enabled on the physical switch directly connected to the ESX host to reduce spanning tree convergence delay.

However, if a BPDU packet is sent from a virtual machine on the ESX host to the configured physical switch, it can result in a cascading lockout of all uplink interfaces from the ESX host. To prevent this type of lockout, BPDU Filter can be enabled on the ESX host to drop any BPDU packets being sent to the physical switch.

It is important to note that Standard and Distributed Virtual Switches do not support STP and do not generate BPDUs.","Some network-oriented workloads can legitimately generate BPDU packets. The administrator should verify that there are no legitimate BPDU packets generated by virtual machines on the ESX host prior to enabling BPDU Filter. If BPDU Filter is enabled in this situation, enabling Reject Forged Transmits on the virtual switch port group adds protection against Spanning Tree loops.",P2,Net.BlockGuestBPDU,1,1,YES,Audit,"ESX Advanced
System Settings",Get-VMHost -Name $ESX | Get-AdvancedSetting Net.BlockGuestBPDU,Get-VMHost -Name $ESX | Get-AdvancedSetting Net.BlockGuestBPDU | Set-AdvancedSetting -Value 1
esx-9.network-dvfilter,CFG-03,VCFE-9X-000222,2.2.6,ESX,9.0.0,Base,Use of the dvFilter network APIs must be restricted on the ESX host.,"If you are not using a product such as VMware NSX that utilizes the dvfilter network API, it is recommended not to configure the host to send network information to an IP address. Enabling the API and referencing an IP address that is compromised could potentially provide unauthorized access to the network of other virtual machines (VMs) on the host.

If you are using a product that relies on this API, it is important to verify that the host has been configured correctly to ensure secure network communication.",None.,P2,Net.DVFilterBindIpAddress,"""""","""""",YES,Audit,"ESX Advanced
System Settings",Get-VMHost -Name $ESX | Get-AdvancedSetting Net.DVFilterBindIpAddress,"Get-VMHost -Name $ESX | Get-AdvancedSetting Net.DVFilterBindIpAddress | Set-AdvancedSetting -Value """""
esx-9.network-standard-reject-forged-transmit,"NET-04
NET-03",VCFE-9X-000219,1.4.3,ESX,9.0.0,Standard Switch,All standard switches and their port groups must be configured to reject forged transmits.,"If the MAC address of a virtual machine operating system changes, it allows the operating system to send frames with an impersonated source MAC address, potentially enabling malicious attacks on devices within a network by impersonating an authorized network adapter.

When the ""Forged transmits"" option is set to ""Accept,"" ESX does not compare the source and effective MAC addresses.

To protect against MAC impersonation, you can set the ""Forged transmits"" option to ""Reject."" In this case, the host compares the source MAC address being transmitted by the guest operating system with the effective MAC address for its virtual machine adapter to check for a match. If the addresses do not match, the ESX host drops the packet.","Some workloads, such as clustered applications and network devices/functions, rely on these techniques as a normal part of their operation. If necessary, it is recommended to create a separate port group that allows this behavior, with only authorized virtual machines connected to it.","P1
Upon Feature Enablement",N/A,Accept,Reject,NO,Modify,Virtual Switch Settings,"Get-VMHost -Name $ESX | Get-VirtualSwitch -Standard | Get-SecurityPolicy | select VirtualSwitch,ForgedTransmits
Get-VMHost -Name $ESX | Get-VirtualPortGroup -Standard | Get-SecurityPolicy | select VirtualPortGroup,ForgedTransmits","Get-VMHost -Name $ESX | Get-VirtualSwitch -Standard | Get-SecurityPolicy | Set-SecurityPolicy -ForgedTransmits $false 
Get-VMHost -Name $ESX | Get-VirtualPortGroup -Standard | Get-SecurityPolicy | Set-SecurityPolicy -ForgedTransmitsInherited $true"
esx-9.network-standard-reject-mac-changes,"NET-04
NET-03",VCFE-9X-000220,1.4.3,ESX,9.0.0,Standard Switch,All standard switches and their port groups must be configured to reject guest MAC address changes.,"If the virtual machine operating system changes the MAC address, it can send frames with an impersonated source MAC address, enabling it to stage malicious attacks on devices within a network by impersonating a network adapter authorized by the receiving network. To prevent virtual machines from changing their effective MAC address, measures should be taken to enforce MAC address stability or restrict the ability to modify MAC addresses. This helps mitigate the risk of MAC impersonation and potential malicious activities.","Some workloads, such as clustered applications, network devices/functions, applications licensed by MAC address, and vCenter Server Reduced Downtime Upgrade, rely on these techniques as a normal part of their operation. If necessary, it is recommended to create a separate port group that allows this behavior, with only authorized virtual machines connected to it.","P0
Upon Feature Enablement",N/A,Accept,Reject,NO,Modify,Virtual Switch Settings,"Get-VMHost -Name $ESX | Get-VirtualSwitch -Standard | Get-SecurityPolicy | select VirtualSwitch,MacChanges
Get-VMHost -Name $ESX | Get-VirtualPortGroup -Standard | Get-SecurityPolicy | select VirtualPortGroup,MacChanges","Get-VMHost -Name $ESX | Get-VirtualSwitch -Standard | Get-SecurityPolicy | Set-SecurityPolicy -MacChanges $false
Get-VMHost -Name $ESX | Get-VirtualPortGroup -Standard | Get-SecurityPolicy | Set-SecurityPolicy -MacChangesInherited $true"
esx-9.network-standard-reject-promiscuous-mode,"NET-04
NET-03",VCFE-9X-000221,1.4.5,ESX,9.0.0,Standard Switch,All standard switches and their port groups must be configured to reject guest promiscuous mode requests.,"When promiscuous mode is enabled for a port group, all virtual machines connected to that port group have the potential to read all packets transmitted across that port group, regardless of the intended recipient.

It is important to consider the potential impact and design considerations before changing the default value of promiscuous mode.","Certain workloads and types of work, such as DHCP servers, network devices, and security monitoring, incorporate these techniques as a regular part of their operation. If necessary, it is advisable to create a distinct port group that allows this behavior, ensuring that only authorized virtual machines are associated with it.","P0
Upon Feature Enablement",N/A,Reject,Reject,YES,Audit,Virtual Switch Settings,"Get-VMHost -Name $ESX | Get-VirtualSwitch -Standard | Get-SecurityPolicy | select VirtualSwitch,AllowPromiscuous
Get-VMHost -Name $ESX | Get-VirtualPortGroup -Standard | Get-SecurityPolicy | select VirtualPortGroup,AllowPromiscuous","Get-VMHost -Name $ESX | Get-VirtualSwitch -Standard | Get-SecurityPolicy | Set-SecurityPolicy -AllowPromiscuous $false
Get-VMHost -Name $ESX | Get-VirtualPortGroup -Standard | Get-SecurityPolicy | Set-SecurityPolicy -AllowPromiscuousInherited $true"
esx-9.network-vgt,"NET-04.1
NET-06",VCFE-9X-000223,1.4.2,ESX,9.0.0,Base,The ESX host must restrict the use of Virtual Guest Tagging (VGT) on Standard Switches.,"When a port group is set to VLAN 4095, the vSwitch passes all network frames to the attached virtual machines (VMs) without modifying the VLAN tags. In vSphere, this is referred to as VGT. The VM must process the VLAN information itself via an 802.1Q driver in the operating system.

VLAN 4095 must only be implemented if the attached VMs have been specifically authorized and are capable of managing VLAN tags themselves. If VLAN 4095 is enabled inappropriately, it may cause denial of service or allow a VM to interact with traffic on an unauthorized VLAN.",None.,P2,N/A,Not VLAN 4095,Not VLAN 4095,YES,Audit,ESX Port Group Configuration,"Get-VMHost -Name $ESX | Get-VirtualPortGroup -Standard | select Name,VlanID","Get-VMHost -Name $ESX | Get-VirtualPortGroup -Standard -Name $PG| Set-VirtualPortGroup -VlanID ""<new VLAN>"""
esx-9.nfs-encryption,CRY-03,N/A,"3.3.2
3.3.3
3.5.1",ESX,9.0.0,"Active Directory
NFS",Enable data-in-transit encryption protections for NFS datastores when hosts are joined to Active Directory.,"ESX 9 and later supports the krb5, krb5i, and krb5p NFS mount options on ESX hosts that are joined to an Active Directory domain. These mount options instruct NFS to use Kerberos for authentication, data integrity, and privacy.

As with all encryption and security controls there are tradeoffs, namely performance and complexity. When encrypting storage traffic the hosts and storage array will use more CPU and I/O capacity, and likely experience lower throughput and higher latency (how much of each is generically unquantifiable and will depend on the type of workload, type and amount of I/O, hardware capabilities, and more).

Additionally, joining ESX to an Active Directory domain exposes the host to attack vectors through Active Directory, and blurs the lines between the storage and virtualization systems in ways that increase risk and the chance for attackers to move laterally between those systems. There is also the additional dependency on Active Directory, complicating system restarts, and even forming dependency loops if Active Directory domain controllers are hosted inside the virtual environment itself.

Traditional compensating controls for NFS data-in-transit encryption involve fabric isolation, and ESX 8 and newer provide better ways to directly control which vmkernel interface is used for NFS traffic in support of this.","Performance, availability, and security. See the discussion.","P2
Upon Feature Enablement",N/A,Not Configured,Configured,NO,Modify if Feature in Use,Datastore NFS Mount Options,N/A,N/A
esx-9.password-complexity,IAC-10.1,VCFE-9X-000035,"8.3.1
8.3.6",ESX,9.0.0,Base,The ESX host must enforce password complexity by configuring a password quality policy.,"Based on recommendations such as NIST 800-63B Section 5.1.1.2, it is suggested that composition rules, such as mandating mixtures of character classes, should not be enforced on systems as they often fail to enhance password security and discourage the adoption of more secure passphrases.

Password strength and complexity rules are applicable to all ESX users, including the root user. However, when the ESX host is joined to a domain, these rules do not apply to Active Directory (AD) users as password policies for AD users are enforced by the AD system.",Other products and services within the VMware ecosystem may not expect changes to password complexity requirements and may fail installation.,P0,Security.PasswordQualityControl,""" random=0 retry=3 min=disabled,disabled,disabled,7,7""","""random=0 similar=deny retry=3 min=disabled,disabled,disabled,disabled,15""",NO,Modify,"ESX Advanced
System Settings",Get-VMHost -Name $ESX | Get-AdvancedSetting Security.PasswordQualityControl,"Get-VMHost -Name $ESX | Get-AdvancedSetting Security.PasswordQualityControl | Set-AdvancedSetting -Value ""similar=deny retry=3 min=disabled,disabled,disabled,disabled,15 max=64"""
esx-9.password-max-age,IAC-10.1,VCFE-9X-000042,8.3.9,ESX,9.0.0,Base,The ESX host must be configured with an appropriate maximum password age.,"Modern best practices for passwords, as outlined in NIST 800-63B Section 5.1.1.2 and other relevant guidance, state that enforcing periodic password changes does not enhance security when passwords already possess adequate entropy.",vSphere UIs may not permit this to be set without providing an email address for an alert. Use PowerCLI or provide an email address (to receive email you will need to configure an SMTP server in vCenter Server),P2,Security.PasswordMaxDays,99999,99999,YES,Audit,"ESX Advanced
System Settings",Get-VMHost -Name $ESX | Get-AdvancedSetting Security.PasswordMaxDays,Get-VMHost -Name $ESX | Get-AdvancedSetting Security.PasswordMaxDays | Set-AdvancedSetting -Value 9999
esx-9.secureboot,END-04.6,VCFE-9X-000082,5.2.3,ESX,9.0.0,Base,The ESX host must enable Secure Boot.,"Secure Boot is part of the UEFI firmware standard. With UEFI Secure Boot enabled, a host refuses to load any UEFI driver or app unless the operating system bootloader has a valid digital signature. Secure Boot for ESX requires support from the firmware and it requires that all ESX kernel modules, drivers, and VIBs be signed by VMware or a partner subordinate. Secure Boot is enabled in the BIOS of the ESX physical server and supported by the hypervisor boot loader.","Use of UEFI Secure Boot will interfere with %firstboot stanzas in automated ESX installations, as that script is not properly signed. Workarounds include moving the configuration to external post-install scripts, or enabling Secure Boot after the installation is complete (which can often be automated on server platforms using out-of-band management controller APIs).",P0,N/A,False,True,NO,Modify,ESX Shell,"(Get-VMHost -Name $ESX | Get-View).Capability.UefiSecureBoot

This check is available beginning with PowerCLI 13.3.",N/A (Enable in hardware firmware settings)
esx-9.secureboot-enforcement,"END-04.6
IAC-12.1",VCFE-9X-000082,5.2.3,ESX,9.0.0,Base,The ESX host must enable TPM-based Secure Boot enforcement.,"The TPM-based nature of VMware ESX Secure Boot Enforcement enhances security beyond standard Secure Boot. It uses a hardware TPM chip to store and verify cryptographic measurements of the entire boot process, from UEFI firmware to the ESX kernel. This creates a hardware-backed root of trust, making it much harder for attackers to tamper with the boot sequence undetected. Unlike normal Secure Boot, which only checks digital signatures, TPM-based enforcement ensures the integrity of the complete boot chain and enables advanced features like remote attestation for verifying host trustworthiness. This control flips ESX from merely supporting Secure Boot to requiring it. Without this setting enabled, and configuration encryption, an ESX host could be subject to offline attacks. An attacker could simply transfer the ESX install drive to a non-Secure Boot host and boot it up without ESX complaining.",Use of UEFI Secure Boot and TPM-enforced Configuration Encryption render traditional root password recovery efforts unusable. Ensure that you do not lose access to administrator accounts on ESX.,P2,N/A,TRUE,TRUE,YES,Audit,esxcli,"$ESXcli = Get-EsxCli -VMHost $ESX -V2
$ESXcli.system.settings.encryption.get.Invoke() | Select RequireSecureBoot","$ESXcli = Get-EsxCli -VMHost $ESX -V2
$arguments = $ESXcli.system.settings.encryption.set.CreateArgs()
$arguments.requiresecureboot = $true
$ESXcli.system.settings.encryption.set.Invoke($arguments)"
esx-9.session-timeout,IAC-25,VCFE-9X-000010,8.2.8,ESX,9.0.0,Base,VMware Cloud Foundation components must enforce a session timeout after a specified period of inactivity.,"This practice helps mitigate potential security risks by ensuring that unattended sessions, which could be exploited by unauthorized users or malicious software, are not left open indefinitely.",None.,P2,UserVars.HostClientSessionTimeout,900,900,YES,Audit,"ESX Advanced
System Settings",Get-VMHost -Name $ESX | Get-AdvancedSetting UserVars.HostClientSessionTimeout,Get-VMHost -Name $ESX | Get-AdvancedSetting UserVars.HostClientSessionTimeout | Set-AdvancedSetting -Value 900
esx-9.shell-interactive-timeout,IAC-25,VCFE-9X-000066,8.2.8,ESX,9.0.0,Base,Configure the inactivity timeout to automatically terminate idle ESX host shells.,"If a user forgets to log out of their SSH session, the idle connection will remain open indefinitely, increasing the potential for someone to gain privileged access to the host.",None.,P0,UserVars.ESXShellInteractiveTimeOut,0,900,NO,Modify,"ESX Advanced
System Settings",Get-VMHost -Name $ESX | Get-AdvancedSetting UserVars.ESXShellInteractiveTimeOut,Get-VMHost -Name $ESX | Get-AdvancedSetting UserVars.ESXShellInteractiveTimeOut | Set-AdvancedSetting -Value 900
esx-9.shell-timeout,IAC-25,VCFE-9X-000200,8.2.8,ESX,9.0.0,Base,Set a timeout to limit how long the ESX Shell and SSH services are allowed to run.,The ESXShellTimeOut defines a window of time after which the ESX Shell and SSH services will automatically be terminated.,None.,P0,UserVars.ESXShellTimeOut,0,600,NO,Modify,"ESX Advanced
System Settings",Get-VMHost -Name $ESX | Get-AdvancedSetting UserVars.ESXShellTimeOut,Get-VMHost -Name $ESX | Get-AdvancedSetting UserVars.ESXShellTimeOut | Set-AdvancedSetting -Value 600
esx-9.shell-warning,"END-04.7
MON-01.4",VCFE-9X-000224,2.2.6,ESX,9.0.0,Base,The ESX host must not suppress warnings that the ESX shell is enabled.,"Warnings indicating that SSH or the ESX Shell is enabled can be clues that an attack is in progress. It is important to ensure that SSH and the ESX Shell are deactivated, and that this variable is not set.",None.,P2,UserVars.SuppressShellWarning,0,0,YES,Audit,"ESX Advanced
System Settings",Get-VMHost -Name $ESX | Get-AdvancedSetting UserVars.SuppressShellWarning,Get-VMHost -Name $ESX | Get-AdvancedSetting UserVars.SuppressShellWarning | Set-AdvancedSetting -Value 0
esx-9.snmp,CFG-03,VCFE-9X-000215,"2.2.4
2.2.5",ESX,9.0.0,Base,The component must disable SNMP version 1 and 2.,Services which are not in use and are not essential for operations should be deactivated.,Attempts to use older versions of SNMP will fail.,P0,N/A,"Stopped,
Start and stop with host","Stopped,
Start and stop manually",NO,Modify,ESX Services Configuration,"Get-VMHostService -VMHost $ESX | Where-Object {$_.Key -eq 'snmpd' -and $_.Running -eq 'True'}
Get-VMHostService -VMHost $ESX | Where-Object {$_.Key -eq 'snmpd' -and $_.Policy -eq 'On'}","Get-VMHostService -VMHost $ESX | where {$_.Key -eq 'snmpd'} | Set-VMHostService -Policy Off
Get-VMHostService -VMHost $ESX | where {$_.Key -eq 'snmpd'} | Stop-VMHostService"
esx-9.ssh,CFG-03,VCFE-9X-000096,2.2.4,ESX,9.0.0,Base,The component must deactivate SSH.,Services which are not in use and are not essential for operations should be deactivated.,None.,P2,N/A,"Stopped,
Start and stop manually","Stopped,
Start and stop manually",YES,Audit,ESX Services Configuration,"Get-VMHostService -VMHost $ESX | Where-Object {$_.Key -eq 'TSM-SSH' -and $_.Running -eq 'True'}
Get-VMHostService -VMHost $ESX | Where-Object {$_.Key -eq 'TSM-SSH' -and $_.Policy -eq 'On'}","Get-VMHostService -VMHost $ESX | where {$_.Key -eq 'TSM-SSH'} | Set-VMHostService -Policy Off
Get-VMHostService -VMHost $ESX | where {$_.Key -eq 'TSM-SSH'} | Stop-VMHostService"
esx-9.ssh-configuration,"CRY-01
IAC-25","VCFE-9X-000206
VCFE-9X-000207
VCFE-9X-000208
VCFE-9X-000209
VCFE-9X-000210
VCFE-9X-000211
VCFE-9X-000212
VCFE-9X-000213
VCFE-9X-000214","8.2.8
8.3.2",ESX,9.0.0,SSH,The ESX host SSH daemon must be configured securely.,"OpenSSH on the ESX host ships with a FIPS 140-2/140-3 validated cryptographic module, and it is enabled by default. For backward compatibility reasons, this can be deactivated. Therefore, this setting must be audited and corrected if necessary.

Other parameters are set securely, but can be changed, so must be audited.",None.,P2,N/A,Configured,Configured,YES,Audit,N/A,"$ESXcli = Get-EsxCli -VMHost $ESX -V2
$ESXcli.system.ssh.server.config.list.Invoke()","$ESXcli = Get-EsxCli -VMHost $ESX -V2

# AllowStreamLocalForwarding
$arguments = $esxcli.system.ssh.server.config.set.CreateArgs()
$arguments.keyword = 'allowstreamlocalforwarding'
$arguments.value = 'no'
$esxcli.system.ssh.server.config.set.Invoke($arguments)

# AllowTcpForwarding
$arguments = $esxcli.system.ssh.server.config.set.CreateArgs()
$arguments.keyword = 'allowtcpforwarding'
$arguments.value = 'no'
$esxcli.system.ssh.server.config.set.Invoke($arguments)

# Banner
$arguments = $esxcli.system.ssh.server.config.set.CreateArgs()
$arguments.keyword = 'banner'
$arguments.value = '/etc/issue'
$esxcli.system.ssh.server.config.set.Invoke($arguments)

# ChallengeResponseAuthentication
$arguments = $esxcli.system.ssh.server.config.set.CreateArgs()
$arguments.keyword = 'challengeresponseauthentication'
$arguments.value = 'yes'
$esxcli.system.ssh.server.config.set.Invoke($arguments)

# Ciphers
$arguments = $esxcli.system.ssh.server.config.set.CreateArgs()
$arguments.keyword = 'ciphers'
$arguments.value = 'aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr'
$esxcli.system.ssh.server.config.set.Invoke($arguments)

# ClientAliveCountMax
$arguments = $esxcli.system.ssh.server.config.set.CreateArgs()
$arguments.keyword = 'clientalivecountmax'
$arguments.value = '3'
$esxcli.system.ssh.server.config.set.Invoke($arguments)

# ClientAliveInterval
$arguments = $esxcli.system.ssh.server.config.set.CreateArgs()
$arguments.keyword = 'clientaliveinterval'
$arguments.value = '200'
$esxcli.system.ssh.server.config.set.Invoke($arguments)

# FipsMode
$arguments = $esxcli.system.ssh.server.config.set.CreateArgs()
$arguments.keyword = 'fipsmode'
$arguments.value = 'yes'
$esxcli.system.ssh.server.config.set.Invoke($arguments)

# GatewayPorts
$arguments = $esxcli.system.ssh.server.config.set.CreateArgs()
$arguments.keyword = 'gatewayports'
$arguments.value = 'no'
$esxcli.system.ssh.server.config.set.Invoke($arguments)

# HostBasedAuthentication
$arguments = $esxcli.system.ssh.server.config.set.CreateArgs()
$arguments.keyword = 'hostbasedauthentication'
$arguments.value = 'no'
$esxcli.system.ssh.server.config.set.Invoke($arguments)

# HostKeyAlgorithms
$arguments = $esxcli.system.ssh.server.config.set.CreateArgs()
$arguments.keyword = 'hostkeyalgorithms'
$arguments.value = 'ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521,rsa-sha2-256,rsa-sha2-512'
$esxcli.system.ssh.server.config.set.Invoke($arguments)

# IgnoreRhosts
$arguments = $esxcli.system.ssh.server.config.set.CreateArgs()
$arguments.keyword = 'ignorerhosts'
$arguments.value = 'yes'
$esxcli.system.ssh.server.config.set.Invoke($arguments)

# KexAlgorithms
$arguments = $esxcli.system.ssh.server.config.set.CreateArgs()
$arguments.keyword = 'kexalgorithms'
$arguments.value = 'ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256'
$esxcli.system.ssh.server.config.set.Invoke($arguments)

# LogLevel
$arguments = $esxcli.system.ssh.server.config.set.CreateArgs()
$arguments.keyword = 'loglevel'
$arguments.value = 'info'
$esxcli.system.ssh.server.config.set.Invoke($arguments)

# MACs
$arguments = $esxcli.system.ssh.server.config.set.CreateArgs()
$arguments.keyword = 'macs'
$arguments.value = 'hmac-sha2-256,hmac-sha2-512'
$esxcli.system.ssh.server.config.set.Invoke($arguments)

# MaxStartups
$arguments = $esxcli.system.ssh.server.config.set.CreateArgs()
$arguments.keyword = 'maxstartups'
$arguments.value = '10:30:100'
$esxcli.system.ssh.server.config.set.Invoke($arguments)

# PermitRootLogin
$arguments = $esxcli.system.ssh.server.config.set.CreateArgs()
$arguments.keyword = 'permitrootlogin'
$arguments.value = 'yes'
$esxcli.system.ssh.server.config.set.Invoke($arguments)

# PermitTunnel
$arguments = $esxcli.system.ssh.server.config.set.CreateArgs()
$arguments.keyword = 'permittunnel'
$arguments.value = 'no'
$esxcli.system.ssh.server.config.set.Invoke($arguments)

# PermitUserEnvironment
$arguments = $esxcli.system.ssh.server.config.set.CreateArgs()
$arguments.keyword = 'permituserenvironment'
$arguments.value = 'no'
$esxcli.system.ssh.server.config.set.Invoke($arguments)

# PrintMotd
$arguments = $esxcli.system.ssh.server.config.set.CreateArgs()
$arguments.keyword = 'printmotd'
$arguments.value = 'yes'
$esxcli.system.ssh.server.config.set.Invoke($arguments)

# RekeyLimit
$arguments = $esxcli.system.ssh.server.config.set.CreateArgs()
$arguments.keyword = 'rekeylimit'
$arguments.value = '1G, 1H'
$esxcli.system.ssh.server.config.set.Invoke($arguments)

# SyslogFacility
$arguments = $esxcli.system.ssh.server.config.set.CreateArgs()
$arguments.keyword = 'syslogfacility'
$arguments.value = 'auth'
$esxcli.system.ssh.server.config.set.Invoke($arguments)

# TCPKeepAlive
$arguments = $esxcli.system.ssh.server.config.set.CreateArgs()
$arguments.keyword = 'tcpkeepalive'
$arguments.value = 'yes'
$esxcli.system.ssh.server.config.set.Invoke($arguments)

# UsePAM
$arguments = $esxcli.system.ssh.server.config.set.CreateArgs()
$arguments.keyword = 'usepam'
$arguments.value = 'yes'
$esxcli.system.ssh.server.config.set.Invoke($arguments)"
esx-9.supported,"VPM-01
VPM-04",N/A,6.3.3,ESX,9.0.0,Base,ESX host is running software that has not reached End of General Support status.,Ensure that ESX is a version that has not reached the End of General Support status.,"Always read release notes, test, and deploy using staged rollouts.",P0,N/A,N/A,N/A,YES,Audit,Compare ESX build numbers to latest available version on customerconnect.vmware.com,"Get-VMHost -Name $ESX | Select-Object Name,Version,Build",N/A
esx-9.time,"MON-07.1
SEA-20",VCFE-9X-000121,"10.6.1
10.6.2",ESX,9.0.0,Base,The component must synchronize its clock with organizational reference sources.,"Cryptography, audit logging, cluster operations, and incident response/forensics require synchronized time across environments. The recommended practice for NTP is to have at least four sources. It is not advisable to have only two sources; one source is preferable to having two (Segal's Law: a person with one watch always knows what time it is, a person with two is never sure).

Configure all components to use the global standard time zone, UTC.

NTP uses UDP to communicate, which, if allowed generically, can open a path for attackers to exfiltrate data during a breach. Ensure that perimeter firewall rules allowing communication to NTP servers are specific. ",None.,P0,N/A,Undefined,Site-Specific,NO,Modify,ESX Services Configuration,"Get-VMHostService -VMHost $ESX | Where-Object{$_.Key -eq ""ntpd""}","Get-VMHostService -VMHost $ESX -ErrorAction:Stop | Where-Object{$_.Key -eq ""ntpd""} | Set-VMHostService -policy ""on"" -Confirm:$false
Get-VMHostService -VMHost $ESX -ErrorAction:Stop | Where-Object{$_.Key -eq ""ntpd""} | Restart-VMHostService -Confirm:$false"
esx-9.tls-ciphers,"CRY-03
CRY-01",VCFE-9X-000014,"2.2.7
4.2.1
8.3.2",ESX,9.0.0,Base,"The component must maintain confidentiality and integrity of transmissions by ensuring the use of approved, modern, replay-resistent ciphers.","In ESX 8.0.3 and newer, TLS profiles are available to configure client and server TLS settings to use only strong ciphers.

You can view the entire cipher list and suites using:

$ESXcli = Get-EsxCli -VMHost $ESX -V2
$arguments = $ESXcli.system.tls.server.get.CreateArgs()
$arguments.showprofiledefaults = $true
$arguments.showcurrentbootprofile = $true
$ESXcli.system.tls.server.get.invoke($arguments)

The host will require a reboot after setting this parameter (and will display in the vSphere Client with the suffix of ""(Reboot Required).""","Changes to cipher suites impact connectivity with other components and external systems, and may require a restart of the component to implement.",P0,N/A,COMPATIBLE,NIST_2024,NO,Modify,esxcli,"$ESXcli = Get-EsxCli -VMHost $ESX -V2
$ESXcli.system.tls.server.get.invoke() | Select-Object -ExpandProperty Profile","$ESXcli = Get-EsxCli -VMHost $ESX -V2
$arguments = $ESXcli.system.tls.server.set.CreateArgs()
$arguments.profile = ""NIST_2024""
$ESXcli.system.tls.server.set.invoke($arguments)"
esx-9.tpm-configuration,"CRY-05
END-04.6",VCFE-9X-000193,5.2.3,ESX,9.0.0,Base,The ESX host must require TPM-based configuration encryption.,"An ESX host's configuration consists of configuration files for each service that runs on the host. The configuration files typically reside in the /etc/ directory, but they can also reside in other namespaces. The configuration files contain run-time information about the state of the services. Over time, the default values in the configuration files might change, for example, when settings on the ESX host are changed.

A cron job backs up the ESX configuration files periodically, when ESX shuts down gracefully or on demand, and creates an archived configuration file in the boot bank. When ESX reboots, it reads the archived configuration file and recreates the state that ESX was in when the backup was taken.

Before vSphere 7.0 Update 2, the archived ESX configuration file is not encrypted. In vSphere 7.0 Update 2 and later, the archived configuration file is encrypted. When the ESX host is configured with a Trusted Platform Module (TPM), the TPM is used to ""seal"" the configuration to the host, providing a strong security guarantee and additional protection from offline attacks.

Configuration encryption uses the physical TPM when it is available and supported at install or upgrade time. If the TPM was added or enabled later, the ESX host must be told to reconfigure to use the newly available TPM. Once the TPM configuration encryption is enabled, it cannot be deactivated.",Use of Secure Boot and TPM-enforced Configuration Encryption render traditional root password recovery efforts unusable. Ensure that you do not lose access to administrator accounts on ESX.,P0,N/A,Site-Specific,TPM,YES,Audit,ESX Shell,"$ESXcli = Get-EsxCli -VMHost $ESX -V2
$ESXcli.system.settings.encryption.get.Invoke() | Select Mode","$ESXcli = Get-EsxCli -VMHost $ESX -V2
$arguments = $ESXcli.system.settings.encryption.set.CreateArgs()
$arguments.mode = ""TPM""
$ESXcli.system.settings.encryption.set.Invoke($arguments)"
esx-9.tpm-trusted-binaries,END-04.6,VCFE-9X-000229,5.2.3,ESX,9.0.0,TPM,"The ESX host must enable ""execInstalledOnly"" enforcement for configuration encryption.","The ""execInstalledOnly"" advanced ESX boot option, when enabled, helps protect your hosts against ransomware attacks by ensuring that the VMkernel executes only those binaries on a host that have been properly packaged and signed as part of a valid VIB. While this option is effective on its own, it can be further enhanced by telling the Secure Boot to check with the TPM to make sure that the boot process does not proceed unless this setting is enabled. This further protects against malicious offline changes to ESX configuration to disable the ""execInstalledOnly"" option.",Use of Secure Boot and TPM-enforced Configuration Encryption render traditional root password recovery efforts unusable. Ensure that you do not lose access to administrator accounts on ESX.,P2,N/A,TRUE,TRUE,YES,Audit,esxcli,"$ESXcli = Get-EsxCli -VMHost $ESX -V2
$ESXcli.system.settings.encryption.get.Invoke() | Select RequireExecutablesOnlyFromInstalledVIBs","$ESXcli = Get-EsxCli -VMHost $ESX -V2
$arguments = $ESXcli.system.settings.encryption.set.CreateArgs()
$arguments.requireexecinstalledonly = $true
$ESXcli.system.settings.encryption.set.Invoke($arguments)"
esx-9.transparent-page-sharing,SEA-03,VCFE-9X-000064,2.2.6,ESX,9.0.0,Base,The ESX host must restrict inter-VM transparent page sharing to VMs configured with sched.mem.pshare.salt.,"Transparent Page Sharing (TPS) is a method used to reduce the memory usage of virtual machines. However, under specific conditions, it can potentially be exploited to gain unauthorized access to data on neighboring virtual machines.

Virtual machines that do not have the sched.mem.pshare.salt option set are unable to share memory with any other virtual machines, providing an additional layer of isolation and security.",None.,P2,Mem.ShareForceSalting,2,2,YES,Audit,"ESX Advanced
System Settings",Get-VMHost -Name $ESX | Get-AdvancedSetting Mem.ShareForceSalting,Get-VMHost -Name $ESX | Get-AdvancedSetting Mem.ShareForceSalting | Set-AdvancedSetting -Value 2
esx-9.updates,VPM-05,N/A,6.3.3,ESX,9.0.0,Base,ESX host has all software updates installed.,"By keeping ESX patches up to date, vulnerabilities in the hypervisor can be mitigated. It is important to note that educated attackers can exploit known vulnerabilities when attempting to gain unauthorized access or elevate privileges on an ESX host.

When applying updates, it is recommended to update vCenter Server first, if an update is available, and then proceed with updating ESX. This sequence ensures that the management layer is updated before updating the ESX hosts.",vSphere Update releases add and change functionality; Patch releases only resolve issues.,P0,N/A,Downlevel,Current,NO,Modify,Compare ESX build numbers to latest available version on customerconnect.vmware.com,"Get-VMHost -Name $ESX | Select-Object Name,Version,Build",N/A
esx-9.vib-acceptance-level-supported,"TDA-01.2
END-04.6",VCFE-9X-000130,5.2.3,ESX,9.0.0,Base,The ESX host image profile acceptance level must be PartnerSupported or higher.,"The acceptance level in ESX controls what can be installed on the system. There are four levels: VMwareCertified, VMwareAccepted, PartnerSupported, and CommunitySupported.

It is important to note that CommunitySupported VIBs (vSphere Installation Bundles) have not undergone testing by VMware or a VMware partner, and they do not have a digital signature. It is considered risky to install CommunitySupported VIBs as their reliability and security cannot be guaranteed.",CommunitySupported packages are unsigned and will not be able to be installed.,P2,N/A,PartnerSupported,PartnerSupported or Higher,YES,Audit,ESX Security Profile,(Get-EsxCli -VMHost $ESX -V2).software.acceptance.get.Invoke(),"$ESXcli = Get-EsxCli -VMHost $ESX -V2
$arguments = $ESXcli.software.acceptance.set.CreateArgs()
$arguments.level = ""PartnerSupported"" # VMwareCertified, VMwareAccepted, PartnerSupported, CommunitySupported
$ESXcli.software.acceptance.set.Invoke($arguments)"
esx-9.vib-trusted-binaries,END-04.6,VCFE-9X-000228,5.2.3,ESX,9.0.0,Base,Only run binaries delivered via signed VIB.,"ESX conducts integrity checks of ""vSphere Installable Bundles"" or VIBs, governed by the Acceptance Level (see below). Instructing ESX to only execute binaries that originated from a valid VIB installed on the host makes it harder for attackers to use prebuilt toolkits.",Third-party unsigned software may not install or execute.,P2,VMkernel.Boot.execInstalledOnly,TRUE,TRUE,YES,Audit,"ESX Advanced
System Settings",Get-VMHost -Name $ESX | Get-AdvancedSetting VMkernel.Boot.execInstalledOnly,Get-VMHost -Name $ESX | Get-AdvancedSetting VMkernel.Boot.execInstalledOnly | Set-AdvancedSetting -Value True
esx-9.vmk-management,"NET-06
NET-04.1",VCFE-9X-000203,1.4.2,ESX,9.0.0,Base,The ESX host must isolate management communications.,"VMkernel network interfaces that are intended for specialized use can be configured with management capabilities, which may defeat network isolation and security efforts. Ensure that only vmk interfaces intended for management have management services enabled.

Ensure that all management interfaces configured for virtualization components are on a network segment (VLAN, etc.) dedicated only to virtualization management, free of workloads and unrelated systems, and controlled with perimeter security controls such that only authorized vSphere Administrators can access those interfaces from authorized workstations.

Some system designs put vCenter Server and other management tools on their own network segments, isolated from ESX, thinking that it offers them better monitoring of those systems. Others put vCenter Server in with ESX management as well because of the relationship between the two products and the possibility of firewall configuration errors or outages disrupting service. Whichever you choose, do so thoughtfully.",Some third-party managed solutions may require this.,P2,N/A,Site-Specific,Site-Specific,YES,Audit,ESX VMkernel Adapters,"Get-VMHostNetworkAdapter -VMHost $ESX -VMKernel | Select VMHost,Name,IP,ManagementTrafficEnabled",Get-VMHostNetworkAdapter -VMHost $ESX -Name $vmkernel_interface | Set-VMHostNetworkAdapter -ManagementTrafficEnabled $false
esx-9.vmk-storage,"CRY-03
NET-06",VCFE-9X-000204,1.4.2,ESX,9.0.0,Base,The ESX host must protect the confidentiality and integrity of transmitted storage traffic.,"As with many security controls there is a tradeoff with performance, so care should be taken to monitor storage latency and performance as data-in-transit encryption is enabled. Organizations that do not or can not enable data-in-transit encryption should isolate the network traffic to a dedicated network segment with appropriate perimeter controls. Isolation to a dedicated network segment with appropriate perimeter controls can be an effective compensating control and add defense-in-depth..

vSAN features data-in-transit encryption which can maintain confidentiality as vSAN nodes communicate. 

Use of krb5p mount options for NFS v4.1 datastores ensures confidentiality. 

LUN masking on the storage controller and SAN zoning help ensure that storage traffic is not visible to unauthorized hosts and that unauthorized hosts cannot mount the datastores, bypassing other security controls.",See discussion.,P0,N/A,Not Configured,Configured,NO,Modify,N/A,"Get-VMHostNetworkAdapter -VMHost $ESX -VMKernel | Select VMHost,Name,IP,VsanTrafficEnabled",Get-VMHostNetworkAdapter -VMHost $ESX -Name $vmkernel_interface | Set-VMHostNetworkAdapter -VsanTrafficEnabled $false
esx-9.vmk-vmotion,"CRY-03
NET-06",VCFE-9X-000152,1.4.2,ESX,9.0.0,Base,The ESX host must protect the confidentiality and integrity of transmitted vMotion traffic.,"vMotion and Storage vMotion copy virtual machine memory and storage data, respectively, across the network. Ensuring that the data is encrypted in transit ensures confidentiality. Isolation to a dedicated network segment with appropriate perimeter controls can add defense-in-depth and also allow for network traffic management.

Like all other forms of encryption, vMotion encryption does introduce performance loss, but that performance change is on the background vMotion process and does not impact the operation of the virtual machine.",See discussion.,P0,N/A,Not Configured,Configured,NO,Modify,N/A,"Get-VMHostNetworkAdapter -VMHost $ESX -VMKernel | Select VMHost,Name,IP,VMotionEnabled",Get-VMHostNetworkAdapter -VMHost $ESX -Name $vmkernel_interface | Set-VMHostNetworkAdapter -VMotionEnabled $false
fleet-9.log-forwarding,MON-02,VCFA-9X-000365,"10.2.1
10.3.3",Operations,9.0.0,Fleet Management,Component must securely forward system and audit logs to a remote log collection point.,"By gathering host log files onto a central host, you can more easily monitor all hosts using a single tool. Additionally, you can perform aggregate analysis and searching to identify coordinated attacks on multiple hosts. Logging to a secure and centralized log server helps prevent log tampering and ensures a unified, long-term audit record.",None.,P0,N/A,Not Configured,Configured,NO,Modify,N/A,N/A,N/A
guest-9.tools-add-feature,"CFG-03
CHG-01",N/A,2.2.6,ESX,9.0.0,VMware Tools,The guest OS must limit the automatic addition of VMware Tools features.,"VMware Tools automatic upgrade processes can add or remove features from the VMware Tools installation, which can be helpful but also presents an opportunity to alter the security profile of the guest OS from vSphere.",Administrators will need to use other methods to update and reconfigure VMware Tools when needed.,P0,autoupgrade allow-add-feature,true,false,NO,Modify,tools.conf,C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config get autoupgrade allow-add-feature,C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config set autoupgrade allow-add-feature false
guest-9.tools-allow-transforms,"CFG-03
CHG-01",N/A,2.2.6,ESX,9.0.0,VMware Tools,The guest OS must limit the use of MSI transforms when reconfiguring VMware Tools.,MSI transforms allow the installation database on Microsoft Windows guest OSes to be changed. This can be helpful but also presents an opportunity to alter the security profile of the guest OS from vSphere.,Administrators will need to use other methods to update and reconfigure VMware Tools when needed.,P2,autoupgrade allow-msi-transforms,false,false,YES,Audit,tools.conf,C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config get autoupgrade allow-msi-transforms,C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config set autoupgrade allow-msi-transforms false
guest-9.tools-deactivate-appinfo,"CFG-03
PRI-05",N/A,1.4.5,ESX,9.0.0,VMware Tools,The guest OS must deactivate Appinfo information gathering unless required.,Appinfo is a method to do application discovery through VMware Tools. If you are not using this tool deactivate the module to reduce attack surface.,Products and services within the VMware ecosystem may require this functionality.,P0,appinfo disabled,false,true,NO,Modify,tools.conf,C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config get appinfo disabled,C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config set appinfo disabled true
guest-9.tools-deactivate-containerinfo,"CFG-03
PRI-05",N/A,1.4.5,ESX,9.0.0,VMware Tools,The guest OS must deactivate ContainerInfo unless required.,The VMware Tools ContainerInfo plugin for Linux gathers the list of running containers inside a Linux guest operating system.,Products and services within the VMware ecosystem may require this functionality.,P0,containerinfo poll-interval,21600,0,NO,Modify,tools.conf,C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config get containerinfo poll-interval,C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config set containerinfo poll-interval 0
guest-9.tools-deactivate-guestoperations,"CFG-03
CHG-01",N/A,1.4.5,ESX,9.0.0,VMware Tools,The guest OS must deactivate Guest Operations unless required.,"Guest Operations are a set of functions that underpin most host-to-guest interaction. Deactivating them reduces attack surface but also drastically reduces functionality. Ensure that your environment does not require these functions. Do not do this on template VMs. For a list of functions see:

https://vdc-download.vmware.com/vmwb-repository/dcr-public/fe08899f-1eec-4d8d-b3bc-a6664c168c2c/7fdf97a1-4c0d-4be0-9d43-2ceebbc174d9/doc/vim.vm.guest.GuestOperationsManager.html","Products and services within the VMware ecosystem may require this functionality. In particular, VMware Live Recovery requires this functionality to be enabled in order to reconfigure VMs during a failover.",Advanced,guestoperations disabled,false,true,NO,Modify,tools.conf,C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config get guestoperations disabled,C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config set guestoperations disabled true
guest-9.tools-deactivate-gueststoreupgrade,"CFG-03
CHG-01",N/A,2.2.4,ESX,9.0.0,VMware Tools,The guest OS must deactivate Guest Store Upgrade operations unless required.,The GuestStore feature provides a simple and flexible mechanism to distribute VMware specific or custom content from a GuestStore repository to multiple guests simultaneously. If you are not using this feature disable the plugin to reduce attack surface.,Products and services within the VMware ecosystem may require this functionality.,P0,gueststoreupgrade policy,manual,off,NO,Modify,tools.conf,C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config get gueststoreupgrade policy,C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config set gueststoreupgrade policy off
guest-9.tools-deactivate-servicediscovery,"CFG-03
PRI-05",N/A,1.4.5,ESX,9.0.0,VMware Tools,The guest OS must deactivate Service Discovery unless required.,The VMware Tools Service Discovery plugin connects to VCF Operations and provides additional data to that product about guests and workloads. If you are not using this feature disable the plugin to reduce attack surface.,Products and services within the VMware ecosystem may require this functionality.,P0,servicediscovery disabled,false,true,NO,Modify,tools.conf,C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config get servicediscovery disabled,C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config set servicediscovery disabled true
guest-9.tools-globalconf,"CFG-03
CHG-01",N/A,2.2.6,ESX,9.0.0,VMware Tools,The guest OS must deactivate GlobalConf unless required.,The GlobalConf feature of VMware Tools provides an ability to push tools.conf configurations to virtual machines.,Administrators will need to use other methods to update and reconfigure VMware Tools when needed.,P2,globalconf enabled,false,false,YES,Audit,tools.conf,C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config get globalconf enabled,C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config set globalconf enabled false
guest-9.tools-log-forwarding,MON-02,N/A,"10.2.1
10.3.3",ESX,9.0.0,VMware Tools,The guest OS must send VMware Tools logs to the system log service.,"By default, VMware Tools sends logs to a file on disk. By setting this parameter it will send them to syslog on Linux guests and the Windows Event Service on Microsoft Windows guests, wherein they can be monitored, managed, and archived centrally.",Processes that rely on these files being in a default location will need to be updated.,P0,logging vmsvc.handler,file,syslog,NO,Modify,tools.conf,"C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config get logging vmsvc.handler
C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config get logging toolboxcmd.handler
C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config get logging vgauthsvc.handler
C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config get logging vmtoolsd.handler","C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config set logging vmsvc.handler syslog
C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config set logging toolboxcmd.handler syslog
C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config set logging vgauthsvc.handler syslog
C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config set logging vmtoolsd.handler syslog"
guest-9.tools-logs,MON-03,N/A,10.2.1,ESX,9.0.0,VMware Tools,The guest OS must enable VMware Tools logging.,"Ensure that VMware Tools is logging information as appropriate. Logging in VMware Tools is very customizable, please see the examples in https://github.com/vmware/open-vm-tools/blob/master/open-vm-tools/tools.conf",None.,P2,logging log,true,true,YES,Audit,tools.conf,C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config get logging log,C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config set logging log true
guest-9.tools-prevent-recustomization,"DCH-06
CFG-03",N/A,2.2.6,ESX,9.0.0,VMware Tools,The guest OS on deployed and customized virtual machines must prevent being recustomized.,"The VM deployment process offers many options for vSphere Admins to customize VMs, using scripts and running commands. This can also be an avenue for an adversary to gain access to data inside a VM, by cloning & recustomizing. Once a VM is deployed it should be prevented from being customized again (if you change your mind you can always revert it). Do not do this on template VMs.","Once set, VMs will not be able to be customized when they are cloned. Do not set this on template VMs.

This may impact disaster recovery processes that change IP addresses, through VMware Live Recovery or VMware Cloud Disaster Recovery. For more information see: 

https://docs.vmware.com/en/VMware-Cloud-Disaster-Recovery/services/vmware-cloud-disaster-recovery/GUID-94202BE7-FEAF-4E35-8B55-15F6B3798309.html",P0,deployPkg enable-customization,true,false,NO,Modify,tools.conf,C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config get deployPkg enable-customization,C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config set deployPkg enable-customization false
guest-9.tools-remove-feature,"CFG-03
CHG-01",N/A,2.2.6,ESX,9.0.0,VMware Tools,The guest OS must limit the automatic removal of VMware Tools features.,"VMware Tools automatic upgrade processes can add or remove features from the VMware Tools installation, which can be helpful but also presents an opportunity to alter the security profile of the guest OS from vSphere.",Administrators will need to use other methods to update and reconfigure VMware Tools when needed.,P0,autoupgrade allow-remove-feature,true,false,NO,Modify,tools.conf,C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config get autoupgrade allow-remove-feature,C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config set autoupgrade allow-remove-feature false
guest-9.tools-updates,VPM-05,N/A,6.3.3,ESX,9.0.0,VMware Tools,The guest OS must ensure that VMware Tools are updated.,"VMware Tools are an important part of the VMware ecosystem, enabling guest OSes to be shut down gracefully, managed throughout their lifecycle, providing drivers for paravirtualized devices, and helping to deploy and customize VMs from templates. Like all other software the VMware Tools need to be managed and updated. Ensure that you are running a supported version for your guest OS, whether it is delivered as part of the Linux distribution or installed by you for Microsoft Windows.",None.,P0,N/A,N/A,N/A,NO,Audit,VM Status,"Get-VM -Name $VM | Select-Object -Property Name,@{Name='ToolsVersion';Expression={$_.Guest.ToolsVersion}}","Site-Specific. Multiple ways to update VMware Tools. Drivers for vmxnet3 and pvscsi are also available via Windows Update, please ensure you are importing them into tools such as WSUS."
guest-9.tools-upgrade,VPM-05,N/A,2.2.6,ESX,9.0.0,VMware Tools,The guest OS must configure automatic VMware Tools upgrades as appropriate for the environment.,"VMware Tools updates can be initiated by vSphere, which can be helpful for maintaining current VMware Tools versions. If VMware Tools is being managed and updated in other ways this functionality should be deactivated. This baseline suggests leaving automatic updates enabled.",Administrators will need to use other methods to update and reconfigure VMware Tools when needed.,P0,autoupgrade allow-upgrade,true,true,YES,Audit,tools.conf,C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config get autoupgrade allow-upgrade,C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config set autoupgrade allow-upgrade true
installer-9.security,CFG-03,N/A,2.2.4,Installer,9.0.0,Base,"Remove or power off the VCF Installer appliance once deployment is finished, if it has not assumed the role of SDDC Manager in  your deployment.","Once deployment is done and the VCF Installer is no longer needed, remove or power it off to reduce attack surface and audit scope.

If the VCF Installer was deployed to an ESX host it will be converted into the SDDC Manager component. In this case you should not remove it.",None.,P0,N/A,Configured,Either removed or confirmed that it has been converted to the SDDC Manager.,NO,Modify,N/A,N/A,N/A
logs-9.login-message,SEA-18,VCFA-9X-000359,2.2.6,Operations,9.0.0,Base,The component must display a message prior to user login.,"While not a direct security control, a login message or banner is  used to inform authorized users of their responsibilities and conditions for system use, as well as to enable disciplinary action and/or prosecution of unauthorized behavior.",None.,P1,N/A,Not Configured,"Consult your organization's legal advisors for text that is applicable to your environment.

An example is: ""Authorized users only. Actual or attempted unauthorized use of this system is prohibited and may result in criminal, civil, security, or administrative proceedings and/or penalties. Use of this information system indicates consent to monitoring and recording, without notice or permission. Users have no expectation of privacy in any use of this system. Any information stored on, or transiting this system, or obtained by monitoring and/or recording, may be disclosed to law enforcement and/or used in accordance with Federal law, State statute, and organization policy. If you are not an authorized user of this system, exit the system at this time.""",NO,Modify,N/A,N/A,N/A
logs-9.log-receiving,MON-02,N/A,"10.2.1
10.3.3",Operations,9.0.0,Logs,VCF Operations for Logs must be configured to accept forwarded logs from VCF components.,"By gathering host log files onto a central host, you can more easily monitor all hosts using a single tool. Additionally, you can perform aggregate analysis and searching to identify coordinated attacks on multiple hosts. Logging to a secure and centralized log server helps prevent log tampering and ensures a unified, long-term audit record.",None.,P0,N/A,Not Configured,Configured,NO,Modify,N/A,N/A,N/A
logs-9.password-complexity,IAC-10.1,VCFA-9X-000357,"8.3.1
8.3.6",Operations,9.0.0,Logs,VCF Operations for Logs must enforce password complexity requirements.,"Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. 

Password complexity is one factor of several that determine how long it takes to crack a password. The more complex the password is, the greater the number of possible combinations that need to be tested before the password is compromised.",None.,P0,"VCF Operations for Logs, go to Configuration >> General",Not Configured,Configured,NO,Modify,N/A,N/A,N/A
logs-9.retention-alert,"MON-05.2
MON-04",VCFA-9X-000142,10.5.1,Operations,9.0.0,Base,VCF Operations for Logs must provide a warning when audit record storage is low.,Configuring alerts for storage usage enables corrective action and storage expansion to be handled in a timely manner.,None.,P0,Retention Notification Threshold,Not Set,30 days,NO,Modify,Configuration -> General,N/A,N/A
logs-9.session-timeout,IAC-25,VCFA-9X-000358,8.2.8,Operations,9.0.0,Logs,VMware Cloud Foundation components must enforce a session timeout after a specified period of inactivity.,"This practice helps mitigate potential security risks by ensuring that unattended sessions, which could be exploited by unauthorized users or malicious software, are not left open indefinitely.",None.,P0,N/A,Not Configured,Configured,NO,Modify,N/A,N/A,N/A
logs-9.tls-ciphers,"CRY-03
CRY-01",VCFA-9X-000196,"2.2.7
4.2.1
8.3.2",Operations,9.0.0,Base,"The component must maintain confidentiality and integrity of transmissions by ensuring the use of approved, modern, replay-resistent ciphers.",Data-in-transit encryption is essential for network communications.,"Changes to cipher suites impact connectivity with other components and external systems, and may require a restart of the component to implement.",P2,N/A,Enabled,Enabled,YES,Audit,"From VCF Operations for Logs, go to Configuration >> SSL >> API Server SSL",N/A,N/A
networks-9.enable-monitoring,"MON-01
NET-03",N/A,"1.2.3
1.2.4",Operations,9.0.0,Networks,VCF must enable Operations for Networks monitoring.,VCF Operations for Networks allows comprehensive monitoring of network activity by workloads and infrastructure.,None.,P1,See documentation on enabling VCF Operations for Networks.,N/A,N/A,NO,Modify,N/A,N/A,N/A
networks-9.session-timeout,IAC-25,VCFA-9X-000376,8.2.8,Operations,9.0.0,Networks,VMware Cloud Foundation components must enforce a session timeout after a specified period of inactivity.,"This practice helps mitigate potential security risks by ensuring that unattended sessions, which could be exploited by unauthorized users or malicious software, are not left open indefinitely.",None.,P0,N/A,Not Configured,Configured,NO,Modify,N/A,N/A,N/A
nsx-9.account-lockout-max-attempts,IAC-22,VCFN-9X-000012,8.3.4,NSX,9.0.0,Base,"The VMware Cloud Foundation NSX Manager must be configured to enforce the limit of three consecutive invalid logon attempts, after which time it must block any login attempt for 15 minutes.","By limiting the number of failed login attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute-forcing, is reduced.",None.,P0,N/A,Not Configured,"From an NSX Manager shell, run the following commands:

> set auth-policy api lockout-reset-period 900
> set auth-policy api lockout-period 900
> set auth-policy api max-auth-failures 3
> set auth-policy cli lockout-period 900
> set auth-policy cli max-auth-failures 3",NO,Modify,NSX Manager Shell,N/A,N/A
nsx-9.dhcp-disable,CFG-03,VCFN-9X-000027,2.2.4,NSX,9.0.0,Tier-0,NSX must not enable DHCP unless it is required.,"A compromised router introduces risk to the entire network infrastructure, as well as data resources that are accessible via the network. The perimeter defense has no oversight or control of attacks by malicious users within the network. Preventing network breaches from within is dependent on implementing a comprehensive defense-in-depth strategy, including securing each device connected to the network. This is accomplished by following and implementing all security guidance applicable for each node type. A fundamental step in securing each router is to enable only the capabilities required for operation.",None.,P0,N/A,Disabled,Disabled,YES,Audit,"Networking, Connectivity,
Tier-0 Gateways",N/A,N/A
nsx-9.inactive-interfaces,CFG-03,VCFN-9X-000016,2.2.4,NSX,9.0.0,Tier-0,NSX must remove all inactive interfaces.,"An inactive interface is rarely monitored or controlled and may expose a network to an undetected attack on that interface. Unauthorized personnel with access to the communication facility could gain access to a router by connecting to a configured interface that is not in use.

If an interface is no longer used, the configuration must be deleted and the interface disabled. For sub-interfaces, delete sub-interfaces that are on inactive interfaces and delete sub-interfaces that are themselves inactive. If the sub-interface is no longer necessary for authorized communications, it must be deleted.",None.,P0,N/A,Site-Specific,Disabled,NO,Modify,"Networking, Connectivity,
Tier-0 Gateways",N/A,N/A
nsx-9.login-message,SEA-18,VCFN-9X-000013,2.2.6,NSX,9.0.0,Base,The component must display a message prior to user login.,"While not a direct security control, a login message or banner is  used to inform authorized users of their responsibilities and conditions for system use, as well as to enable disciplinary action and/or prosecution of unauthorized behavior.",None.,P1,N/A,Undefined,"Consult your organization's legal advisors for text that is applicable to your environment.

An example is: ""Authorized users only. Actual or attempted unauthorized use of this system is prohibited and may result in criminal, civil, security, or administrative proceedings and/or penalties. Use of this information system indicates consent to monitoring and recording, without notice or permission. Users have no expectation of privacy in any use of this system. Any information stored on, or transiting this system, or obtained by monitoring and/or recording, may be disclosed to law enforcement and/or used in accordance with Federal law, State statute, and organization policy. If you are not an authorized user of this system, exit the system at this time.""",NO,Modify,N/A,N/A,N/A
nsx-9.log-level,MON-03,VCFN-9X-000007,"10.2.1
10.3.3",NSX,9.0.0,Base,The VMware Cloud Foundation NSX Manager must configure logging levels  to ensure audit records are generated.,It is important to ensure that sufficient information is present in audit logs for diagnostics and forensics purposes.,Additional storage space consumed by logs.,P0,"From an NSX Manager shell, run the following NSX CLI commands:

> set service async_replicator logging-level info
> set service auth logging-level info
> set service http logging-level info
> set service manager logging-level info
> set service telemetry logging-level info",error,info,NO,Modify,NSX Manager Shell,N/A,N/A
nsx-9.multicast-disable,CFG-03,VCFN-9X-000013,2.2.4,NSX,9.0.0,Base,NSX must disable Protocol Independent Multicast where multicast is not required.,"If multicast traffic is forwarded beyond the intended boundary, it is possible that it can be intercepted by unauthorized or unintended personnel. Limiting where, within the network, a given multicast group's data is permitted to flow is an important first step in improving multicast security. 

A scope zone is an instance of a connected region of a given scope. Zones of the same scope cannot overlap while zones of a smaller scope will fit completely within a zone of a larger scope. For example, Admin-local scope is smaller than Site-local scope, so the administratively configured boundary fits within the bounds of a site. According to RFC 4007 IPv6 Scoped Address Architecture (section 5), scope zones are also required to be ""convex from a routing perspective""; that is, packets routed within a zone must not pass through any links that are outside of the zone. This requirement forces each zone to be one contiguous island rather than a series of separate islands. ",None.,"P0
Upon Feature Enablement",N/A,Enabled,Disabled,NO,Modify,"Networking, Connectivity,
Tier-0 Gateways",N/A,N/A
nsx-9.ospf-encryption,"CRY-03
CRY-06",VCFN-9X-000029,"2.2.7
4.2.1
8.3.2",NSX,9.0.0,Tier-0,NSX must enable OSPF encryption.,"A rogue router could send a fictitious routing update to convince a site's perimeter router to send traffic to an incorrect or even a rogue destination. This diverted traffic could be analyzed to learn confidential information about the site's network or used to disrupt the network's ability to communicate with other networks. This is known as a ""traffic attraction attack"" and is prevented by configuring neighbor router authentication for routing updates. However, using clear-text authentication provides little benefit since an attacker can intercept traffic and view the authentication key. This would allow the attacker to use the authentication key in an attack.

This requirement applies to all IPv4 and IPv6 protocols that are used to exchange routing or packet forwarding information; this includes all Interior Gateway Protocols (such as OSPF, EIGRP, and IS-IS) and Exterior Gateway Protocols (such as BGP), MPLS-related protocols (such as LDP), and multicast-related protocols.",None.,"P0
Upon Feature Enablement",N/A,Undefined,"Authentication: MD5
Key ID: Configured
Password: Configured
",NO,Modify,"Networking, Connectivity,
Tier-0 Gateways",N/A,N/A
nsx-9.password-complexity,IAC-10.1,"VCFN-9X-000038
VCFN-9X-000039
VCFN-9X-000040
VCFN-9X-000041
VCFN-9X-000042
VCFN-9X-000043","8.3.1
8.3.6",NSX,9.0.0,Base,The VMware Cloud Foundation NSX Manager must enforce minimum password standards.,"Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. Password length is one factor of several that helps to determine strength and how long it takes to crack a password.

The shorter the password, the lower the number of possible combinations that must be tested before the password is compromised. Use of more characters in a password helps to increase exponentially the time and/or resources required to compromise the password.",None.,P0,N/A,Not Configured,"From an NSX Manager shell, run the following NSX CLI command:

> set password-complexity minimum-password-length 15
> set password-complexity upper-chars -1
> set password-complexity lower-chars -1
> set password-complexity digits -1
> set password-complexity special-chars -1
> set password-complexity max-repeats 8",NO,Modify,NSX Manager Shell,N/A,N/A
nsx-9.reverse-path-forwarding,NET-04,VCFN-9X-000051,1.4.3,NSX,9.0.0,Tier-0,NSX must disallow outbound packets that contain an illegitimate address.,"A compromised host in an enclave can be used by a malicious platform to launch cyber attacks on third parties. This is a common practice in ""botnets"", which are a collection of compromised computers using malware to attack other computers or networks. DDoS attacks frequently leverage IP source address spoofing to send packets to multiple hosts that in turn will then send return traffic to the hosts with the IP addresses that were forged. This can generate significant amounts of traffic. Therefore, protection measures to counteract IP source address spoofing must be taken. When uRPF is enabled in strict mode, the packet must be received on the interface that the device would use to forward the return packet; thereby mitigating IP source address spoofing.",None.,"P0
Upon Feature Enablement",N/A,Not Configured,Strict,NO,Modify,"Networking, Connectivity,
Tier-0 Gateways",N/A,N/A
nsx-9.service-resilience,"BCD-11.7
BCD-12.2
BCD-10",N/A,2.2.6,NSX,9.0.0,Base,"When configured with multiple nodes, DRS anti-affinity rules must be configured for this service.","When multiple service nodes/appliances are configured for a service to enable high availability and/or service redundancy it is beneficial to configure DRS anti-affinity rules to separate those nodes/appliances on different ESX hosts, protecting against a variety of failures.

It is recommended to use DRS anti-affinity ""should"" rules (versus ""must"") to allow DRS and Lifecycle Manager to move virtual machines as necessary during patching or HA events.",None.,"P0
Upon Feature Enablement",N/A,Not Configured,Configured,NO,Modify,N/A,N/A,N/A
nsx-9.snmp,CFG-03,VCFN-0X-000113,"2.2.4
2.2.5",NSX,9.0.0,Base,The component must disable SNMP version 1 and 2.,Services which are not in use and are not essential for operations should be deactivated.,None.,P0,N/A,Not Configured,"From the NSX Manager web interface, go to the System >> Configuration >> Fabric >> Profiles >> Node Profiles.

Click on ""All NSX Nodes"" and delete and v2c Polling or Trap configurations.",NO,Modify,NSX Manager Shell,N/A,N/A
nsx-9.ssh,CFG-03,VCFN-9X-000086,2.2.4,NSX,9.0.0,Base,The component must deactivate SSH.,Services which are not in use and are not essential for operations should be deactivated.,None.,P0,N/A,Not Configured,"From an NSX Manager shell, run the following NSX CLI commands:

> stop service ssh
> clear service ssh start-on-boot
> clear ssh root-login",NO,Modify,NSX Manager Shell,N/A,N/A
nsx-9.time,"MON-07.1
SEA-20",VCFN-9X-000111,"10.6.1
10.6.2",NSX,9.0.0,Base,The component must synchronize its clock with organizational reference sources.,"Cryptography, audit logging, cluster operations, and incident response/forensics require synchronized time across environments. The recommended practice for NTP is to have at least four sources. It is not advisable to have only two sources; one source is preferable to having two (Segal's Law: a person with one watch always knows what time it is, a person with two is never sure).

Configure all components to use the global standard time zone, UTC.

NTP uses UDP to communicate, which, if allowed generically, can open a path for attackers to exfiltrate data during a breach. Ensure that perimeter firewall rules allowing communication to NTP servers are specific. ",None.,P0,"To configure a profile to apply NTP servers to all NSX Manager nodes, do the following:

From the NSX Manager web interface, go to System >> Configuration >> Fabric >> Profiles >> Node Profiles.

Click ""All NSX Nodes"" and then click ""Edit"".

Under NTP servers, remove any unknown or nonauthoritative NTP servers, enter authoritative NTP servers, and then click ""Save"".

or

From an NSX Manager shell, run the following commands:

> del ntp-server <server-ip or server-name>
> set ntp-server <server-ip or server-name>",Undefined,Site-Specific,NO,Modify,N/A,N/A,N/A
nsx-9.tls-ciphers,"CRY-03
CRY-01","VCFN-9X-000037
VCFN-9X-000075","2.2.7
4.2.1
8.3.2",NSX,9.0.0,Base,"The component must maintain confidentiality and integrity of transmissions by ensuring the use of approved, modern, replay-resistent ciphers.",Data-in-transit encryption is essential for network communications.,"Changes to cipher suites impact connectivity with other components and external systems, and may require a restart of the component to implement.",P2,"Capture the output from the check GET command and update the TLS 1.1 protocol to false.

Run the following API call using curl or another REST API client:

PUT https://<nsx-mgr>/api/v1/cluster/api-service

Example request body:

{
    ""session_timeout"": 900,
    ""connection_timeout"": 30,
    ""protocol_versions"": [
        {
            ""name"": ""TLSv1.1"",
            ""enabled"": false
        },
        {
            ""name"": ""TLSv1.2"",
            ""enabled"": true
        },
        {
            ""name"": ""TLSv1.3"",
            ""enabled"": true
        }
    ],
    ""cipher_suites"": [
        {
            ""name"": ""TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA"",
            ""enabled"": false
        },
        {
            ""name"": ""TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256"",
            ""enabled"": false
        },
        {
            ""name"": ""TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256"",
            ""enabled"": true
        },
        {
            ""name"": ""TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA"",
            ""enabled"": false
        },
        {
            ""name"": ""TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384"",
            ""enabled"": false
        },
        {
            ""name"": ""TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384"",
            ""enabled"": true
        },
        {
            ""name"": ""TLS_RSA_WITH_AES_128_CBC_SHA"",
            ""enabled"": false
        },
        {
            ""name"": ""TLS_RSA_WITH_AES_128_CBC_SHA256"",
            ""enabled"": false
        },
        {
            ""name"": ""TLS_RSA_WITH_AES_128_GCM_SHA256"",
            ""enabled"": true
        },
        {
            ""name"": ""TLS_RSA_WITH_AES_256_CBC_SHA"",
            ""enabled"": false
        },
        {
            ""name"": ""TLS_RSA_WITH_AES_256_CBC_SHA256"",
            ""enabled"": false
        },
        {
            ""name"": ""TLS_RSA_WITH_AES_256_GCM_SHA384"",
            ""enabled"": true
        },
        {
            ""name"": ""TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384"",
            ""enabled"": true
        },
        {
            ""name"": ""TLS_AES_128_GCM_SHA256"",
            ""enabled"": true
        },
        {
            ""name"": ""TLS_AES_256_GCM_SHA384"",
            ""enabled"": true
        },
        {
            ""name"": ""TLS_CHACHA20_POLY1305_SHA256"",
            ""enabled"": false
        }
    ],
    ""redirect_host"": """",
    ""client_api_rate_limit"": 100,
    ""global_api_concurrency_limit"": 199,
    ""client_api_concurrency_limit"": 40,
    ""basic_authentication_enabled"": true,
    ""cookie_based_authentication_enabled"": true,
    ""resource_type"": ""ApiServiceConfig"",
    ""id"": ""reverse_proxy_config"",
    ""display_name"": ""reverse_proxy_config"",
    ""_system_owned"": false,
    ""_protection"": ""NOT_PROTECTED"",
    ""_create_time"": 1733862743672,
    ""_create_user"": ""system"",
    ""_last_modified_time"": 1733948476863,
    ""_last_modified_user"": ""admin"",
    ""_revision"": 1
}

Note: Changes are applied to all nodes in the cluster. The API service on each node will restart after it is updated using this API. There may be a delay of up to a minute or so between the time this API call completes and when the new configuration goes into effect.",Enabled,Enabled,YES,Audit,NSX Manager Shell,N/A,N/A
operations-9.account-lockout,"IAC-22
IAC-10",VCFA-9X-000348,8.3.4,Operations,9.0.0,Base,VCF Operations must enforce the limit of five consecutive invalid logon attempts by a user during a 15 minute time period.,"By limiting the number of failed login attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute forcing, is reduced. Limits are imposed by locking the account. ",None.,P0,N/A,Not Configured,Configured,NO,Modify,Administration >> Global Settings >> User Access >> Password Policy >> Account Lockout,N/A,N/A
operations-9.certificates-validation,IAC-10.2,VCFA-9X-000262,4.2.1,Operations,9.0.0,Base,VCF Operations must activate certificate validation.,"A certificate's certification path is the path from the end entity certificate to a trusted root certification authority (CA). Certification path validation is necessary for a relying party to make an informed decision regarding acceptance of an end entity certificate. 

Certification path validation includes checks such as certificate issuer trust, time validity, and revocation status for each certificate in the certification path. Revocation status information for CA and subject certificates in a certification path is commonly provided via certificate revocation lists (CRLs) or online certificate status protocol (OCSP) responses.",None.,P0,N/A,Not Configured,Configured,NO,Modify,"VCF Operations, go to Administration >> Global Settings >> System Settings",N/A,N/A
operations-9.concurrent-sessions,IAC-23,VCFA-9X-000001,2.2.6,Operations,9.0.0,Base,VCF Operations must limit the number of concurrent sessions.,Application management includes the ability to control the number of users and user sessions that use an application. Limiting the number of allowed users and sessions per user is helpful in limiting risks related to denial-of-service (DoS) attacks.,None.,P0,N/A,Not Configured,Configured,NO,Modify,Administration >> Global Settings >> User Access,N/A,N/A
operations-9.credential-ownership-enforcement,IAC-02.1,VCFA-9X-000350,8.2.2,Operations,9.0.0,Base,VCF Operations must enable credential ownership enforcement.,VCF Operations allows the creation of credentials for use with adapters when setting up integrations with other products. The credentials for these integrations are sensitive and should not be accessible except to those who created them.,None.,P0,N/A,Not Configured,Configured,NO,Modify,"VCF Operations, go to Administration >> Global Settings >> System Settings",N/A,N/A
operations-9.fips,"CRY-01
CRY-09.1
TDA-02.2",VCFA-9X-000352,"2.2.7
8.3.2",Operations,9.0.0,Base,VCF Operations must enable FIPS-validated cryptography.,"FIPS mode enforces validated cryptographic modules across all components, eliminating non-compliant algorithms and helping to ensure cryptographic integrity and deterministic random number generation to meet compliance requirements.",Certain cipher suites will become unavailable and may impact interoperability.,P0,N/A,Not Configured,Configured,NO,Modify,"VCF Operations, go to Administration >> Control Panel >> Cluster Management",N/A,N/A
operations-9.firewall-hardening,"NET-03
NET-04.1",VCFA-9X-000353,"1.4.1
1.4.2",Operations,9.0.0,Base,VCF Operations must enable firewall hardening.,"In a VCF Operations cluster there are some network ports which are using only for inter-node communication, however these ports accepts incoming connections from any source. In order to secure these ports the firewall hardening option should be enabled which restricts access to these ports to only members of the Operations cluster.",None.,P0,N/A,Not Configured,Configured,NO,Modify,N/A,N/A,N/A
operations-9.log-forwarding-fips,"CRY-01
CRY-09.1
TDA-02.2",VCFA-9X-000178,"2.2.7
8.3.2",Operations,9.0.0,Base,Component must forward system and audit logs securely to a remote log collection point.,"FIPS mode enforces validated cryptographic modules across all components, eliminating non-compliant algorithms and helping to ensure cryptographic integrity and deterministic random number generation to meet compliance requirements.",Certain cipher suites will become unavailable and may impact interoperability.,P0,N/A,Not Configured,Configured,NO,Modify,Configuration >> General,N/A,N/A
operations-9.login-message,SEA-18,VCFA-9X-000347,2.2.6,Operations,9.0.0,Base,The component must display a message prior to user login.,"While not a direct security control, a login message or banner is  used to inform authorized users of their responsibilities and conditions for system use, as well as to enable disciplinary action and/or prosecution of unauthorized behavior.",None.,P1,N/A,Not Configured,Configured,NO,Modify,"VCF Operations, go to Administration >> Global Settings >> User Access >> Login Message",N/A,N/A
operations-9.password-complexity,IAC-10.1,VCFA-9X-000346,"8.3.1
8.3.6",Operations,9.0.0,Base,VCF Operations must enforce password complexity requirements.,"Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. 

Password complexity is one factor of several that determine how long it takes to crack a password. The more complex the password is, the greater the number of possible combinations that need to be tested before the password is compromised.",None.,P0,N/A,Not Configured,Configured,NO,Modify,"VCF Operations, go to Administration >> Global Settings >> User Access >> Password Policy",N/A,N/A
operations-9.service-resilience,"BCD-11.7
BCD-12.2
BCD-10",N/A,2.2.6,Operations,9.0.0,Base,"When configured with multiple nodes, DRS anti-affinity rules must be configured for this service.","When multiple service nodes/appliances are configured for a service to enable high availability and/or service redundancy it is beneficial to configure DRS anti-affinity rules to separate those nodes/appliances on different ESX hosts, protecting against a variety of failures.

It is recommended to use DRS anti-affinity ""should"" rules (versus ""must"") to allow DRS and Lifecycle Manager to move virtual machines as necessary during patching or HA events.",None.,"P0
Upon Feature Enablement",N/A,Not Configured,Configured,NO,Modify,N/A,N/A,N/A
operations-9.session-timeout,IAC-25,VCFA-9X-000349,8.2.8,Operations,9.0.0,Base,VMware Cloud Foundation components must enforce a session timeout after a specified period of inactivity.,"This practice helps mitigate potential security risks by ensuring that unattended sessions, which could be exploited by unauthorized users or malicious software, are not left open indefinitely.",None.,P0,N/A,Not Configured,Configured,NO,Modify,N/A,N/A,N/A
operations-9.unsigned-pak,"CHG-04.2
TDA-14.1
TDA-01.2",VCFA-9X-000292,6.5.1,Operations,9.0.0,Base,VCF Operations must disable unsigned management pack installation.,"Software and firmware components prevented from installation unless signed with recognized and approved certificates include software and firmware version updates, patches, service packs, device drivers, and basic input/output system updates.

This option permits the installation of PAK files without signature verification. Enabling it may pose security risks, as unsigned files could contain untrusted content.",None.,P0,N/A,Not Configured,Configured,NO,Modify,Administrator Settings >> Security Settings,N/A,N/A
sddc-9.api-admin,"IAC-21
IAC-01
IAC-01.2
IAC-02
IAC-02.3
IAC-03 ",VCFA-9X-000356,8.2.1,SDDC Manager,9.0.0,Base,VMware Cloud Foundation SDDC Manager must configure the API admin account.,A local account is used to access VMware Cloud Foundation APIs when the management vCenter Server is down. If you upgraded from a previous release or didn't configure the account when deploying using the API this accounts password is unset. If left unset this would make managing and accessing the environment in some scenarios difficult to recover from and should be set.,None.,P0,N/A,Not Configured,Configured,NO,Modify,N/A,N/A,N/A
vcenter-9.account-alert,"IAC-10
IAC-10.1
IAC-10.4
IAC-10.8
IAC-18
IAC-22
END-06.3
IAC-15.4
IAO-01",VCFA-9X-000117,8.2.1,vCenter,9.0.0,Base,The VMware Cloud Foundation vCenter Server must notify system administrators when Single Sign-On (SSO) account actions occur.,"Once an attacker establishes initial access to a system, they often attempt to create a persistent method of reestablishing access. One way to accomplish this is for the attacker to create a new account. They may also try to hijack an existing account by changing a password or enabling a previously disabled account. Therefore, all actions performed on accounts in the SSO domain much be alerted on in vCenter at a minimum and ideally on a Security Information and Event Management (SIEM) system as well.

To ensure the appropriate personnel are alerted about SSO account actions, create a new vCenter alarm for the ""com.vmware.sso.PrincipalManagement"" event ID and configure the alert mechanisms appropriately.",None.,P0,N/A,Not Configured,Configured,NO,Modify,vCenter Server >> Configure >> Alarm Definitions,N/A,N/A
vcenter-9.account-lockout-duration,"IAC-22
IAC-10",VCFA-9X-000139,8.3.4,vCenter,9.0.0,Base,The vCenter Server must unlock accounts after a specified timeout period.,Repeated failed logins may suggest security threats. Due to the importance of vCenter Server accounts should not automatically unlock when they have been locked due to multiple login failures. Ensure that you have your administrator@vsphere.local information and that it is valid.,There is the opportunity for denial-of-service when accounts do not automatically unlock.,P0,Unlock time,300,0,NO,Modify,vCenter Server SSO Configuration,Get-SsoLockoutPolicy | Select AutoUnlockIntervalSec,Get-SsoLockoutPolicy | Set-SsoLockoutPolicy -AutoUnlockIntervalSec 0
vcenter-9.account-lockout-max-attempts,"IAC-22
IAC-10",VCFA-9X-000017,8.3.4,vCenter,9.0.0,Base,The vCenter Server must lock an account after a specified number of failed login attempts.,"Repeated failed logins for an account may signal security issues. To limit brute force attempts, lock the account after a certain threshold, balancing between avoiding automatic connection retries and potential denial-of-service attacks.",None.,P2,Maximum number of failed login attempts,5,5,YES,Audit,vCenter Server SSO Configuration,Get-SsoLockoutPolicy | Select MaxFailedAttempts,Get-SsoLockoutPolicy | Set-SsoLockoutPolicy -MaxFailedAttempts 5
vcenter-9.account-lockout-reset,"IAC-22
IAC-10",VCFA-9X-000017,8.3.4,vCenter,9.0.0,Base,The vCenter Server must set the interval for counting failed login attempts to at least 15 minutes.,"By limiting the number of failed login attempts, the risk of unauthorized access via user password guessing, otherwise known as brute-forcing, is reduced.",None.,P0,Time interval between failures,180,900,NO,Modify,vCenter Server SSO Configuration,Get-SsoLockoutPolicy | Select FailedAttemptIntervalSec,Get-SsoLockoutPolicy | Set-SsoLockoutPolicy -FailedAttemptIntervalSec 900
vcenter-9.administration-client-plugins,"CFG-03
CFG-03.1
NET-03
TPM-03
SEA-03",VCFA-9X-000051,2.2.4,vCenter,9.0.0,Base,Reduce or eliminate third-party vCenter Server plugins.,"Installation of plugins and other third-party cross-connections between systems erodes boundaries between different infrastructure systems, offering opportunities for attackers who have compromised one system to move laterally to another.  Tight coupling of other systems to vSphere often create impediments to timely patching and upgrades. Consider any third-party plugins or addons to vSphere components carefully and ensure that there is significant value added by them, versus using individual management consoles, to offset the risks they create.",None.,P0,N/A,Not Configured,Configured,NO,Modify,N/A,N/A,N/A
vcenter-9.administration-sso-groups,"NET-04
NET-04.3
CHG-04.3
IAC-01
IAC-01.2
IAC-02
IAC-02.3
IAC-03 
IAC-21
CFG-03
IAC-21
NET-03
NET-04.1
NET-03.7",VCFA-9X-000338,7.2.2,vCenter,9.0.0,Base,The vCenter Server must separate authentication and authorization for administrators.,"Combining authentication and authorization, as done in services like Active Directory, risks infrastructure breaches if compromised. Hence, vCenter Server should segregate these for administrators. Consider local SSO groups for authorization to better manage risk where feasible.",Provisioning vCenter Server access will require interaction with vCenter Server SSO. Automation is possible with PowerCLI.,P0,N/A,Not Configured,Not Configured,NO,Modify,vCenter Server SSO Configuration,N/A (No public API available),N/A (No public API available)
vcenter-9.bashshelladministrators,"IAC-01
IAC-01.2
IAC-02
IAC-02.3
IAC-03 
IAC-16
IAC-21
IAC-05.2
IAC-21.2
CFG-03",VCFA-9X-000333,7.2.2,vCenter,9.0.0,Base,"The VMware Cloud Foundation vCenter Server must limit membership to the ""SystemConfiguration.BashShellAdministrators"" Single Sign-On (SSO) group.","vCenter SSO integrates with PAM in the underlying Photon operating system so members of the ""SystemConfiguration.BashShellAdministrators"" SSO group can log on to the operating system without needing a separate account. However, even though unique SSO users log on, they are transparently using a group account named ""sso-user"" as far as Photon auditing is concerned. While the audit trail can still be traced back to the individual SSO user, it is a more involved process.

To force accountability and nonrepudiation, the SSO group ""SystemConfiguration.BashShellAdministrators"" must be severely restricted.",None.,P0,N/A,Not Configured,Configured,NO,Modify,Administration >> Single Sign On >> Users and Groups >> Groups,N/A,N/A
vcenter-9.content-library-authentication,"IAC-20.1
AST-02.3",VCFA-9X-000336,7.2.2,vCenter,9.0.0,Content Library,The vCenter server must require authentication for published content libraries.,"In the vSphere Client, you can create a local or a subscribed content library. By using content libraries, you can store and manage content in one vCenter Server instance. Alternatively, you can distribute content across vCenter Server instances to increase consistency and facilitate the deployment workloads at scale. When publishing a content library it can be protected by requiring authentication for subscribers.",None.,"P0 
Upon Feature Enablement",Enable user authentication for access to this content library,Not Configured,Configured,NO,Modify if Feature in Use,Content Library Settings,0,N/A
vcenter-9.content-library-ovf,"CHG-04.2
TDA-14.1",VCFA-9X-000337,2.2.6,vCenter,9.0.0,Content Library,The vCenter server must enable the OVF security policy for content libraries.,"In the vSphere Client, you can create a local or a subscribed content library. By using content libraries, you can store and manage content in one vCenter Server instance. Alternatively, you can distribute content across vCenter Server instances to increase consistency and facilitate the deployment workloads at scale. You can protect the OVF items by applying default OVF security policy to a content library. The OVF security policy enforces strict validation on OVF items when you deploy or update the item, import items, or synchronize OVF and OVA templates. To make sure that the OVF and OVA templates are signed by a trusted certificate, you can add the OVF signing certificate from a trusted CA. ",None.,"P0 
Upon Feature Enablement",Apply Security Policy,Not Configured,Configured,NO,Modify if Feature in Use,Content Library Settings,0,N/A
vcenter-9.disable-accounts,"CFG-03
",VCFA-9X-000270,2.2.4,vCenter,9.0.0,Base,VMware vCenter must have unnecessary or unused user accounts disabled or removed.,"Disabling expired, inactive, unused, or otherwise anomalous accounts supports the concepts of least privilege and least functionality which reduce the attack surface of the system.

VMware vCenter has ""K/M"" and ""krbtgt"" accounts that, if IWA is not in use, can be disabled.

This control does NOT apply to internal product appliance accounts (Linux user accounts often found in /etc/passwd). Those accounts are part of the product distribution and used for process isolation within the product. Those accounts are already disabled by having their shell set to /bin/nologin, /bin/false, or having ""!!"" in the passwd field. Removal or alteration of appliance internal accounts is unsupported and will cause operational issues, often later with upgrades and patching.",None.,P0,N/A,"K/M
krbtgt/*
Administrator",Administrator,NO,Modify,Administration >> Single Sign On >> Users and Groups >> Users.,N/A,N/A
vcenter-9.drs,CAP-01,N/A,2.2.6,vCenter,9.0.0,Base,VMware vCenter must enable the Distributed Resource Scheduler for resilience and to enable automated patching.,"DRS enables VCF to automatically rebalance workloads on ESX hosts, both during normal operations and when there are extenuating circumstances such as patching, HA restarts, and maintenance operations.",None.,P0,N/A,Not Configured,Configured,NO,Modify,N/A,N/A,N/A
vcenter-9.etc-issue,SEA-18,N/A,2.2.6,vCenter,9.0.0,Base,Configure the vCenter Server login banner text for access via SSH.,"vCenter Server allows a login message, which deters intruders and communicates obligations to authorized users. This configuration establishes the text displayed when a client connects via SSH. The default text leaks information to attackers about system configuration and should be changed.",None.,P1,etc.issue,"""VMware vCenter Server 8.0.2.00000Type: vCenter Server with an embedded Platform Services Controller""","Consult your organization's legal advisors for text that is applicable to your environment.

An example is: ""Authorized users only. Actual or attempted unauthorized use of this system is prohibited and may result in criminal, civil, security, or administrative proceedings and/or penalties. Use of this information system indicates consent to monitoring and recording, without notice or permission. Users have no expectation of privacy in any use of this system. Any information stored on, or transiting this system, or obtained by monitoring and/or recording, may be disclosed to law enforcement and/or used in accordance with Federal law, State statute, and organization policy. If you are not an authorized user of this system, exit the system at this time.""",NO,Modify,vCenter Server Advanced Settings,Get-AdvancedSetting -Entity $VC -Name etc.issue,"Get-AdvancedSetting -Entity $VC -Name etc.issue | Set-AdvancedSetting -Value ""****************************************************************************`n* Authorized users only. Actual or attempted unauthorized use of this      *`n* system is prohibited and may result in criminal, civil, security, or     *`n* administrative proceedings and/or penalties. Use of this information     *`n* system indicates consent to monitoring and recording, without notice     *`n* or permission. Users have no expectation of privacy. Any information     *`n* stored on or transiting this system, or obtained by monitoring and/or    *`n* recording, may be disclosed to law enforcement and/or used in accordance *`n* with Federal law, State statute, and organization policy. If you are not *`n* an authorized user of this system, exit the system at this time.         *`n****************************************************************************`n"""
vcenter-9.events-database-retention,"MON-01.8
MON-03
MON-03.1
MON-04
MON-02.7",VCFA-9X-000334,10.5.1,vCenter,9.0.0,Base,The vCenter server must have task and event retention set to an apppropriate interval.,"vCenter Server retains task and event data, which ages out to save storage space. The age is configurable. This only impacts local storage of event data on the vCenter Server Appliance.",None.,P2,Task Retention,30,30,YES,Audit,vCenter Server Database Settings,N/A (No public API available),N/A (No public API available)
vcenter-9.events-remote-logging,"MON-01.8
MON-03
MON-03.1
MON-04
MON-02.7",VCFA-9X-000329,"10.2.1
10.3.3",vCenter,9.0.0,Base,Enable remote logging of vCenter Server events.,Remote logging to a central host enhances vCenter Server's security by storing logs securely. It simplifies monitoring across hosts and supports aggregate analysis for detecting coordinated attacks. Centralized logging prevents tampering and serves as a reliable long-term audit record.,None.,P2,vpxd.event.syslog.enabled,true,true,YES,Audit,vCenter Server Advanced Settings,Get-AdvancedSetting -Entity $VC -Name vpxd.event.syslog.enabled,Get-AdvancedSetting -Entity $VC -Name vpxd.event.syslog.enabled | Set-AdvancedSetting -Value true
vcenter-9.fips-enable,"CRY-01
CRY-09.1
TDA-02.2",VCFA-9X-000253,"2.2.7
8.3.2",vCenter,9.0.0,Base,The vCenter Server must enable FIPS-validated cryptography.,"FIPS mode enforces validated cryptographic modules across all components, eliminating non-compliant algorithms and helping to ensure cryptographic integrity and deterministic random number generation to meet compliance requirements. Enabling this will cause vCenter Server to reboot.",Certain cipher suites will become unavailable and may impact interoperability.,P0,N/A,false,true,NO,Modify,API/PowerCLI,Invoke-GetSystemGlobalFips,"$spec = Initialize-SystemSecurityGlobalFipsUpdateSpec -Enabled $true
Invoke-SetSystemGlobalFips -SystemSecurityGlobalFipsUpdateSpec $spec"
vcenter-9.log-forwarding,MON-02,VCFA-9X-000141,"10.2.1
10.3.3",vCenter,9.0.0,VAMI,Component must forward system and audit logs to a remote log collection point.,"By gathering host log files onto a central host, you can more easily monitor all hosts using a single tool. Additionally, you can perform aggregate analysis and searching to identify coordinated attacks on multiple hosts. Logging to a secure and centralized log server helps prevent log tampering and ensures a unified, long-term audit record.",None.,P0,"VAMI, Syslog",Not Configured,Site-Specific Log Server,NO,Modify,vCenter Server Virtual Appliance Management Interface,"(Get-CisService -Name ""com.vmware.appliance.logging.forwarding"").get()",N/A
vcenter-9.login-message,SEA-18,VCFA-9X-000018,2.2.6,vCenter,9.0.0,Base,Configure the vCenter Server login banner and details for the vSphere Client.,"While not a direct security control, a login message or banner is  used to inform authorized users of their responsibilities and conditions for system use, as well as to enable disciplinary action and/or prosecution of unauthorized behavior.",None.,P1,"""Details of Login Message""",Not Configured,"Consult your organization's legal advisors for text that is applicable to your environment.

An example is: ""Authorized users only. Actual or attempted unauthorized use of this system is prohibited and may result in criminal, civil, security, or administrative proceedings and/or penalties. Use of this information system indicates consent to monitoring and recording, without notice or permission. Users have no expectation of privacy in any use of this system. Any information stored on, or transiting this system, or obtained by monitoring and/or recording, may be disclosed to law enforcement and/or used in accordance with Federal law, State statute, and organization policy. If you are not an authorized user of this system, exit the system at this time.""",NO,Modify,vCenter Server SSO Configuration,N/A,N/A
vcenter-9.login-message-enable,SEA-18,VCFA-9X-000019,2.2.6,vCenter,9.0.0,Base,Enable the vCenter Server login banner for the vSphere Client.,"vCenter Server can show a login message, useful for deterring intruders and communicating usage obligations to authorized users. This configuration enables the display of this message on the vSphere Client login page.",None.,P1,"""Show Login Message""",FALSE,TRUE,NO,Modify,vCenter Server SSO Configuration,"N/A (No public API available)

Can be configured using ""/opt/vmware/bin/sso-config.sh -set_logon_banner -title <logon_banner_title> <logonBannerFile>"" from an appliance shell. Please deactivate the shell again when you are done.","N/A (No public API available)

Can be configured using ""/opt/vmware/bin/sso-config.sh -set_logon_banner -title <logon_banner_title> <logonBannerFile>"" from an appliance shell. Please deactivate the shell again when you are done."
vcenter-9.login-message-text,SEA-18,VCFA-9X-000020,2.2.6,vCenter,9.0.0,Base,Configure the vCenter Server login banner text for the vSphere Client.,"vCenter Server allows a login message, which deters intruders and communicates obligations to authorized users. This configuration establishes the text displayed on the vSphere Client login page.",None.,P1,"""Login Message""",Not Configured,"Consult your organization's legal advisors for specific text.

An example is: ""Use of this system indicates awareness of, and consent to, the organizational policies governing this system.""",NO,Modify,vCenter Server SSO Configuration,"N/A (No public API available)

Can be configured using ""/opt/vmware/bin/sso-config.sh -set_logon_banner -title <logon_banner_title> <logonBannerFile>"" from an appliance shell. Please deactivate the shell again when you are done.","N/A (No public API available)

Can be configured using ""/opt/vmware/bin/sso-config.sh -set_logon_banner -title <logon_banner_title> <logonBannerFile>"" from an appliance shell. Please deactivate the shell again when you are done."
vcenter-9.log-level,"MON-02
MON-02.1
MON-02.2
MON-02.7
MON-03
MON-03.1
MON-03.3
MON-04
MON-06
MON-8.1
MON-8.3
MON-10
AST-14
CHG-04.1
MON-02.6",N/A,"10.2.1
10.3.3",vCenter,9.0.0,Base,VMware vCenter must log sufficient information for events.,It is important to ensure that sufficient information is present in audit logs for diagnostics and forensics purposes.,Additional storage space consumed by logs.,P0,N/A,Not Configured,Configured,NO,Modify,N/A,N/A,N/A
vcenter-9.logs-level-global,"MON-01.8
MON-03
MON-03.1
MON-04
MON-02.7",VCFA-9X-000028,"10.2.1
10.3.3",vCenter,9.0.0,Base,The vCenter Server must produce audit records containing information to establish what type of events occurred.,It is important to ensure that sufficient information is present in audit logs for diagnostics and forensics purposes.,None.,P2,config.log.level,info,info,YES,Audit,vCenter Server Advanced Settings,Get-AdvancedSetting -Entity $VC -Name config.log.level,Get-AdvancedSetting -Entity $VC -Name config.log.level | Set-AdvancedSetting -Value info
vcenter-9.native-key-provider-backup,"CRY-09
CRY-09.3
CRY-03",VCFA-9X-000335,4.2.1,vCenter,9.0.0,Native Key Provider,Native Key Provider instances must be backed up with a strong password.,"The vCenter Native Key Provider feature was introduced in 7.0 U2 and acts as a key provider for encryption-based capabilities such as encrypted virtual machines without requiring an external KMS solution. When enabling this feature, a backup must be taken, which is a PKCS#12 formatted file. If no password is provided during the backup process, this presents the opportunity for this to be used maliciously and compromise the environment.",None.,P0,N/A,Not Configured,Configured,NO,Modify,N/A,N/A,N/A
vcenter-9.network-mac-learning,"NET-04
NET-03",VCFA-9X-000345,1.4.5,vCenter,9.0.0,Distributed Switch,All distributed switch port groups must deactivate MAC Learning unless used intentionally.,"MAC Learning enables a distributed switch to provide network connectivity to systems where more than one MAC address is used on a vNIC. This can be useful in special cases like nested virtualization (running ESX inside ESX, for example). MAC learning also supports unknown unicast flooding. Normally, when a packet that is received by a port has an unknown destination MAC address, the packet is dropped. With unknown unicast flooding enabled, the port floods unknown unicast traffic to every port on the switch that has MAC learning and unknown unicast flooding enabled. This property is enabled by default, but only if MAC learning is enabled. It is recommended to disable MAC Learning unless it is in use intentionally for a known workload that requires it.",Some workloads do legitimately use these network tactics and will be negatively affected by the defaults/desired state.,"P2
Upon Feature Enablement",N/A,Disabled,Disabled,YES,Audit,Distributed Switch Port Group Settings,(Get-VDPortgroup -Name $VDPG).ExtensionData.Config.DefaultPortConfig.MacManagementPolicy.MacLearningPolicy | Select-Object -ExpandProperty Enabled,"$VDPGview = Get-VDPortgroup -Name $VDPG | Get-View 
$ConfigSpec = New-Object VMware.Vim.DVPortgroupConfigSpec
$ConfigSpec.DefaultPortConfig = New-Object VMware.Vim.VMwareDVSPortSetting
$ConfigSpec.DefaultPortConfig.MacManagementPolicy = New-Object VMware.Vim.DVSMacManagementPolicy
$ConfigSpec.DefaultPortConfig.MacManagementPolicy.MacLearningPolicy = New-Object VMware.Vim.DVSMacLearningPolicy
$ConfigSpec.DefaultPortConfig.MacManagementPolicy.MacLearningPolicy.Enabled = $false
$ConfigSpec.ConfigVersion = $VDPGview.Config.ConfigVersion
$VDPGview.ReconfigureDVPortgroup_Task($ConfigSpec)"
vcenter-9.network-nioc,CAP-02,VCFA-9X-000105,2.2.6,vCenter,9.0.0,Base,Ensure resilience to network denial-of-service by enabling Network I/O Control (NIOC),"VMware vSphere Network I/O Control (NIOC) is a traffic management technology that offers quality of service at the hypervisor level, enhancing network performance by prioritizing resources in multi-tenant cloud and shared workload environments. Incorporated into the vSphere distributed switch (vDS), NIOC partitions network adapter bandwidth into ""network resource pools"" that correspond to different traffic types, such as vMotion and management traffic, allowing users to allocate shares, limits, and reservations to these pools.

NIOC preserves network availability for essential services and prevents congestion by limiting less critical traffic. This is achieved by enabling the creation of network control policies per business requirements, ensuring traffic type isolation, and allowing dynamic resource reallocation based on priority and usage.",None.,P0,N/A,Not Configured,Configured,NO,Modify,Distributed Switch Settings,N/A,N/A
vcenter-9.network-reject-forged-transmit-dvportgroup,"NET-04
NET-03",VCFA-9X-000323,1.4.3,vCenter,9.0.0,Distributed Switch,All distributed switches and their port groups must be configured to reject forged transmits.,"A virtual machine can impersonate network adapters by changing MAC addresses, posing security threats. By setting the Forged Transmits option to Reject on all distributed switches and port groups, ESX verifies MAC addresses and prevents such impersonation.",Some workloads do legitimately use these network tactics and will be negatively affected by the defaults/desired state.,"P2
Upon Feature Enablement",N/A,Reject,Reject,YES,Audit,Distributed Switch Port Group Settings,"Get-VDSwitch -Name $VDS | Get-VDSecurityPolicy
Get-VDPortgroup -Name $VDPG | Get-VDSecurityPolicy","Get-VDSwitch -Name $VDS | Get-VDSecurityPolicy | Set-VDSecurityPolicy -ForgedTransmits $false
Get-VDPortgroup -Name $VDPG | Get-VDSecurityPolicy | Set-VDSecurityPolicy -ForgedTransmits $false"
vcenter-9.network-reject-mac-changes-dvportgroup,"NET-04
NET-04.3
CHG-04.3
IAC-01
IAC-01.2
IAC-02
IAC-02.3
IAC-03 
IAC-21
CFG-03
IAC-21
NET-03
NET-04.1
NET-03.7",VCFA-9X-000324,1.4.3,vCenter,9.0.0,Distributed Switch,All distributed switches and their port groups must be configured to reject guest MAC address changes.,"Allowing virtual machines to change MAC addresses poses security risks, enabling potential network adapter impersonation. Rejecting MAC changes on all distributed switches and port groups prevents this, but may impact certain applications like Microsoft Clustering or MAC address-dependent licensing. Exceptions should be made as necessary.",Some workloads do legitimately use these network tactics and will be negatively affected by the defaults/desired state.,"P2
Upon Feature Enablement",N/A,Reject,Reject,YES,Audit,Distributed Switch Port Group Settings,"Get-VDSwitch -Name $VDS | Get-VDSecurityPolicy
Get-VDPortgroup -Name $VDPG | Get-VDSecurityPolicy","Get-VDSwitch -Name $VDS | Get-VDSecurityPolicy | Set-VDSecurityPolicy -MacChanges $false
Get-VDPortgroup -Name $VDPG | Get-VDSecurityPolicy | Set-VDSecurityPolicy -MacChanges $false"
vcenter-9.network-reject-promiscuous-mode-dvportgroup,"NET-04
NET-04.3
CHG-04.3
IAC-01
IAC-01.2
IAC-02
IAC-02.3
IAC-03 
IAC-21
CFG-03
IAC-21
NET-03
NET-04.1
NET-03.7",VCFA-9X-000325,1.4.5,vCenter,9.0.0,Distributed Switch,All distributed switches and their port groups must be configured to reject guest promiscuous mode requests.,"Enabling promiscuous mode on a port group allows all connected virtual machines to read all network packets, posing a potential security risk. Although sometimes necessary for debugging or monitoring, the default setting - reject - is recommended. Exceptions can be made for specific port groups as required.",Some workloads do legitimately use these network tactics and will be negatively affected by the defaults/desired state.,"P2
Upon Feature Enablement",N/A,Reject,Reject,YES,Audit,Distributed Switch Port Group Settings,"Get-VDSwitch -Name $VDS | Get-VDSecurityPolicy
Get-VDPortgroup -Name $VDPG | Get-VDSecurityPolicy","Get-VDSwitch -Name $VDS | Get-VDSecurityPolicy | Set-VDSecurityPolicy -AllowPromiscuous $false
Get-VDPortgroup -Name $VDPG | Get-VDSecurityPolicy | Set-VDSecurityPolicy -AllowPromiscuous $false"
vcenter-9.network-reset-port,"NET-04
NET-04.3
CHG-04.3
IAC-01
IAC-01.2
IAC-02
IAC-02.3
IAC-03 
IAC-21
CFG-03
IAC-21
NET-03
NET-04.1
NET-03.7",VCFA-9X-000342,2.2.4,vCenter,9.0.0,Distributed Switch,The vCenter Server must reset port configuration when virtual machines are disconnected.,"When a virtual machine is disconnected from the virtual switch port it is desirable to reset the port configuration, so that another virtual machine that attaches has a port in a known state.",None.,"P2
Upon Feature Enablement",N/A,Enabled,Enabled,YES,Audit,Distributed Switch Settings,(Get-VDPortgroup -Name $VDPG).ExtensionData.Config.Policy | Select-Object -ExpandProperty PortConfigResetAtDisconnect,"$VDPGview = Get-VDPortgroup -Name $VDPG | Get-View 
$ConfigSpec = New-Object VMware.Vim.DVPortgroupConfigSpec
$ConfigSpec.DefaultPortConfig = New-Object VMware.Vim.VMwareDVSPortSetting
$ConfigSpec.Policy = New-Object VMware.Vim.VMwareDVSPortgroupPolicy
$ConfigSpec.Policy.PortConfigResetAtDisconnect = $true
$ConfigSpec.ConfigVersion = $VDPGview.Config.ConfigVersion
$VDPGview.ReconfigureDVPortgroup_Task($ConfigSpec)"
vcenter-9.network-restrict-discovery-protocol,"NET-04
NET-04.3
CHG-04.3
IAC-01
IAC-01.2
IAC-02
IAC-02.3
IAC-03 
IAC-21
CFG-03
IAC-21
NET-03
NET-04.1
NET-03.7",VCFA-9X-000339,1.4.5,vCenter,9.0.0,Distributed Switch,The vCenter Server must deactivate CDP/LLDP on distributed switches unless used intentionally.,"vSphere Distributed Virtual Switch can engage in CDP or LLDP, potentially sharing sensitive unencrypted information, like IP addresses and system names, on the network. As it can aid adversaries in understanding or impersonating your environment, However, it is also extremely helpful for legitimate use cases. It is recommended to keep it deactivated unless necessary for troubleshooting or configuration validation.",None.,"P1
Upon Feature Enablement",N/A,listen,none,NO,Modify,Distributed Switch Settings,(Get-VDSwitch -Name $VDS).ExtensionData.config.LinkDiscoveryProtocolConfig | Select-Object -ExpandProperty Operation,"$VDview = Get-VDSwitch -Name $VDS | Get-View
$ConfigSpec = New-Object VMware.Vim.VMwareDVSConfigSpec
$ConfigSpec.LinkDiscoveryProtocolConfig = New-Object VMware.Vim.LinkDiscoveryProtocolConfig
$ConfigSpec.LinkDiscoveryProtocolConfig.Protocol = 'cdp'
$ConfigSpec.LinkDiscoveryProtocolConfig.Operation = 'none'
$ConfigSpec.ConfigVersion = $VDview.Config.ConfigVersion
$VDview.ReconfigureDvs_Task($ConfigSpec)"
vcenter-9.network-restrict-netflow-usage,"NET-04
NET-04.3
CHG-04.3
IAC-01
IAC-01.2
IAC-02
IAC-02.3
IAC-03 
IAC-21
CFG-03
IAC-21
NET-03
NET-04.1
NET-03.7",VCFA-9X-000326,1.4.5,vCenter,9.0.0,Distributed Switch,The vCenter Server must ensure that NetFlow traffic is being sent to authorized collectors.,"vSphere Distributed Switch can export unencrypted NetFlow data, revealing details about virtual network and traffic patterns. It is essential to verify that NetFlow usage is authorized and correctly configured to prevent information leaks.",Legitimate network monitoring tools may require this functionality.,"P2
Upon Feature Enablement",N/A,Not Configured,Not Configured,YES,Audit,Distributed Switch Settings,"(Get-VDSwitch -Name $VDS).ExtensionData.config.IpfixConfig.CollectorIpAddress | Select-Object -ExpandProperty CollectorIpAddress

(Get-VDPortgroup -Name $VDPG).ExtensionData.Config.DefaultPortConfig.IpfixEnabled | Select-Object -ExpandProperty Value","$VDPGview = Get-VDPortgroup -Name $VDPG | Get-View 
$ConfigSpec = New-Object VMware.Vim.DVPortgroupConfigSpec
$ConfigSpec.DefaultPortConfig = New-Object VMware.Vim.VMwareDVSPortSetting
$ConfigSpec.DefaultPortConfig.IpfixEnabled = New-Object VMware.Vim.BoolPolicy
$ConfigSpec.DefaultPortConfig.IpfixEnabled.Inherited = $false
$ConfigSpec.DefaultPortConfig.IpfixEnabled.Value = $false
$ConfigSpec.ConfigVersion = $VDPGview.Config.ConfigVersion
$VDPGview.ReconfigureDVPortgroup_Task($ConfigSpec)"
vcenter-9.network-restrict-port-level-overrides,"NET-04
NET-04.3
CHG-04.3
IAC-01
IAC-01.2
IAC-02
IAC-02.3
IAC-03 
IAC-21
CFG-03
IAC-21
NET-03
NET-04.1
NET-03.7",VCFA-9X-000341,2.2.4,vCenter,9.0.0,Distributed Switch,"The vCenter Server must not override port group settings at the port level on distributed switches, except for block ports.","While port-level configuration overrides may be needed for unique VM setups, they must be closely monitored to prevent unauthorized use. Unmonitored overrides could allow broader access if a less secure Distributed Switch configuration is exploited.",None.,"P2
Upon Feature Enablement",N/A,"Block Ports Override: TRUE
All Other Overrides: FALSE","Block Ports Override: TRUE
All Other Overrides: FALSE",YES,Audit,Distributed Switch Port Group Settings,(Get-VDPortgroup -Name $VDPG).ExtensionData.Config.Policy,"$VDPGview = Get-VDPortgroup -Name $VDPG | Get-View 
$ConfigSpec = New-Object VMware.Vim.DVPortgroupConfigSpec
$ConfigSpec.DefaultPortConfig = New-Object VMware.Vim.VMwareDVSPortSetting
$ConfigSpec.Policy = New-Object VMware.Vim.VMwareDVSPortgroupPolicy
$ConfigSpec.Policy.UplinkTeamingOverrideAllowed = $false
$ConfigSpec.Policy.BlockOverrideAllowed = $true
$ConfigSpec.Policy.LivePortMovingAllowed = $false
$ConfigSpec.Policy.VlanOverrideAllowed = $false
$ConfigSpec.Policy.SecurityPolicyOverrideAllowed = $false
$ConfigSpec.Policy.VendorConfigOverrideAllowed = $false
$ConfigSpec.Policy.ShapingOverrideAllowed = $false
$ConfigSpec.Policy.IpfixOverrideAllowed = $false
$ConfigSpec.Policy.TrafficFilterOverrideAllowed = $false
$ConfigSpec.ConfigVersion = $VDPGview.Config.ConfigVersion
$VDPGview.ReconfigureDVPortgroup_Task($ConfigSpec)"
vcenter-9.network-restrict-port-mirroring,"NET-04
NET-04.3
CHG-04.3
IAC-01
IAC-01.2
IAC-02
IAC-02.3
IAC-03 
IAC-21
CFG-03
IAC-21
NET-03
NET-04.1
NET-03.7",VCFA-9X-000340,2.2.4,vCenter,9.0.0,Distributed Switch,The vCenter Server must remove unauthorized port mirroring sessions on distributed switches.,"vSphere Distributed Switch can mirror traffic between ports, enabling traffic observation. To maintain security, any unauthorized port mirroring sessions on distributed switches must be promptly removed.",None.,"P2
Upon Feature Enablement",N/A,Not Configured,Not Configured,YES,Audit,Distributed Switch Settings,(Get-VDSwitch -Name $VDS).ExtensionData.config.VspanSession,N/A
vcenter-9.network-vgt,"NET-04
NET-04.3
CHG-04.3
IAC-01
IAC-01.2
IAC-02
IAC-02.3
IAC-03 
IAC-21
CFG-03
IAC-21
NET-03
NET-04.1
NET-03.7",VCFA-9X-000327,1.4.2,vCenter,9.0.0,Distributed Switch,The vCenter Server must restrict the use of Virtual Guest Tagging (VGT) on Distributed Switches.,"Setting a port group to VLAN 4095 allows Virtual Guest Tagging (VGT), requiring the VM to process VLAN tags. This should only be enabled for VMs authorized and equipped to manage VLAN tags, as inappropriate use can cause service denial or unauthorized VLAN traffic interaction.",None.,"P2
Upon Feature Enablement",N/A,Not Configured,Not Configured,YES,Audit,Distributed Switch Port Group Settings,"Get-VDPortgroup -Name $VDPG | Where {$_.ExtensionData.Config.Uplink -ne ""True""} | Select Name,VlanConfiguration","Get-VDPortgroup $VDPG | Set-VDVlanConfiguration -VlanId ""<New VLAN#>"""
vcenter-9.password-complexity,IAC-10.1,VCFA-9X-000063,"8.3.1
8.3.6",vCenter,9.0.0,Base,The vCenter Server must enforce password complexity.,"Modern best practices for passwords (NIST 800-63B Section 5.1.1.2, among other guidance) suggests that composition rules (requiring mixtures of character classes, for example) should not be imposed on systems because they tend to not improve the security of passwords and discourage the use of more secure passphrases. Many regulatory compliance frameworks do not reflect this guidance, and may override this recommendation.

Password strength and complexity rules apply to accounts created in vSphere SSO, including administrator@vsphere.local. They do not apply to Active Directory users when vCenter Server is joined to a domain, as those password policies are enforced by AD.",Other products and services within the VMware ecosystem may not expect changes to password complexity requirements and may fail installation.,P0,"Maximum Length,
Minimum Length,
Character Requirements","Maximum Length: 20
Minimum Length: 8
At least 1 special 
At least 2 alphabetic
At least 1 uppercase
At least 1 lowercase
At least 1 numeric
3 identical adjacent","Maximum Length: 64
Minimum Length: 15
At least 1 special 
At least 1 uppercase
At least 1 lowercase
At least 1 numeric",NO,Modify,vCenter Server SSO Configuration,Get-SsoPasswordPolicy,Get-SsoPasswordPolicy | Set-SsoPasswordPolicy -MinLength 15 -MaxLength 64 -MinNumericCount 1 -MinSpecialCharCount 1 -MinAlphabeticCount 2 -MinUppercaseCount 1 -MinLowercaseCount 1 -MaxIdenticalAdjacentCharacters 3
vcenter-9.password-history,IAC-10.1,N/A,8.3.7,vCenter,9.0.0,Base,Configure the password history setting to restrict the reuse of passwords on the vCenter Server.,Password complexity rules may lead users to reuse old passwords. Configuring the password history setting on the vCenter Server can help prevent this.,None.,P2,Restrict Reuse,5,5,YES,Audit,vCenter Server SSO Configuration,Get-SsoPasswordPolicy | Select ProhibitedPreviousPasswordsCount,Get-SsoPasswordPolicy | Set-SsoPasswordPolicy -ProhibitedPreviousPasswordsCount 5
vcenter-9.password-max-age,IAC-10.1,N/A,8.3.9,vCenter,9.0.0,Base,The vCenter Server must be configured with an appropriate maximum password age.,"Modern best practices for passwords (NIST 800-63B Section 5.1.1.2, among other guidance) indicates that with adequate password entropy, security is not improved by arbitrarily requiring users to change their passwords at certain intervals. Many automated security tools and regulatory compliance frameworks do not reflect this guidance, and may override this recommendation.",None.,P0,Maximum Lifetime,90,99999,NO,Modify,vCenter Server SSO Configuration,Get-SsoPasswordPolicy | Select PasswordLifetimeDays,Get-SsoPasswordPolicy | Set-SsoPasswordPolicy -PasswordLifetimeDays 9999
vcenter-9.service-resilience-evc,BCD-02.2,N/A,2.2.6,vCenter,9.0.0,Base,VMware vCenter should enable Enhanced vMotion Compatibility for resilience and compatibility with CPU vulnerability mitigations which may cause changes in CPU microcode. ,Enhanced vMotion Compatibility masks differences in CPU generations allowing vMotion to move workloads between otherwise incompatible CPUs and hosts.,None.,P1,N/A,Not Configured,Configured,NO,Modify,N/A,N/A,N/A
vcenter-9.service-resilience-ha,BCD-02.2,N/A,2.2.6,vCenter,9.0.0,Base,VMware vCenter must enable High Availability for resilience to host faults.,vSphere High Availability (HA) allows workloads to be restarted automatically in the event of a hardware fault.,None.,P0,N/A,Not Configured,Configured,NO,Modify,N/A,N/A,N/A
vcenter-9.service-resilience-vmotion,"BCD-11.7
BCD-12.2
BCD-10",N/A,2.2.6,vCenter,9.0.0,Base,VMware vCenter must enable vMotion live workload migration.,"vMotion enables the live migration of workloads between hosts, to optimize performance as well as to handle maintenance operations.",None.,P0,N/A,Not Configured,Configured,NO,Modify,N/A,N/A,N/A
vcenter-9.session-timeout,IAC-25,VCFA-9X-000082,8.2.8,vCenter,9.0.0,Base,VMware Cloud Foundation components must enforce a session timeout after a specified period of inactivity.,"Idle vSphere Client sessions can be left open indefinitely if a user forgets to log out, thereby increasing the risk of unauthorized privileged access.",None.,P0,"""Session Timeout""",120 minutes,15 minutes,NO,Modify,vSphere Client Configuration,N/A (No public API available),N/A (No public API available)
vcenter-9.smtp,"CRY-03
NET-13
IAC-10.5",N/A,4.2.1,vCenter,9.0.0,SMTP,VMware vCenter must send email securely.,"vCenter can send alerts and alarms to administrators. If configured, ensure that it uses secure methods. Also keep in mind that this password will be visible to administrators in the advanced configuration settings so it should be a service account, or access should be granted via IP address.",None.,"P0
Upon Feature Enablement","mail.smtp.port
mail.smtp.username
mail.smtp.password",Not Configured,Configured,NO,Modify,Advanced vCenter Settings,"Get-AdvancedSetting -Entity $VC -Name ""mail.smtp.port"" 
Get-AdvancedSetting -Entity $VC -Name ""mail.smtp.username""
Get-AdvancedSetting -Entity $VC -Name ""mail.smtp.password""","Get-AdvancedSetting -Entity $VC -Name ""mail.smtp.port"" | Set-AdvancedSetting -Value ""587"" 
Get-AdvancedSetting -Entity $VC -Name ""mail.smtp.username"" | Set-AdvancedSetting -Value $VALID_USER
Get-AdvancedSetting -Entity $VC -Name ""mail.smtp.password"" | Set-AdvancedSetting -Value $VALID_PASSWORD"
vcenter-9.snmp,"CFG-03
NET-12
IAC-09
NET-03
MON-02",VCFA-9X-000322,"2.2.4
2.2.5",vCenter,9.0.0,Base,The component must disable SNMP version 1 and 2.,Services which are not in use and are not essential for operations should be deactivated.,None.,P0,N/A,Not Configured,Configured,NO,Modify,vCenter Server >> Configure >> Settings >> General,N/A,N/A
vcenter-9.snmp3,"NET-12
NET-14
NET-01
IAC-10
MON-02
IAC-09
IAC-13
CRY-01
MON-02.3",VCFA-9X-000257,4.2.1,vCenter,9.0.0,SNMP,The component must enforce SNMPv3 security features where SNMP is required.,"SNMPv3 supports commercial-grade security, including authentication, authorization, access control, and privacy. Previous versions of the protocol contained well-known security weaknesses that were easily exploited. SNMPv3 can be configured for identification and cryptographically based authentication.

SNMPv3 defines a user-based security model (USM) and a view-based access control model (VACM). SNMPv3 USM provides data integrity, data origin authentication, message replay protection, and protection against disclosure of the message payload. SNMPv3 VACM provides access control to determine whether a specific type of access (read or write) to the management information is allowed. Implement both VACM and USM for full protection.

SNMPv3 must be disabled by default and enabled only if used. SNMP v3 provides security feature enhancements to SNMP, including encryption and message authentication.",None.,"P0
Upon Feature Enablement",N/A,Not Configured,Configured,NO,Modify,N/A,N/A,N/A
vcenter-9.ssh,"CFG-03
NET-14
NET-14.1
NET-14.8
IAC-16
NET-14.4
NET-14.2",N/A,2.2.4,vCenter,9.0.0,VAMI,The component must deactivate SSH.,Services which are not in use and are not essential for operations should be deactivated.,None.,P2,"VAMI, SSH Login",Deactivated,Deactivated,YES,Audit,vCenter Server Virtual Appliance Management Interface,"(Get-CisService -Name ""com.vmware.appliance.access.ssh"").get()","(Get-CisService -Name ""com.vmware.appliance.access.ssh"").set($false)"
vcenter-9.supported,"VPM-04.1
VPM-05",N/A,6.3.3,vCenter,9.0.0,Base,vCenter Server is a version that has not reached End of General Support status.,Ensure that vCenter Server is of a version that has not reached End of General Support status.,None.,P2,Product Version & Build Number,N/A,N/A,YES,Audit,vCenter Server Virtual Appliance Management Interface,N/A,N/A
vcenter-9.time,"MON-07.1
SEA-20",VCFA-9X-000153,"10.6.1
10.6.2",vCenter,9.0.0,Base,The component must synchronize its clock with organizational reference sources.,"Cryptography, audit logging, cluster operations, and incident response/forensics require synchronized time across environments. The recommended practice for NTP is to have at least four sources. It is not advisable to have only two sources; one source is preferable to having two (Segal's Law: a person with one watch always knows what time it is, a person with two is never sure).

Configure all components to use the global standard time zone, UTC.

NTP uses UDP to communicate, which, if allowed generically, can open a path for attackers to exfiltrate data during a breach. Ensure that perimeter firewall rules allowing communication to NTP servers are specific. ",None.,P0,"VAMI, Time",Undefined,Site-Specific,NO,Modify,vCenter Server Virtual Appliance Management Interface,"(Get-CisService -Name ""com.vmware.appliance.timesync"").get()
(Get-CisService -Name ""com.vmware.appliance.ntp"").get()","(Get-CisService -Name ""com.vmware.appliance.timesync"").set(""NTP"")
(Get-CisService -Name ""com.vmware.appliance.ntp"").set(""0.vmware.pool.ntp.org,1.vmware.pool.ntp.org,2.vmware.pool.ntp.org,3.vmware.pool.ntp.org"")"
vcenter-9.tls-ciphers,"CRY-03
CRY-01",VCFA-9X-000004,"2.2.7
4.2.1
8.3.2",vCenter,9.0.0,Base,The vCenter Server must maintain confidentiality and integrity of transmissions by enabling modern TLS ciphers.,"In vCenter Server 8.0.3 and newer, TLS profiles are available to configure client and server TLS settings to use only strong ciphers.

To view the current settings, in the vSphere Client go to Developer Center, then to API Explorer. Select ""appliance"" from the ""Select API"" drop down list then scroll down to the ""tls/profiles/global"" section. Expand the GET call and click Execute.

To update this parameter, in the vSphere Client go to Developer Center, then to API Explorer. Select ""appliance"" from the ""Select API"" drop down list then scroll down to the ""tls/profiles/global"" section. Expand the PUT call and enter the following in the value box:

{
    ""profile"": ""NIST_2024""
}

Click Execute to configure a new global TLS profile. The vCenter Server will restart services after setting this parameter, disconnecting clients.","Changes to cipher suites impact connectivity with other components and external systems, and may require a restart of the component to implement.",P0,N/A,COMPATIBLE,NIST_2024,NO,Modify,vSphere Client Developer Center,N/A (Use API Explorer method in Discussion),N/A (Use API Explorer method in Discussion)
vcenter-9.vami-firewall-restrict-access,"NET-04
NET-04.3
CHG-04.3
IAC-01
IAC-01.2
IAC-02
IAC-02.3
IAC-03 
IAC-21
CFG-03
IAC-21
NET-03
NET-04.1
NET-03.7",N/A,"1.4.1
1.4.2",vCenter,9.0.0,Base,The vCenter Server must configure the firewall to only allow traffic from authorized networks.,"Ensures that all incoming and outgoing network traffic is blocked unless explicitly allowed, reducing the attack surface and helping to prevent unauthorized access to the system. Note that outgoing/egress traffic is not blocked, nor are related/established connections, so vCenter Server will still be able to communicate with systems where it initiates the connection. Perimeter firewalls should be used to curtail those types of connections.","Loss of connectivity. Ensure that you configure an allow rule for yourself prior to configuring a ""deny all"" rule.",P0,N/A,Connections allowed from any IP address,Connections allowed only from authorized infrastructure and administration workstations,NO,Modify,VAMI ,N/A,N/A
vcenter-9.vami-password-max-age,"IAC-10
IAC-10.1
IAC-10.4
IAC-10.8
IAC-22",N/A,8.3.9,vCenter,9.0.0,VAMI,The vCenter Server root account password expiration must be configured appropriately.,"Modern best practices for passwords (NIST 800-63B Section 5.1.1.2, among other guidance) indicates that with adequate password entropy, security is not improved by arbitrarily requiring users to change their passwords at certain intervals. Many automated security tools and regulatory compliance frameworks do not reflect this guidance, and may override this recommendation.",Failure to reset the password before the expiration means that recovery procedures will be necessary.,P0,"VAMI, Password Expires",Yes,No,NO,Modify,vCenter Server Virtual Appliance Management Interface,N/A,N/A
vcenter-9.vami-updates,"VPM-04.1
VPM-05",N/A,6.3.3,vCenter,9.0.0,VAMI,vCenter Server has all software updates installed.,"By keeping vCenter Server patches up to date, vulnerabilities can be mitigated. It is important to note that educated attackers can exploit known vulnerabilities when attempting to gain unauthorized access or elevate privileges.

When applying updates, it is recommended to update vCenter Server first, if an update is available, and then proceed with updating ESX. This sequence ensures that the management layer is updated before updating the ESX hosts.",None.,P0,Product Version & Build Number,N/A,N/A,NO,Modify,vCenter Server Virtual Appliance Management Interface,N/A,N/A
vcenter-9.vpxuser-length,"IAC-10
IAC-10.1
IAC-10.4
IAC-10.8
IAC-22",VCFA-9X-000344,"8.3.1
8.3.6",vCenter,9.0.0,Base,"The VMware Cloud Foundation vCenter Server must configure the ""vpxuser"" password to meet length policy.","The ""vpxuser"" password default length is 32 characters. Ensure this setting meets site policies; if not, configure to meet password length policies.

Longer passwords make brute-force password attacks more difficult. The ""vpxuser"" password is added by vCenter, meaning no manual intervention is normally required. The ""vpxuser"" password length must never be modified to less than the default length of 32 characters.",None.,P2,config.vpxd.hostPasswordLength,32,32,YES,Audit,N/A,N/A,N/A
vcenter-9.vpxuser-rotation,IAC-10.8,VCFA-9X-000328,8.3.9,vCenter,9.0.0,Base,The vCenter Server must configure the vpxuser password to be rotated on an appropriate interval.,Ensures that the vCenter Server is properly rotating the password it automatically sets on the ESX hosts.,None.,P2,VirtualCenter.VimPasswordExpirationInDays,30,30,YES,Audit,vCenter Server Advanced Settings,Get-AdvancedSetting -Entity $VC -Name VirtualCenter.VimPasswordExpirationInDays,Get-AdvancedSetting -Entity $VC -Name VirtualCenter.VimPasswordExpirationInDays | Set-AdvancedSetting -Value 30
vcf-9.disable-accounts,"IAC-15.2
IAC-15.3
IAC-15.7
IAC-17
IAC-21
CFG-03
CFG-03.1
END-15
IAC-05.2
IAC-15.1
IAC-16
IAC-21.2",VCFA-9X-000090,2.2.4,VCF,9.0.0,Base,VMware Cloud Foundation must have unnecessary or unused user accounts disabled or removed.,"Disabling expired, inactive, unused, or otherwise anomalous accounts supports the concepts of least privilege and least functionality which reduce the attack surface of the system.

This control does NOT apply to internal product appliance accounts (Linux user accounts often found in /etc/passwd). Those accounts are part of the product distribution and used for process isolation within the product. Those accounts are already disabled by having their shell set to /bin/nologin, /bin/false, or having ""!!"" in the passwd field. Removal or alteration of appliance internal accounts is unsupported and will cause operational issues, often later with upgrades and patching.",None.,P0,N/A,Undefined,Site-Specific,NO,Modify,N/A,N/A,N/A
vcf-9.log-forwarding,MON-02,"VCFA-9X-000141
VCFA-9X-000363","10.2.1
10.3.3",VCF,9.0.0,Base,Component must securely forward system and audit logs to a remote log collection point.,"By gathering host log files onto a central host, you can more easily monitor all hosts using a single tool. Additionally, you can perform aggregate analysis and searching to identify coordinated attacks on multiple hosts. Logging to a secure and centralized log server helps prevent log tampering and ensures a unified, long-term audit record.",None.,P0,See documentation for configuring VCF Operations for Logs.,Undefined,Site-Specific,NO,Modify,N/A,N/A,N/A
vcf-9.mfa,"IAC-06.1
IAC-10","VCFE-9X-000048
VCFA-9X-000054",8.3.1,VCF,9.0.0,Base,VMware Cloud Foundation and its components must be integrated with a modern identity provider.,"VMware Cloud Foundation and its components must be integrated with an identity source that supports multifactor authentication (MFA) for day-to-day administration operations. The identity source should be isolated technically and procedurally from other organizational identity sources, user provisioning systems, and configuration management systems. The identity source should enforce requirements, such as password complexity, device hygiene, number matching, geolocation, and more, in a manner equal or greater than that of normal organizational requirements.",None.,P0,See documentation for configuring identity sources in VCF Operations.,Undefined,Site-Specific,NO,Modify,N/A,N/A,N/A
vcf-9.perimeter-firewall,"DCH-01
DCH-03
NET-03.8
IAC-04
IAC-21.6",N/A,"1.4.1
1.4.2",VCF,9.0.0,Base,VCF components must limit access to their management interfaces using perimeter firewalls.,Isolation from other organizational networks and the Internet is an important part of access control and defense-in-depth for infrastructure components.,None.,P0,N/A,Undefined,Site-Specific,NO,Modify,N/A,N/A,N/A
vcf-9.permissions-roles,"MON-02.8
MON-08.2
DCH-10
DCH-10.2
DCH-14.2
END-03
END-03.2
END-16
IAC-21.3
IAC-21.1
DCH-01
DCH-03
CFG-05
IAC-21.5
IAC-21.6","VCFA-9X-000090
VCFA-9X-000351
VCFA-9X-000354
VCFA-9X-000360
VCFA-9X-000380
VCFA-9X-000381
VCFN-9X-000010",7.2.2,VCF,9.0.0,Base,Ensure that permissions granted and roles assigned are correct across all VCF components.,"Users and service accounts must only be assigned privileges they require. Least privilege requires that these privileges must only be assigned if needed to reduce risk of confidentiality, availability, or integrity loss.",None.,P0,N/A,Undefined,Site-Specific,NO,Modify,N/A,N/A,N/A
vcf-9.secure-baseline,"IAO-02
CFG-02
CFG-02.5",N/A,2.2.6,VCF,9.0.0,Base,"VMware Cloud Foundation must implement the controls found in this guidance, or equivalent compensating controls. Deviations from the baseline must have their business rationale documented.","While circular in nature, this requirement is used to fulfill various regulatory compliance requirements.",None.,P0,N/A,Undefined,Site-Specific,NO,Modify,N/A,N/A,N/A
vcf-9.time,"MON-07.1
SEA-20","VCFA-9X-000366
VCFA-9X-000367
VCFA-9X-000368
VCFA-9X-000369
VCFA-9X-000370
VCFA-9X-000371
VCFA-9X-000372","10.6.1
10.6.2",VCF,9.0.0,Base,VCF components must synchronize their clocks with organizational reference sources.,"Cryptography, audit logging, cluster operations, and incident response/forensics require synchronized time across environments. The recommended practice for NTP is to have at least four sources. It is not advisable to have only two sources; one source is preferable to having two (Segal's Law: a person with one watch always knows what time it is, a person with two is never sure).

Configure all components to use the global standard time zone, UTC.

NTP uses UDP to communicate, which, if allowed generically, can open a path for attackers to exfiltrate data during a breach. Ensure that perimeter firewall rules allowing communication to NTP servers are specific. ",None.,P0,N/A,Undefined,Site-Specific,NO,Modify,Fleet Management -> Lifecycle -> VCF Management -> Overview,N/A,N/A
vm-9.deactivate-console-copy,"NET-04
NET-04.3
CHG-04.3
IAC-01
IAC-01.2
IAC-02
IAC-02.3
IAC-03 
IAC-21
CFG-03
IAC-21
NET-03
NET-04.1
NET-03.7",VCFV-9X-000181,3.4.2,ESX,9.0.0,Virtual Machine,Virtual machines must have console copy operations deactivated.,"Deactivating console copy operations on virtual machines prevents data copying between the VM and the local client, regardless of whether the user is accessing through Web Console, VMRC, or another method.",None.,P2,isolation.tools.copy.disable,TRUE,TRUE or Undefined,YES,Audit,VM Advanced Parameters,Get-VM -Name $VM | Get-AdvancedSetting isolation.tools.copy.disable,Get-VM -Name $VM | Get-AdvancedSetting -Name isolation.tools.copy.disable | Remove-AdvancedSetting
vm-9.deactivate-console-paste,"NET-04
NET-04.3
CHG-04.3
IAC-01
IAC-01.2
IAC-02
IAC-02.3
IAC-03 
IAC-21
CFG-03
IAC-21
NET-03
NET-04.1
NET-03.7",VCFV-9X-000197,3.4.2,ESX,9.0.0,Virtual Machine,Virtual machines must have console paste operations deactivated.,"By disabling console paste operations on virtual machines, data transfer from the local client to the VM is blocked, whether the user is using Web Console, VMRC, or another console.",None.,P2,isolation.tools.paste.disable,TRUE,TRUE or Undefined,YES,Audit,VM Advanced Parameters,Get-VM -Name $VM | Get-AdvancedSetting isolation.tools.paste.disable,Get-VM -Name $VM | Get-AdvancedSetting -Name isolation.tools.paste.disable | Remove-AdvancedSetting
vm-9.deactivate-disk-shrinking-shrink,"NET-02.1
CAP-02",VCFV-9X-000198,2.2.4,ESX,9.0.0,Virtual Machine,Virtual machines must have virtual disk shrinking operations deactivated.,Disabling virtual disk shrinking on virtual machines helps avoid disk unavailability issues. The ability to perform this operation is typically limited for non-administrative users in the guest environment.,None.,P2,isolation.tools.diskShrink.disable,TRUE,TRUE or Undefined,YES,Audit,VM Advanced Parameters,Get-VM -Name $VM | Get-AdvancedSetting isolation.tools.diskShrink.disable,Get-VM -Name $VM | Get-AdvancedSetting -Name isolation.tools.diskShrink.disable | Remove-AdvancedSetting
vm-9.deactivate-disk-shrinking-wiper,"NET-02.1
CAP-02",VCFV-9X-000199,2.2.4,ESX,9.0.0,Virtual Machine,Virtual machines must have virtual disk wiping operations deactivated.,Disabling virtual disk wiping on virtual machines helps avoid disk unavailability issues. The ability to perform this operation is typically limited for non-administrative users in the guest environment.,None.,P2,isolation.tools.diskWiper.disable,TRUE,TRUE or Undefined,YES,Audit,VM Advanced Parameters,Get-VM -Name $VM | Get-AdvancedSetting isolation.tools.diskWiper.disable,Get-VM -Name $VM | Get-AdvancedSetting -Name isolation.tools.diskWiper.disable | Remove-AdvancedSetting
vm-9.deactivate-non-essential-3d-features,"NET-04
NET-04.3
CHG-04.3
IAC-01
IAC-01.2
IAC-02
IAC-02.3
IAC-03 
IAC-21
CFG-03
IAC-21
NET-03
NET-04.1
NET-03.7",VCFV-9X-000207,2.2.4,ESX,9.0.0,Virtual Machine,Virtual machines must have 3D graphics features deactivated when not required.,"Turning off 3D graphics features on virtual machines that don't need them reduces potential attack vectors, enhancing overall system security.",GPU and Virtual Desktops may require this functionality.,P2,mks.enable3d,FALSE,FALSE,YES,Audit,VM Advanced Parameters,Get-VM -Name $VM | Get-AdvancedSetting mks.enable3d,Get-VM -Name $VM | Get-AdvancedSetting mks.enable3d | Set-AdvancedSetting -Value $false
vm-9.dvfilter,"NET-04
NET-04.3
CHG-04.3
IAC-01
IAC-01.2
IAC-02
IAC-02.3
IAC-03 
IAC-21
CFG-03
IAC-21
NET-03
NET-04.1
NET-03.7",VCFV-9X-000205,2.2.6,ESX,9.0.0,Virtual Machine,"Virtual machines must limit access through the ""dvfilter"" network Application Programming Interface (API).","The dvFilter interface is used by tools like NSX to filter and inspect network traffic. Other tools may use it, too. Ensure that those tools are authorized.","Legitimate network tools, including NSX, may require this functionality.",P2,ethernet*.filter*.name,Not Present,Not Present,YES,Audit,VM Advanced Parameters,"Get-VM -Name $VM | Get-AdvancedSetting ""ethernet*.filter*.name*""","Get-VM -Name $VM | Get-AdvancedSetting ""ethernet*.filter*.name*"" | Remove-AdvancedSetting"
vm-9.efi-boot-types,"NET-04
NET-04.3
CHG-04.3
IAC-01
IAC-01.2
IAC-02
IAC-02.3
IAC-03 
IAC-21
CFG-03
IAC-21
NET-03
NET-04.1
NET-03.7",N/A,2.2.6,ESX,9.0.0,Virtual Machine,Virtual machines must prevent booting from unauthorized sources. ,"Unauthorized access to a virtual machine may occur when its primary boot volume is unavailable, and the EFI firmware seeks alternative boot sources, such as network boot. This can be mitigated through network controls, as well as with the advanced parameters bios.bootDeviceClasses, bios.bootOrder, and bios.hddOrder.

bios.bootDeviceClasses has the format ""allow:XXXX"" or ""deny:XXXX"" where XXXX is a comma-delimited list of boot classes. Boot classes are net (network PXE boot), usb (from attached USB devices), pcmcia (PCMCIA expansion cards, not used nowadays), cd (from attached virtual CD/DVD devices), hd (from attached virtual hard disks), fd (from attached virtual floppy devices), reserved (from unknown devices), efishell (into the EFI shell), all, or any (same as all).

Use of allow or deny also implicitly states the opposite. For example, deny:all disallows all boot, deny:net disallows network boot but allows all others, allow:hd allows only hd boot denies all others, allow:hd,cd allows hd then cd device boot and denies all others.

New virtual machines may require CD/DVD boot, and some dynamic environments, such as labs, may use network boot, and those environments should be set accordingly and have the rationale documented.","The virtual machine will no longer be able to boot from unspecified sources, which may negatively impact situations where PXE boot or recovery media is required. However, the parameter is easily changed at scale through PowerCLI. An alternate approach is to specify denied methods, such as ""deny:net""",Advanced,bios.bootDeviceClasses,allow:all,"allow:hd
once the guest OS is installed",NO,Modify,VM Advanced Parameters,Get-VM -Name $VM | Get-AdvancedSetting bios.bootDeviceClasses,"Get-VM -Name $VM | Get-AdvancedSetting bios.bootDeviceClasses | Set-AdvancedSetting -Value ""allow:hd"""
vm-9.ft-encrypted,"NET-14.2
CRY-01
CRY-03
CRY-01.1
CRY-04",VCFV-9X-000209,"2.2.7
4.2.1",ESX,9.0.0,Virtual Machine,Virtual machines must require encryption for Fault Tolerance.,"Requiring encryption for Fault Tolerance in VMs ensures secure data transmission. While the default 'opportunistic' encryption likely results in encryption due to ubiquitous AES-NI support in vSphere-compatible hardware, enforcing 'required' encryption guarantees no unencrypted operations.",None.,P1,VM Configuration,ftEncryptionOpportunistic,ftEncryptionRequired,NO,Modify,VM Settings,(Get-VM -Name $VM).ExtensionData.Config.FtEncryptionMode,"$VMview = Get-VM -Name $VM | Get-View 
$ConfigSpec = New-Object VMware.Vim.VirtualMachineConfigSpec
$ConfigSpec.FtEncryptionMode = New-object VMware.Vim.VirtualMachineConfigSpecEncryptedFtModes
$ConfigSpec.FtEncryptionMode = ""ftEncryptionRequired"" 
$VMview.ReconfigVM_Task($ConfigSpec)"
vm-9.isolation-device-connectable-deactivate,"NET-04
NET-04.3
CHG-04.3
IAC-01
IAC-01.2
IAC-02
IAC-02.3
IAC-03 
IAC-21
CFG-03
IAC-21
NET-03
NET-04.1
NET-03.7",VCFV-9X-000202,2.2.4,ESX,9.0.0,Virtual Machine,"Virtual machines must prevent unauthorized removal, connection and modification of devices.","Preventing unauthorized device modifications in virtual machines blocks non-admin users or processes from connecting, disconnecting, or adjusting device settings. This measure curbs unauthorized access and operation disruption, reducing denial of service risks, as well as some avenues for exfiltrating data.",None.,P2,isolation.device.connectable.disable,TRUE,TRUE or Undefined,YES,Audit,VM Advanced Parameters,Get-VM -Name $VM | Get-AdvancedSetting isolation.device.connectable.disable,Get-VM -Name $VM | Get-AdvancedSetting -Name isolation.device.connectable.disable | Remove-AdvancedSetting
vm-9.isolation-tools-dnd-deactivate,"NET-04
NET-04.3
CHG-04.3
IAC-01
IAC-01.2
IAC-02
IAC-02.3
IAC-03 
IAC-21
CFG-03
IAC-21
NET-03
NET-04.1
NET-03.7",VCFV-9X-000196,2.2.4,ESX,9.0.0,Virtual Machine,Virtual machines must have console drag and drop operations deactivated.,"Deactivating drag and drop operations in a virtual machine's console stops users from transferring data between the VM and the local client, regardless of the console type, enhancing data security.",None.,P2,isolation.tools.dnd.disable,TRUE,TRUE or Undefined,YES,Audit,VM Advanced Parameters,Get-VM -Name $VM | Get-AdvancedSetting isolation.tools.dnd.disable,Get-VM -Name $VM | Get-AdvancedSetting -Name isolation.tools.dnd.disable | Remove-AdvancedSetting
vm-9.limit-console-connections,"NET-04
NET-04.3
CHG-04.3
IAC-01
IAC-01.2
IAC-02
IAC-02.3
IAC-03 
IAC-21
CFG-03
IAC-21
NET-03
NET-04.1
NET-03.7",VCFV-9X-000200,2.2.6,ESX,9.0.0,Virtual Machine,Virtual machines must limit console sharing.,"Limiting VM console sharing to one user prevents multiple observers, enhancing security. However, this might inadvertently create a potential pathway for service denial.","May create a denial-of-service condition where the console is unusable because someone is connected, or a disconnected console session persists. Other products, such as VMware Cloud Director, may require this set to a greater value.",P0,RemoteDisplay.maxConnections,-1,1,NO,Modify,VM Advanced Parameters,Get-VM -Name $VM | Get-AdvancedSetting RemoteDisplay.maxConnections,Get-VM -Name $VM | Get-AdvancedSetting RemoteDisplay.maxConnections | Set-AdvancedSetting -Value 1
vm-9.limit-setinfo-size,"NET-02.1
CAP-02",VCFV-9X-000201,2.2.6,ESX,9.0.0,Virtual Machine,Virtual machines must limit informational messages from the virtual machine to the VMX file.,Limiting VM informational messages to the VMX file prevents it from exceeding its default size of 1MB. This control prevents potential denial of service situations that could arise if the datastore becomes full.,None.,P2,tools.setInfo.sizeLimit,1048576,1048576 or Undefined,YES,Audit,VM Advanced Parameters,Get-VM -Name $VM | Get-AdvancedSetting tools.setInfo.sizeLimit,Get-VM -Name $VM | Get-AdvancedSetting -Name tools.setInfo.sizeLimit | Remove-AdvancedSetting
vm-9.log-enable,"MON-02
MON-02.1
MON-02.2
MON-02.7
MON-03
MON-03.1
MON-03.3
MON-04
MON-06
MON-8.1
MON-8.3
MON-10
AST-14
CHG-04.1
MON-02.6",VCFV-9X-000212,10.5.1,ESX,9.0.0,Virtual Machine,Virtual machines must enable diagnostic logging.,Diagnostic logging for virtual machines helps with forensics and troubleshooting.,None.,P2,Enable Logging,TRUE,TRUE,YES,Audit,VM Settings,"Get-VM -Name $VM | Where {$_.ExtensionData.Config.Flags.EnableLogging -ne ""True""}","$VMview = Get-VM -Name $VM | Get-View 
$ConfigSpec = New-Object VMware.Vim.VirtualMachineConfigSpec
$ConfigSpec.Flags = New-Object VMware.Vim.VirtualMachineFlagInfo
$ConfigSpec.Flags.EnableLogging = $true
$VMview.ReconfigVM_Task($ConfigSpec)"
vm-9.log-retention,"NET-02.1
CAP-02
MON-04",VCFV-9X-000211,10.5.1,ESX,9.0.0,Virtual Machine,Virtual machines must limit the number of retained diagnostic logs.,"By restricting the quantity of retained diagnostic logs, we can avoid filling up the datastore without compromising diagnostic functionality.",None.,P2,log.keepOld,10,10 or Undefined,YES,Audit,VM Advanced Parameters,Get-VM -Name $VM | Get-AdvancedSetting log.keepOld,Get-VM -Name $VM | Get-AdvancedSetting -Name log.keepOld | Remove-AdvancedSetting
vm-9.log-rotation-size,"NET-02.1
CAP-02
MON-04",VCFV-9X-000210,10.5.1,ESX,9.0.0,Virtual Machine,Virtual machines must limit the size of diagnostic logs.,"Limiting the size of diagnostic logs on VMs prevents excessive space consumption, particularly on long-running VMs. As per VMware guidelines, the recommended minimum limit is 2MB.",None.,P2,log.rotateSize,2048000,2048000 or Undefined,YES,Audit,VM Advanced Parameters,Get-VM -Name $VM | Get-AdvancedSetting log.rotateSize,Get-VM -Name $VM | Get-AdvancedSetting -Name log.rotateSize | Remove-AdvancedSetting
vm-9.pci-passthrough,"NET-04
NET-04.3
CHG-04.3
IAC-01
IAC-01.2
IAC-02
IAC-02.3
IAC-03 
IAC-21
CFG-03
IAC-21
NET-03
NET-04.1
NET-03.7",VCFV-9X-000219,2.2.4,ESX,9.0.0,Virtual Machine,Virtual machines must limit PCI device passthrough functionality.,"DirectPath I/O features enable VMs to directly access system hardware, impacting risk mitigation tools like vMotion, DRS, and High Availability. It also potentially gives attackers privileged hardware access. Ensure only necessary VMs have this privilege, compensating with guest OS security controls.","Passthrough devices, such as GPUs, would be negatively affected if they are disconnected. Audit and document the business need for these VMs.",P0,N/A,Not Present,Not Present,YES,Audit,VM Settings,Get-VM -Name $VM | Get-PassthroughDevice,Get-VM -Name $VM | Get-PassthroughDevice | Remove-PassthroughDevice
vm-9.persistent-disk,"NET-04
NET-04.3
CHG-04.3
IAC-01
IAC-01.2
IAC-02
IAC-02.3
IAC-03 
IAC-21
CFG-03
IAC-21
NET-03
NET-04.1
NET-03.7",VCFV-9X-000213,2.2.6,ESX,9.0.0,Virtual Machine,"Virtual machines (VMs) must not use independent, nonpersistent disks.","The security issue with nonpersistent disk mode is that successful attackers, with a simple shutdown or reboot, might undo or remove any traces they were ever on the machine. To safeguard against this risk, production virtual machines should be set to use persistent disk mode; additionally, ensure activity within the VM is logged remotely on a separate server, such as a syslog server or equivalent Windows-based event collector. Without a persistent record of activity on a VM, administrators might never know whether they have been attacked or hacked.

There can be valid use cases for these types of disks, such as with an application presentation solution where read-only disks are desired, and such cases should be identified and documented.",None.,P2,N/A,Not Configured,Not Configured,YES,Audit,N/A,N/A,N/A
vm-9.remove-unnecessary-devices,"NET-04
NET-04.3
CHG-04.3
IAC-01
IAC-01.2
IAC-02
IAC-02.3
IAC-03 
IAC-21
CFG-03
IAC-21
NET-03
NET-04.1
NET-03.7","VCFV-9X-000215
VCFV-9X-000214
VCFV-9X-000216
VCFV-9X-000217
VCFV-9X-000218",2.2.4,ESX,9.0.0,Virtual Machine,Virtual machines must remove unnecessary virtual hardware.,"Eliminate unnecessary virtual hardware from VMs to reduce potential attack surfaces. Rarely-used ports, temporary CD/DVD drives, and hardware introduced via migrations could be vulnerable. Removing these decreases risk of software introduction or data exfiltration from a protected environment.","Removing the CD-ROM device may impact VMware Tools installation and maintenance.

Removing XHCI controllers may impact console keyboard and mouse connectivity for some guest OSes.",P0,N/A,Configured,Not Configured,NO,Modify,VM Settings,"$VMview = Get-VM -Name $VM | Get-View
$UnnecessaryHardware = ""VirtualUSBController|VirtualUSBXHCIController|VirtualParallelPort|VirtualFloppy|VirtualSerialPort|VirtualHdAudioCard|VirtualAHCIController|VirtualEnsoniq1371|VirtualCdrom""

$VMview.Config.Hardware.Device | Where-Object {$_.GetType().Name -match $UnnecessaryHardware} | Foreach-Object {
	$devname = $_.GetType().Name
	Write-Host ""$VM`: [WARNING] VM has a $devname device. Please evaluate and consider removing."" -ForegroundColor Yellow
}",N/A
vm-9.restrict-host-info,"NET-04
NET-04.3
CHG-04.3
IAC-01
IAC-01.2
IAC-02
IAC-02.3
IAC-03 
IAC-21
CFG-03
IAC-21
NET-03
NET-04.1
NET-03.7",VCFV-9X-000203,1.4.5,ESX,9.0.0,Virtual Machine,Virtual machines must not be able to obtain host information from the hypervisor.,"Preventing VMs from obtaining host information from the hypervisor mitigates risk of advanced attacks, as it denies adversaries crucial details about the physical host.",None.,P2,tools.guestlib.enableHostInfo,FALSE,FALSE or Undefined,YES,Audit,VM Advanced Parameters,Get-VM -Name $VM | Get-AdvancedSetting tools.guestlib.enableHostInfo,Get-VM -Name $VM | Get-AdvancedSetting tools.guestlib.enableHostInfo | Remove-AdvancedSetting
vm-9.secure-boot,"END-06.5
END-06.6
AST-18
END-15
TDA-14.1
END-06.1
CHG-04.2
TDA-01.2
END-04
AST-15",N/A,5.2.3,ESX,9.0.0,Virtual Machine,The guest OS must enable Secure Boot.,"Secure Boot, supported by all modern guest OSes, uses public key cryptography to validate firmware, boot loader, drivers, and OS kernel. By preventing system booting with uncertain boot chain validity, it effectively restricts malware.",Enabling this after guest OS install may involve more process than just checking the box. Refer to your guest OS documentation for instructions.,N/A,N/A,Site-Specific,TRUE,NO,Modify,VM Settings,N/A,N/A
vm-9.transparentpagesharing-inter-vm-enabled,"NET-04
NET-04.3
CHG-04.3
IAC-01
IAC-01.2
IAC-02
IAC-02.3
IAC-03
IAC-21
CFG-03
IAC-21
NET-03
NET-04.1
NET-03.7",VCFV-9X-000204,2.2.6,ESX,9.0.0,Virtual Machine,Virtual machines must restrict sharing of memory pages between VMs.,"Transparent Page Sharing (TPS) reduces VM memory footprint but could enable unauthorized data access in some very limited conditions. To bolster security, VMs should be configured with the sched.mem.pshare.salt option, preventing memory sharing with other VMs.",None.,P2,sched.mem.pshare.salt,Not Present,Not Present,YES,Audit,VM Advanced Parameters,Get-VM -Name $VM | Get-AdvancedSetting sched.mem.pshare.salt,Get-VM -Name $VM | Get-AdvancedSetting -Name sched.mem.pshare.salt | Remove-AdvancedSetting
vm-9.virtual-hardware,"VPM-04.1
VPM-05",N/A,2.2.6,ESX,9.0.0,Virtual Machine,The guest OS must ensure that virtual machine hardware is version 19 or newer where supported.,"Virtual hardware 19 is compatible with ESX 7.0 Update 2 and later. Newer versions of virtual hardware enable new features and better performance. Consider upgrading to VM Hardware 22 if you are fully updated to VCF 9. Other VMware guidance urges caution when upgrading; we urge testing of the process. Snapshots capture the virtual hardware version, making testing and rollback easy.

Consider all locations that a virtual machine might run, or need to be restored to.

Changes to the configuration of VMware-supplied virtual appliances are not supported and may cause service disruptions.","Changing VM hardware versions changes device versions inside the guest, which may have repercussions. Test, and remember that snapshots also capture the VM version, too, so it can be reverted.

Changes to the configuration of VMware-supplied virtual appliances are not supported and may cause service disruptions.",N/A,N/A,Site-Specific,vmx-19,NO,Modify,VM Compatibility,N/A,N/A
vm-9.vmotion-encrypted,"NET-14.2
CRY-01
CRY-03
CRY-01.1
CRY-04",VCFV-9X-000208,"2.2.7
4.2.1",ESX,9.0.0,Virtual Machine,Virtual machines must require encryption for vMotion.,"Requiring encryption for vMotion in virtual machines guarantees secure data transfer. The default 'opportunistic' encryption likely results in encryption due to widespread AES-NI support in vSphere-compatible hardware. However, enforcing 'required' encryption prevents any unencrypted operations.",None.,P1,VM Configuration,opportunistic,required,NO,Modify,VM Settings,(Get-VM -Name $VM).ExtensionData.Config.MigrateEncryption,"$VMview = Get-VM -Name $VM | Get-View 
$ConfigSpec = New-Object VMware.Vim.VirtualMachineConfigSpec
$ConfigSpec.MigrateEncryption = New-Object VMware.Vim.VirtualMachineConfigSpecEncryptedVMotionModes
$ConfigSpec.MigrateEncryption = ""required""
$VMview.ReconfigVM_Task($ConfigSpec)"
vm-9.vmrc-lock,"IAC-24
IAC-24.1",VCFV-9X-000206,2.2.6,ESX,9.0.0,Virtual Machine,Virtual machines must be configured to lock when the last console connection is closed.,Locking virtual machines when the last console connection closes can prevent potential unauthorized access from attackers exploiting logged-in console sessions.,None.,P0,tools.guest.desktop.autolock,FALSE,TRUE,NO,Modify,VM Settings,Get-VM -Name $VM | Get-AdvancedSetting tools.guest.desktop.autolock,Get-VM -Name $VM | Get-AdvancedSetting -Name tools.guest.desktop.autolock | Set-AdvancedSetting -Value $true
vsan-9.automatic-rebalance,DCH-24.1,N/A,2.2.6,vSAN,9.0.0,Base,vSAN should automatically correct data storage imbalances. ,vSAN Automatic Rebalancing proactively ensures optimal performance. It should be enabled to proactively correct situations that may have formed from other maintenance or outage conditions.,None.,P0,N/A,Disabled,Enabled,NO,Modify if Feature in Use,"vSAN Services, Storage",N/A,N/A
vsan-9.auto-policy-management,DCH-24.1,N/A,2.2.6,vSAN,9.0.0,ESA,vSAN must enable automatic policy management.,vSAN Automatic Policy Management monitors the default policy for vSAN datastores and makes recommendations to improve reliability when vSAN health conditions change.,"Will potentially alter storage policies for VMs using ""datastore default"" settings.",P0,N/A,Disabled,Enabled,NO,Modify if Feature in Use,"vSAN Services, Storage",N/A,N/A
vsan-9.encryption-rest,"CRY-05
AST-07
CRY-01.1
AST-09
BCD-11.4
DCH-08
DCH-09",VCFA-9X-000191,"3.3.2
3.3.3
3.5.1",vSAN,9.0.0,Base,vSAN must protect data at rest.,"vSAN Data-at-Rest encryption helps maintain the confidentiality of sensitive data while it resides on storage devices and reduce the risk of unauthorized access or exposure in the event of physical theft or loss. This configuration parameter can be altered while the cluster is operational. Enabling data-at-rest protections will reformat disk groups (for vSAN OSA) and rewrite stored objects (for vSAN ESA), which may take considerable time, but it will be done in the background. Workloads do not need to be powered off.","All encryption comes at the cost of CPU cycles and potential storage latency. How much this impacts workloads depends on a variety of factors, such as the configuration of the underlying hardware and the type and frequency of storage I/O by the workload.",P0,N/A,Disabled,Enabled,NO,Modify,"vSAN Configuration,
Data Services",N/A,N/A
vsan-9.encryption-transit-esa,"NET-14.2
CRY-01
CRY-03
CRY-01.1
CRY-04",VCFA-9X-000343,"3.3.2
3.3.3
3.5.1",vSAN,9.0.0,ESA,vSAN must protect storage-related network communications.,"vSAN Data-in-Transit encryption helps ensure that sensitive data remains confidential while traversing the network, reducing the risk of unauthorized access or interception. This configuration parameter can be altered while the cluster is operational.

vSAN ESA with data-at-rest protections enabled transmits data in an encrypted form by default.","All encryption comes at the cost of CPU cycles and potential storage latency. How much this impacts workloads depends on a variety of factors, such as the configuration of the underlying hardware and the type and frequency of storage I/O by the workload.",Advanced,N/A,Enabled if using vSAN Data-at-Rest Protections,Enabled,YES,Audit,"vSAN Configuration,
Data Services",N/A,N/A
vsan-9.encryption-transit-osa,"NET-14.2
CRY-01
CRY-03
CRY-01.1
CRY-04",VCFA-9X-000343,"3.3.2
3.3.3
3.5.1",vSAN,9.0.0,OSA,vSAN must protect storage-related network communications.,"vSAN Data-in-Transit encryption helps ensure that sensitive data remains confidential while traversing the network, reducing the risk of unauthorized access or interception. This configuration parameter can be altered while the cluster is operational.

vSAN ESA with data-at-rest protections enabled transmits data in an encrypted form by default.","All encryption comes at the cost of CPU cycles and potential storage latency. How much this impacts workloads depends on a variety of factors, such as the configuration of the underlying hardware and the type and frequency of storage I/O by the workload.",P0,N/A,Disabled,Enabled,NO,Modify,"vSAN Configuration,
Data Services",N/A,N/A
vsan-9.file-services-access-control-nfs,"NET-04
NET-04.3
CHG-04.3
IAC-01
IAC-01.2
IAC-02
IAC-02.3
IAC-03 
IAC-21
CFG-03
IAC-21
NET-03
NET-04.1
NET-03.7",N/A,3.6.1,vSAN,9.0.0,File Service - NFS,NFS file shares on vSAN File Services must be configured to restrict access.,"When configuring an NFS file share the ""Customize net access"" option should be selected with a restrictive set of permissions configured.",Loss of connectivity to clients.,"P0
Upon Feature Enablement",N/A,No Access,Customize Net Access,NO,Modify,vSAN File Share Configuration,N/A,N/A
vsan-9.file-services-authentication-smb,"NET-14.2
CRY-01
CRY-03
CRY-01.1
CRY-04",N/A,3.6.1,vSAN,9.0.0,File Service - SMB,SMB file shares on vSAN File Services must accept only encrypted SMB authentication communications. ,When configuring an SMB file share the Protocol Encryption option must be enabled.,None.,"P0
Upon Feature Enablement",N/A,Disabled,Enabled,NO,Modify,vSAN File Share Configuration,N/A,N/A
vsan-9.force-provisioning,DCH-24.1,N/A,2.2.6,vSAN,9.0.0,Base,vSAN must not provision storage when storage policy requirements cannot be met.,"If the storage policy ""Force Provisioning"" option is set to Yes, the object is provisioned even if the Failures to tolerate, Number of disk stripes per object, and Flash read cache reservation policies specified in the storage policy cannot be satisfied by the datastore. While this might be helpful in bootstrapping scenarios and during an outage when standard provisioning is no longer possible, normal operations should not permit storage policy violations.",None.,P2,N/A,Disabled,Disabled,YES,Audit,"Policies and Profiles,
VM Storage Policies",N/A,N/A
vsan-9.iscsi-mutual-chap,"NET-14.2
CRY-01
CRY-03
CRY-01.1
CRY-04",VCFA-9X-000331,3.6.1,vSAN,9.0.0,iSCSI Target,vSAN iSCSI target must enable bidirectional/mutual CHAP authentication.,"Mutual CHAP provides an additional layer of protection by requiring both the initiator (client) and the target (server) to verify their identities to each other, thereby ensuring data transmitted between the two is not intercepted or altered by unauthorized entities.",May be more difficult to configure clients.,"P0
Upon Feature Enablement",N/A,Disabled,Enabled,NO,Modify,vSAN iSCSI Target Configuration,N/A,N/A
vsan-9.managed-disk-claim,DCH-24.1,N/A,2.2.6,vSAN,9.0.0,ESX,vSAN must disable managed disk claims.,"With vSAN Managed Disk Claim enabled, vSAN will claim all compatible disks automatically. This presents a variety of risks around drive lifecycle. Leave this feature disabled and either claim disks manually, or enable it temporarily at the infrequent times when you are adding capacity and can monitor the operation.",Disk claims must be handled manually.,P2,N/A,Not Configured,Configured,NO,Modify,N/A,N/A,N/A
vsan-9.network-isolation-vsan-iscsi-target,SEA-03,N/A,3.6.1,vSAN,9.0.0,iSCSI Target,"Ensure that the vSAN iSCSI Target uses its own VMkernel network interfaces, isolated on their own network segments and employing separate perimeter controls using Distributed Port Group Traffic Filtering and Marking, NSX, or external network security controls.","Because the iSCSI Target clients will be external to the cluster they should be isolated on their own network interfaces, so that other, internal-only network communications can be restricted separately. Isolation of this type also helps diagnose and manage performance.",None.,"P0
Upon Feature Enablement",N/A,Not Configured,Configured,NO,Modify if Feature in Use,vSAN iSCSI Target Configuration,N/A,N/A
vsan-9.network-isolation-vsan-max,SEA-03,N/A,3.6.1,vSAN,9.0.0,MAX,vSAN Max must have its storage network traffic isolated.,vSAN Max does not offer data-in-transit encryption to the target storage host. Isolate the storage traffic using dedicated VLANs or other technology.,None.,P0,N/A,Not Configured,Configured,NO,Modify,N/A,N/A,N/A
vsan-9.object-checksum,DCH-24.1,N/A,4.2.1,vSAN,9.0.0,Base,vSAN must calculate object checksums to protect data integrity.,"vSAN uses end-to-end checksum to ensure the integrity of data by confirming that each copy of a file is exactly the same as the source file. The system checks the validity of the data during read/write operations, and if an error is detected, vSAN repairs the data or reports the error. Integrity problems cannot be detected if the vSAN policy disables checksums. For vSAN Express Storage Architecture, object checksums are always computed, and cannot be deactivated.",None.,P2,N/A,Disabled,Disabled,YES,Audit,"Policies and Profiles,
VM Storage Policies",N/A,N/A
vsan-9.operations-reserve,DCH-24.1,N/A,2.2.6,vSAN,9.0.0,Base,vSAN must reserve space to complete internal maintenance operations.,"vSAN Operations Reserve capacity setting helps ensure that vSAN always has sufficient free space to maintain the availability and reliability of the vSAN datastore and prevent potential data loss or service disruptions due to insufficient capacity during operations like policy changes. This configuration parameter can be altered while the cluster is operational.

vSAN Host Reserve can also be enabled, but use of Auto-Policy Management will be constrained on small vSAN clusters. Please see the post Understanding ‘Reserved Capacity’ Concepts in vSAN (https://blogs.vmware.com/cloud-foundation/2022/02/18/understanding-reserved-capacity-concepts-in-vsan/) for more information.",Enabling this will reduce the usable capacity of the vSAN datastore.,P0,N/A,Disabled,Enabled,NO,Modify,"vSAN Configuration,
Reservations and Alerts",N/A,N/A
