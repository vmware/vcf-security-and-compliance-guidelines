SCG ID,Product,Product Version,Component,Component Version,Feature/Function,Implementation Priority,Description/Title,Discussion,Configuration Parameter,Installation Default Value,Baseline Suggested Value,Is the Default?,Action Needed,Setting Location,Potential Functional Impact if Default Value is Changed,PowerCLI Command Assessment,PowerCLI Command Remediation Example,Audited in SCG Tools?,Remediated in SCG Tools?,DISA STIG Mapping,DISA STIG Requirement,DISA STIG Control Exceeds Baseline?,PCI DSS 4.0 Mapping,PCI DSS 4.0 Requirement,PCI DSS 4.0 Control Exceeds Baseline?,VCF Compatible,,,,,,,
esxi-8.account-auto-unlock-time,VMware vSphere,8,VMware ESXi,8.0.3,Base,P2,The ESXi host must unlock accounts after a specified timeout period.,"Ensures that user accounts on the ESXi host are automatically unlocked after a defined period of inactivity. By enforcing automatic account unlocking, organizations can maintain a balance between security and usability, ensuring that idle accounts are reactivated promptly while minimizing the potential for unauthorized access.",Security.AccountUnlockTime,900,900,YES,Audit,"ESXi Advanced
System Settings",None,Get-VMHost -Name $ESXi | Get-AdvancedSetting Security.AccountUnlockTime,Get-VMHost -Name $ESXi | Get-AdvancedSetting Security.AccountUnlockTime | Set-AdvancedSetting -Value 900,TRUE,TRUE,ESXI-80-000111,900,NO,8.3.4,30 minutes,NO,TRUE,,,,,,,
esxi-8.account-dcui,VMware vSphere,8,VMware ESXi,8.0.3,Base,P0,The ESXi host must deny shell access for the dcui account.,The dcui user is used for process isolation for the DCUI itself. The account has shell access which can be deactivated to reduce attack surface.,N/A,true,false,NO,Modify,esxcli,None,"$ESXcli = Get-EsxCli -VMHost $ESXi -V2
$ESXcli.system.account.list.Invoke() | Where-Object { $_.UserID -eq 'dcui' } | Select-Object -ExpandProperty Shellaccess","$ESXcli = Get-EsxCli -VMHost $ESXi -V2
$arguments = $ESXcli.system.account.set.CreateArgs()
$arguments.id = ""dcui""
$arguments.shellaccess = ""false""
$ESXcli.system.account.set.Invoke($arguments)",TRUE,TRUE,ESXI-80-000249,false,NO,2.2.4,N/A,N/A,TRUE,,,,,,,
esxi-8.account-lockout,VMware vSphere,8,VMware ESXi,8.0.3,Base,P2,The ESXi host must lock an account after a specified number of failed login attempts.,"Protects against brute-force attacks and unauthorized access attempts by temporarily disabling the affected account, preventing further login attempts until the lockout period expires or is manually reset by an administrator.",Security.AccountLockFailures,5,5,YES,Audit,"ESXi Advanced
System Settings","A low threshold for login failures can create an avenue for denial-of-service attacks, whether intentional or unintentional, such as with SSH connection retries.",Get-VMHost -Name $ESXi | Get-AdvancedSetting Security.AccountLockFailures,Get-VMHost -Name $ESXi | Get-AdvancedSetting Security.AccountLockFailures | Set-AdvancedSetting -Value 5,TRUE,TRUE,ESXI-80-000005,3,YES,8.3.4,10 attempts,NO,TRUE,,,,,,,
esxi-8.account-password-history,VMware vSphere,8,VMware ESXi,8.0.3,Base,P2,Configure the password history setting to restrict the reuse of passwords on the ESXi host.,"Prevent the reuse of previous passwords, thus mitigating potential breaches from old, compromised credentials.",Security.PasswordHistory,5,5,YES,Audit,"ESXi Advanced
System Settings",None,Get-VMHost -Name $ESXi | Get-AdvancedSetting Security.PasswordHistory,Get-VMHost -Name $ESXi | Get-AdvancedSetting Security.PasswordHistory | Set-AdvancedSetting -Value 5,TRUE,TRUE,ESXI-80-000043,5,NO,8.3.7,4,NO,TRUE,,,,,,,
esxi-8.account-password-max-days,VMware vSphere,8,VMware ESXi,8.0.3,Base,P2,The ESXi host must be configured with an appropriate maximum password age.,"Modern best practices for passwords, as outlined in NIST 800-63B Section 5.1.1.2 and other relevant guidance, state that enforcing periodic password changes does not enhance security when passwords already possess adequate entropy.",Security.PasswordMaxDays,9999,9999,YES,Audit,"ESXi Advanced
System Settings",vSphere UIs may not permit this to be set without providing an email address for an alert. Use PowerCLI or provide an email address (to receive email you will need to configure an SMTP server in vCenter Server),Get-VMHost -Name $ESXi | Get-AdvancedSetting Security.PasswordMaxDays,Get-VMHost -Name $ESXi | Get-AdvancedSetting Security.PasswordMaxDays | Set-AdvancedSetting -Value 9999,TRUE,TRUE,ESXI-80-000227,90,YES,8.3.9,90 days,YES,TRUE,,,,,,,
esxi-8.account-password-policies,VMware vSphere,8,VMware ESXi,8.0.3,Base,P0,The ESXI host must enforce password complexity.,"Based on recommendations such as NIST 800-63B Section 5.1.1.2, it is suggested that composition rules, such as mandating mixtures of character classes, should not be enforced on systems as they often fail to enhance password security and discourage the adoption of more secure passphrases.

Password strength and complexity rules are applicable to all ESXi users, including the root user. However, when the ESX host is joined to a domain, these rules do not apply to Active Directory (AD) users as password policies for AD users are enforced by the AD system.",Security.PasswordQualityControl,"""retry=3 min=disabled,disabled,disabled,7,7""","""similar=deny retry=3 min=disabled,disabled,disabled,disabled,15 max=64""",NO,Modify,"ESXi Advanced
System Settings",Other products and services within the VMware ecosystem may not expect changes to password complexity requirements and may fail installation.,Get-VMHost -Name $ESXi | Get-AdvancedSetting Security.PasswordQualityControl,"Get-VMHost -Name $ESXi | Get-AdvancedSetting Security.PasswordQualityControl | Set-AdvancedSetting -Value ""similar=deny retry=3 min=disabled,disabled,disabled,disabled,15 max=64""",TRUE,TRUE,"ESXI-80-000035
ESXI-80-000044","""similar=deny retry=3 min=disabled,disabled,disabled,disabled,15""",NO,"8.3.1
8.3.6","""similar=deny retry=3 min=disabled,disabled,disabled,disabled,12 max=64""",NO,TRUE,,,,,,,
esxi-8.account-vpxuser,VMware vSphere,8,VMware ESXi,8.0.3,Base,Advanced,The ESXi host must deny shell access for the vpxuser account.,"The vpxuser account is created by vCenter Server when the host is first attached, and is subseqently used for privileged authentication to ESXi. While the password is automatically rotated by vCenter Server on an interval governed by VirtualCenter.VimPasswordExpirationInDays, it also has shell access which can be deactivated to reduce attack surface.

Users who do not have shell access cannot reconfigure other users' shell access, no matter their privilege levels. Since vCenter Server connects as vpxuser, once vpxuser has been stripped of shell access it will no longer be able to change those user settings for others. Further reconfiguration will need to happen on a host-by-host basis using an account that is authorized.

For security, ESXi 8 no longer supports traditional password or account recovery operations, such as booting from media or changing init to a shell on boot.

Ensure that the host retains at least one fully privileged user, protected well.",N/A,true,false,NO,Modify,esxcli,"Users who do not have shell access cannot reconfigure other users' shell access, no matter their privilege levels. Since vCenter Server connects as vpxuser, once vpxuser has been stripped of shell access it will no longer be able to change those user settings for others. Further reconfiguration will need to happen on a host-by-host basis using an account that is authorized.

For security, ESXi 8 no longer supports traditional password or account recovery operations, such as booting from media or changing the boot shell.

Ensure that the host retains at least one fully privileged user, protected well.","$ESXcli = Get-EsxCli -VMHost $ESXi -V2
$ESXcli.system.account.list.Invoke() | Where-Object { $_.UserID -eq 'vpxuser' } | Select-Object -ExpandProperty Shellaccess","$ESXcli = Get-EsxCli -VMHost $ESXi -V2
$arguments = $ESXcli.system.account.set.CreateArgs()
$arguments.id = ""vpxuser""
$arguments.shellaccess = ""false""
$ESXcli.system.account.set.Invoke($arguments)",FALSE,FALSE,N/A,N/A,N/A,N/A,N/A,N/A,FALSE,,,,,,,
esxi-8.ad-auth-proxy,VMware vSphere,8,VMware ESXi,8.0.3,Active Directory,"P0
Upon Feature Enablement",The vCenter Server must use the vSphere Authentication Proxy to avoid storing Active Directory credentials.,"The vSphere Authentication Proxy enables vCenter to connect to and manage AD entities without the need to directly store AD credentials, which reduces the risk of credential exposure or misuse.",N/A,Not Configured,Configured If Feature In Use,NO,Modify,ESXi Authentication Settings,None,"Get-VMHost -Name $ESXi | Get-VMHostAuthentication | Select-Object VMHost,Domain,DomainMembershipStatus",N/A,TRUE,TRUE,ESXI-80-000240,Configured If Feature In Use,NO,N/A,N/A,N/A,TRUE,,,,,,,
esxi-8.annotations-welcomemessage,VMware vSphere,8,VMware ESXi,8.0.3,Base,P1,Configure the ESXi host login banner for the DCUI and Host Client.,"ESXi enables the display of a login message often used to deter intruders by declaring their activities as illegal, and to inform authorized users of their responsibilities and conditions for system use. While not a direct technical security control, this has positive implications for enforcement and prosecution if attackers are caught. This parameter defines the text displayed on both the Host Client login page and DCUI.",Annotations.WelcomeMessage,Undefined,"Consult your organization's legal advisors for text that is applicable to your environment.

An example is: ""Authorized users only. Actual or attempted unauthorized use of this system is prohibited and may result in criminal, civil, security, or administrative proceedings and/or penalties. Use of this information system indicates consent to monitoring and recording, without notice or permission. Users have no expectation of privacy in any use of this system. Any information stored on, or transiting this system, or obtained by monitoring and/or recording, may be disclosed to law enforcement and/or used in accordance with Federal law, State statute, and organization policy. If you are not an authorized user of this system, exit the system at this time.""",NO,Modify,"ESXi Advanced
System Settings","Masks the ""F2/F12"" and IP address information on the DCUI, which can be a benefit, but may also require documentation and/or training.",Get-VMHost -Name $ESXi | Get-AdvancedSetting Annotations.WelcomeMessage,"Get-VMHost -Name $ESXi | Get-AdvancedSetting Annotations.WelcomeMessage | Set-AdvancedSetting -Value ""Authorized users only. Actual or attempted unauthorized use of this system is prohibited and may result in criminal, civil, security, or administrative proceedings and/or penalties. Use of this information system indicates consent to monitoring and recording, without notice or permission. Users have no expectation of privacy in any use of this system. Any information stored on, or transiting this system, or obtained by monitoring and/or recording, may be disclosed to law enforcement and/or used in accordance with Federal law, State statute, and organization policy. If you are not an authorized user of this system, exit the system at this time.""",TRUE,TRUE,"ESXI-80-000006
ESXI-80-000007","{bgcolor:black} {/color}{align:left}{bgcolor:black}{color:yellow}{hostname} , {ip}{/color}{/bgcolor}{/align}
{bgcolor:black} {/color}{align:left}{bgcolor:black}{color:yellow}{esxproduct} {esxversion}{/color}{/bgcolor}{/align}
{bgcolor:black} {/color}{align:left}{bgcolor:black}{color:yellow}{memory} RAM{/color}{/bgcolor}{/align}
{bgcolor:black} {/color}{align:left}{bgcolor:black}{color:white}	{/color}{/bgcolor}{/align}
{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}                                                                                                                          {/color}{/bgcolor}{/align}
{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}  You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only. By      {/color}{/bgcolor}{/align}
{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}  using this IS (which includes any device attached to this IS), you consent to the following conditions:                 {/color}{/bgcolor}{/align}
{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}                                                                                                                          {/color}{/bgcolor}{/align}
{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}  -       The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited     {/color}{/bgcolor}{/align}
{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}          to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law      {/color}{/bgcolor}{/align}
{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}          enforcement (LE), and counterintelligence (CI) investigations.                                                  {/color}{/bgcolor}{/align}
{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}                                                                                                                          {/color}{/bgcolor}{/align}
{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}  -       At any time, the USG may inspect and seize data stored on this IS.                                              {/color}{/bgcolor}{/align}
{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}                                                                                                                          {/color}{/bgcolor}{/align}
{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}  -       Communications using, or data stored on, this IS are not private, are subject to routine monitoring,            {/color}{/bgcolor}{/align}
{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}          interception, and search, and may be disclosed or used for any USG-authorized purpose.                          {/color}{/bgcolor}{/align}
{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}                                                                                                                          {/color}{/bgcolor}{/align}
{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}  -       This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not     {/color}{/bgcolor}{/align}
{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}          for your personal benefit or privacy.                                                                           {/color}{/bgcolor}{/align}
{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}                                                                                                                          {/color}{/bgcolor}{/align}
{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}  -       Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching    {/color}{/bgcolor}{/align}
{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}          or monitoring of the content of privileged communications, or work product, related to personal representation  {/color}{/bgcolor}{/align}
{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}          or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work       {/color}{/bgcolor}{/align}
{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}          product are private and confidential. See User Agreement for details.                                           {/color}{/bgcolor}{/align}
{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}                                                                                                                          {/color}{/bgcolor}{/align}
{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}                                                                                                                          {/color}{/bgcolor}
{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}                                                                                                                          {/color}{/bgcolor}
{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}                                                                                                                          {/color}{/bgcolor}
{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}                                                                                                                          {/color}{/bgcolor}
{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}                                                                                                                          {/color}{/bgcolor}
{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}                                                                                                                          {/color}{/bgcolor}
{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}                                                                                                                          {/color}{/bgcolor}
{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}                                                                                                                          {/color}{/bgcolor}
{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}                                                                                                                          {/color}{/bgcolor}
{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}                                                                                                                          {/color}{/bgcolor}
{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}                                                                                                                          {/color}{/bgcolor}
{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}                                                                                                                          {/color}{/bgcolor}
{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}                                                                                                                          {/color}{/bgcolor}
{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}                                                                                                                          {/color}{/bgcolor}
{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}                                                                                                                          {/color}{/bgcolor}
{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}                                                                                                                          {/color}{/bgcolor}
{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}                                                                                                                          {/color}{/bgcolor}
{bgcolor:black} {/color}{align:left}{bgcolor:dark-grey}{color:white}  <F2> Accept Conditions and Customize System / View Logs{/align}{align:right}<F12> Accept Conditions and Shut Down/Restart  {bgcolor:black} {/color}{/color}{/bgcolor}{/align}
{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}                                                                                                                          {/color}{/bgcolor}",YES,N/A,N/A,N/A,TRUE,,,,,,,
esxi-8.api-soap-timeout,VMware vSphere,8,VMware ESXi,8.0.3,Base,P2,The ESXi host must configure a session timeout for the vSphere API.,"This practice helps mitigate potential security risks by ensuring that unattended sessions, which could be exploited by unauthorized users or malicious software, are not left open indefinitely.",Config.HostAgent.vmacore.soap.sessionTimeout,30,30,YES,Audit,"ESXi Advanced
System Settings",None,Get-VMHost -Name $ESXi | Get-AdvancedSetting Config.HostAgent.vmacore.soap.sessionTimeout,Get-VMHost -Name $ESXi | Get-AdvancedSetting Config.HostAgent.vmacore.soap.sessionTimeout | Set-AdvancedSetting -Value 30,TRUE,TRUE,ESXI-80-000226,30,NO,8.2.8,15 minutes,NO,TRUE,,,,,,,
esxi-8.cpu-hyperthread-warning,VMware vSphere,8,VMware ESXi,8.0.3,Base,P2,The ESXi host must not suppress warnings about unmitigated hyperthreading vulnerabilities.,"Hyperthreading security warnings signify unaddressed CPU vulnerabilities in the system, and ignoring these could mask potential risks. Ensure that hardware remediations align with your organization's accepted risk, and if suppressing a warning, document the decision and rationale.",UserVars.SuppressHyperthreadWarning,0,0,YES,Audit,"ESXi Advanced
System Settings",None,Get-VMHost -Name $ESXi | Get-AdvancedSetting UserVars.SuppressHyperthreadWarning,Get-VMHost -Name $ESXi | Get-AdvancedSetting UserVars.SuppressHyperthreadWarning | Set-AdvancedSetting -Value 0,TRUE,TRUE,ESXI-80-000223,0,NO,N/A,N/A,N/A,TRUE,,,,,,,
esxi-8.dcui-timeout,VMware vSphere,8,VMware ESXi,8.0.3,Base,P2,Set a timeout to automatically terminate idle DCUI sessions on the ESXi host.,"DCUI allows direct login to the ESXi host for managing tasks. To prevent unintended DCUI usage from leftover login sessions, It is essential to terminate idle connections.",UserVars.DcuiTimeOut,600,600,YES,Audit,"ESXi Advanced
System Settings",None,Get-VMHost -Name $ESXi | Get-AdvancedSetting UserVars.DcuiTimeOut,Get-VMHost -Name $ESXi | Get-AdvancedSetting UserVars.DcuiTimeOut | Set-AdvancedSetting -Value 600,TRUE,TRUE,ESXI-80-000196,600,NO,8.2.8,15 minutes,NO,TRUE,,,,,,,
esxi-8.deactivate-cim,VMware vSphere,8,VMware ESXi,8.0.3,Base,P0,The ESXi CIM service should be deactivated.,Services which are not in use and are non-essential for operations should be deactivated.,N/A,"Stopped,
Start and stop with host","Stopped,
Start and stop manually",NO,Modify,ESXi Services Configuration,None,"Get-VMHostService -VMHost $ESXi | Where-Object {$_.Key -eq 'sfcbd-watchdog' -and $_.Running -eq 'True'}
Get-VMHostService -VMHost $ESXi | Where-Object {$_.Key -eq 'sfcbd-watchdog' -and $_.Policy -eq 'On'}","Get-VMHostService -VMHost $ESXi | where {$_.Key -eq 'sfcbd-watchdog'} | Set-VMHostService -Policy Off
Get-VMHostService -VMHost $ESXi | where {$_.Key -eq 'sfcbd-watchdog'} | Stop-VMHostService",TRUE,TRUE,ESXI-80-000228,"Stopped,
Start and stop manually",NO,2.2.4,N/A,N/A,TRUE,,,,,,,
esxi-8.deactivate-mob,VMware vSphere,8,VMware ESXi,8.0.3,Base,P2,The ESXi Managed Object Browser (MOB) must be deactivated.,Services which are not in use and are non-essential for operations should be deactivated.,Config.HostAgent.plugins.solo.enableMob,False,False,YES,Audit,"ESXi Advanced
System Settings",None,Get-VMHost -Name $ESXi | Get-AdvancedSetting Config.HostAgent.plugins.solo.enableMob,Get-VMHost -Name $ESXi | Get-AdvancedSetting Config.HostAgent.plugins.solo.enableMob | Set-AdvancedSetting -Value False,TRUE,TRUE,ESXI-80-000047,False,NO,2.2.4,N/A,N/A,TRUE,,,,,,,
esxi-8.deactivate-shell,VMware vSphere,8,VMware ESXi,8.0.3,Base,P2,The ESXi shell should be deactivated.,Services which are not in use and are non-essential for operations should be deactivated.,N/A,"Stopped,
Start and stop manually","Stopped,
Start and stop manually",YES,Audit,ESXi Services Configuration,None,"Get-VMHostService -VMHost $ESXi | Where-Object {$_.Key -eq 'TSM' -and $_.Running -eq 'True'}
Get-VMHostService -VMHost $ESXi | Where-Object {$_.Key -eq 'TSM' -and $_.Policy -eq 'On'}","Get-VMHostService -VMHost $ESXi | where {$_.Key -eq 'TSM'} | Set-VMHostService -Policy Off
Get-VMHostService -VMHost $ESXi | where {$_.Key -eq 'TSM'} | Stop-VMHostService",TRUE,TRUE,ESXI-80-000194,"Stopped,
Start and stop manually",NO,2.2.4,N/A,N/A,TRUE,,,,,,,
esxi-8.deactivate-slp,VMware vSphere,8,VMware ESXi,8.0.3,Base,P2,The ESXi SLP service should be deactivated.,Services which are not in use and are non-essential for operations should be deactivated.,N/A,"Stopped,
Start and stop manually","Stopped,
Start and stop manually",YES,Audit,ESXi Services Configuration,None,"Get-VMHostService -VMHost $ESXi | Where-Object {$_.Key -eq 'slpd' -and $_.Running -eq 'True'}
Get-VMHostService -VMHost $ESXi | Where-Object {$_.Key -eq 'slpd' -and $_.Policy -eq 'On'}","Get-VMHostService -VMHost $ESXi | where {$_.Key -eq 'slpd'} | Set-VMHostService -Policy Off
Get-VMHostService -VMHost $ESXi | where {$_.Key -eq 'slpd'} | Stop-VMHostService",TRUE,TRUE,ESXI-80-000231,"Stopped,
Start and stop manually",NO,2.2.4,N/A,N/A,TRUE,,,,,,,
esxi-8.deactivate-snmp,VMware vSphere,8,VMware ESXi,8.0.3,Base,P0,The ESXi SNMP service should be deactivated.,Services which are not in use and are non-essential for operations should be deactivated.,N/A,"Stopped,
Start and stop with host","Stopped,
Start and stop manually",NO,Modify,ESXi Services Configuration,None,"Get-VMHostService -VMHost $ESXi | Where-Object {$_.Key -eq 'snmpd' -and $_.Running -eq 'True'}
Get-VMHostService -VMHost $ESXi | Where-Object {$_.Key -eq 'snmpd' -and $_.Policy -eq 'On'}","Get-VMHostService -VMHost $ESXi | where {$_.Key -eq 'snmpd'} | Set-VMHostService -Policy Off
Get-VMHostService -VMHost $ESXi | where {$_.Key -eq 'snmpd'} | Stop-VMHostService",TRUE,TRUE,ESXI-80-000212,"Stopped,
Start and stop manually",NO,"2.2.4
2.2.5",N/A,N/A,TRUE,,,,,,,
esxi-8.deactivate-ssh,VMware vSphere,8,VMware ESXi,8.0.3,Base,P2,The ESXi SSH service should be deactivated.,Services which are not in use and are non-essential for operations should be deactivated.,N/A,"Stopped,
Start and stop manually","Stopped,
Start and stop manually",YES,Audit,ESXi Services Configuration,None,"Get-VMHostService -VMHost $ESXi | Where-Object {$_.Key -eq 'TSM-SSH' -and $_.Running -eq 'True'}
Get-VMHostService -VMHost $ESXi | Where-Object {$_.Key -eq 'TSM-SSH' -and $_.Policy -eq 'On'}","Get-VMHostService -VMHost $ESXi | where {$_.Key -eq 'TSM-SSH'} | Set-VMHostService -Policy Off
Get-VMHostService -VMHost $ESXi | where {$_.Key -eq 'TSM-SSH'} | Stop-VMHostService",TRUE,TRUE,ESXI-80-000193,"Stopped,
Start and stop manually",NO,2.2.4,N/A,N/A,TRUE,,,,,,,
esxi-8.entropy,VMware vSphere,8,VMware ESXi,8.0.3,Base,P2,The ESXi host must use sufficient entropy for cryptographic operations.,"Starting in vSphere 8.0, the ESXi Entropy implementation supports the FIPS 140-3 and EAL4 certifications. Kernel boot options control which entropy sources to activate on an ESXi host.",N/A,"disableHwrng = FALSE
entropySources = 0","disableHwrng = FALSE
entropySources = 0",YES,Audit,ESXi Shell,None,"$ESXcli = Get-EsxCli -VMHost $ESXi -V2
$ESXcli.system.settings.kernel.list.Invoke() | Where {$_.Name -eq ""disableHwrng"" -or $_.Name -eq ""entropySources""}","$ESXcli = Get-EsxCli -VMHost $ESXi -V2
$arguments = $ESXcli.system.settings.kernel.set.CreateArgs()
$arguments.setting = ""disableHwrng""
$arguments.value = ""FALSE""
$ESXcli.system.settings.kernel.set.invoke($arguments)
$arguments.setting = ""entropySources""
$arguments.value = ""0""
$ESXcli.system.settings.kernel.set.invoke($arguments)",TRUE,TRUE,ESXI-80-000245,"disableHwrng = FALSE
entropySources = 0",NO,"2.2.7
3.3.2
3.3.3
8.3.2",N/A,N/A,TRUE,,,,,,,
esxi-8.etc-issue,VMware vSphere,8,VMware ESXi,8.0.3,Base,P1,Configure the login banner for ESXi host SSH connections.,"ESXi enables a login message display, often used to deter intruders and inform authorized users about system use obligations. This parameter defines the text shown during an SSH connection. It is highly recommended to keep SSH in the stopped state unless troubleshooting.

An implementation inconsistency between ESXi and vCenter Server requires that ""issue"" in Config.Etc.issue be lowercase, to work in both scenarios.",Config.Etc.issue,Undefined,"Consult your organization's legal advisors for text that is applicable to your environment.

An example is: ""Authorized users only. Actual or attempted unauthorized use of this system is prohibited and may result in criminal, civil, security, or administrative proceedings and/or penalties. Use of this information system indicates consent to monitoring and recording, without notice or permission. Users have no expectation of privacy in any use of this system. Any information stored on, or transiting this system, or obtained by monitoring and/or recording, may be disclosed to law enforcement and/or used in accordance with Federal law, State statute, and organization policy. If you are not an authorized user of this system, exit the system at this time.""",NO,Modify,"ESXi Advanced
System Settings",None,Get-VMHost -Name $ESXi | Get-AdvancedSetting Config.Etc.issue,"Get-VMHost -Name $ESXi | Get-AdvancedSetting Config.Etc.issue | Set-AdvancedSetting -Value ""****************************************************************************`n* Authorized users only. Actual or attempted unauthorized use of this      *`n* system is prohibited and may result in criminal, civil, security, or     *`n* administrative proceedings and/or penalties. Use of this information     *`n* system indicates consent to monitoring and recording, without notice     *`n* or permission. Users have no expectation of privacy. Any information     *`n* stored on or transiting this system, or obtained by monitoring and/or    *`n* recording, may be disclosed to law enforcement and/or used in accordance *`n* with Federal law, State statute, and organization policy. If you are not *`n* an authorized user of this system, exit the system at this time.         *`n****************************************************************************`n""",TRUE,TRUE,ESXI-80-000191,Standard Mandatory DOD Notice and Consent Banner,YES,N/A,N/A,N/A,TRUE,,,,,,,
esxi-8.firewall-incoming-default,VMware vSphere,8,VMware ESXi,8.0.3,Base,P2,The ESXi host must configure the firewall to block network traffic by default.,"Ensures that all incoming and outgoing network traffic is blocked unless explicitly allowed, reducing the attack surface and preventing unauthorized access to the host.",N/A,Enabled,Enabled,YES,Audit,esxcli,None,Get-VMHost -Name $ESXi | Get-VMHostFirewallDefaultPolicy,"$ESXcli = Get-EsxCli -VMHost $ESXi -V2
$arguments = $ESXcli.network.firewall.set.CreateArgs()
$arguments.defaultaction = $FALSE
$arguments.enabled = $true
$ESXcli.network.firewall.set.Invoke($arguments)",FALSE,FALSE,ESXI-80-000214,Enabled,NO,1.3.1,N/A,N/A,TRUE,,,,,,,
esxi-8.firewall-restrict-access,VMware vSphere,8,VMware ESXi,8.0.3,Base,P1,Configure the ESXi host firewall to only allow traffic from authorized networks.,"Ensures that all incoming and outgoing network traffic is blocked unless explicitly allowed, reducing the attack surface and helping to prevent unauthorized access to the host.

As of vSphere 8.0.2, firewall rules are categorized as 'user' or 'system' owned, where only 'user' owned rules are configurable. Beginning in vSphere 8 Update 2b and PowerCLI 13.2.1 there are additional queryable parameters to automate setting and checking for configurable rules.",N/A,Connections allowed from any IP address,Connections allowed only from authorized infrastructure and administration workstations,NO,Modify,ESXi Firewall Configuration,"Firewall is simplistic, akin to router ACLs, and may need reflexive rules configured.","$ESXcli = Get-EsxCli -VMHost $ESXi -V2
$list = $ESXcli.network.firewall.ruleset.list.Invoke() | Where {($_.AllowedIPconfigurable -eq $true) -and ($_.EnableDisableconfigurable -eq $true)} | Select -ExpandProperty Name

$arguments = $ESXcli.network.firewall.ruleset.allowedip.list.CreateArgs()
foreach ($rule in $list) {
    $arguments.rulesetid = $rule
    $ESXcli.network.firewall.ruleset.allowedip.list.Invoke($arguments) 
}","# This is an example which you will want to customize!
$ESXcli = Get-EsxCli -VMHost $ESXi -V2
# Deactivate firewall temporarily so we don't lose connectivity
$arguments = $ESXcli.network.firewall.set.CreateArgs()
$arguments.enabled = $false
$ESXcli.network.firewall.set.Invoke($arguments)

# Unset the ""allow all"" flag
$arguments = $ESXcli.network.firewall.ruleset.set.CreateArgs()
$arguments.allowedall = $false
$arguments.rulesetid = ""sshServer""
$ESXcli.network.firewall.ruleset.set.Invoke($arguments)

# Add an IP range
$arguments = $ESXcli.network.firewall.ruleset.allowedip.add.CreateArgs()
$arguments.ipaddress = ""192.168.0.0/16""
$arguments.rulesetid = ""sshServer""
$ESXcli.network.firewall.ruleset.allowedip.add.Invoke($arguments)

# Enable the firewall
$arguments = $ESXcli.network.firewall.set.CreateArgs()
$arguments.enabled = $true
$ESXcli.network.firewall.set.Invoke($arguments)",FALSE,FALSE,ESXI-80-000239,Connections allowed only from authorized infrastructure and administration workstations,NO,"1.3.1
1.4.1
1.4.2
1.4.4",N/A,N/A,TRUE,,,,,,,
esxi-8.host-client-session-timeout,VMware vSphere,8,VMware ESXi,8.0.3,Base,P2,The ESXi host must automatically terminate idle host client sessions.,"This practice helps mitigate potential security risks by ensuring that unattended sessions, which could be exploited by unauthorized users or malicious software, are not left open indefinitely.",UserVars.HostClientSessionTimeout,900,900,YES,Audit,"ESXi Advanced
System Settings",None,Get-VMHost -Name $ESXi | Get-AdvancedSetting UserVars.HostClientSessionTimeout,Get-VMHost -Name $ESXi | Get-AdvancedSetting UserVars.HostClientSessionTimeout | Set-AdvancedSetting -Value 900,TRUE,TRUE,ESXI-80-000010,900,NO,8.2.8,15 minutes,NO,TRUE,,,,,,,
esxi-8.hw-virtual-nic,VMware vSphere,8,VMware ESXi,8.0.3,Base,Advanced,The ESXi host must not enable virtual hardware management network interfaces.,Hardware management controllers often present virtual or USB NICs to the ESXi host. These can be used as backdoors and should be deactivated both in the hardware configuration and in ESXi.,Net.BMCNetworkEnable,1,0,NO,Modify,"ESXi Advanced
System Settings",Some third-party managed solutions may require this.,Get-VMHost -Name $ESXi | Get-AdvancedSetting Net.BMCNetworkEnable,Get-VMHost -Name $ESXi | Get-AdvancedSetting Net.BMCNetworkEnable | Set-AdvancedSetting -Value 0,TRUE,TRUE,ESXI-80-000250,0,NO,"1.3.1
1.4.1
1.4.2
1.4.4",N/A,N/A,TRUE,,,,,,,
esxi-8.iscsi-mutual-chap,VMware vSphere,8,VMware ESXi,8.0.3,iSCSI,"P0
Upon Feature Enablement",Enable bidirectional/mutual CHAP authentication for iSCSI traffic.,"Mutual CHAP provides an additional layer of protection by requiring both the initiator (client) and the target (server) to verify their identities to each other, thereby ensuring data transmitted between the two is not intercepted or altered by unauthorized entities.","Set iSCSI storage adapter authentication to ""Use bidirectional CHAP"" and supply credentials",Not Configured,Enabled,NO,Modify if Feature in Use,ESXi iSCSI Configuration,None,"Get-VMHost -Name $ESXi | Get-VMHostHba | Where {$_.Type -eq ""Iscsi""} | Select VMHost, Device, ChapType, @{N=""CHAPName"";E={$_.AuthenticationProperties.ChapName}}","Get-VMHost -Name $ESXi | Get-VMHostHba | Where {$_.Type -eq ""Iscsi""} | Set-VMHostHba <parameters>",FALSE,FALSE,ESXI-80-000145,Enabled,NO,8.3.2,N/A,N/A,TRUE,,,,,,,
esxi-8.key-persistence,VMware vSphere,8,VMware ESXi,8.0.3,TPM,"P2
Upon Feature Enablement",The ESXi host must not store encryption keys on ESXi hosts without securing physical access to the hosts.,"Key Persistence is a mechanism that uses a local Trusted Platform Module (TPM) to store Standard Key Provider keys, usually found only in an external Key Management System (KMS). While this setup can improve management of dependencies, using Key Persistence changes the encryption risks. If an attacker steals the host, they will have access to the encryption keys for data on that host, bypassing the access controls of the external KMS. Therefore, Key Persistence should be used only when the physical security of the hosts is assured. If the physical hosts are not secure and an attacker can steal the host, they will also have the means to access and use encrypted workloads.

Key Persistence and Native Key Provider are often conflated because both store encryption data on hosts. However, the Native Key Provider does not use Key Persistence, so turning off Key Persistence won't affect it. Like Key Persistence, the Native Key Provider also requires careful consideration of physical security, as outlined in the 'design-8.native-key-provider' and 'design-8.hardware-physical-security' controls.",N/A,false,false,YES,Audit,esxcli,Default is desired behavior. Change away from the default may negatively impact confidentiality in environments where physical access by attackers is possible.,"$ESXcli = Get-EsxCli -VMHost $ESXi -V2
$ESXcli.system.security.keypersistence.get.invoke() | Select-Object -ExpandProperty Enabled","$ESXcli = Get-EsxCli -VMHost $ESXi -V2
$arguments = $ESXcli.system.security.keypersistence.disable.CreateArgs()
$arguments.removeallstoredkeys = $true
$ESXcli.system.security.keypersistence.disable.Invoke($arguments)",TRUE,FALSE,ESXI-80-000248,false,NO,"3.3.2
3.3.3
3.5.1",N/A,N/A,TRUE,,,,,,,
esxi-8.lockdown-dcui-access,VMware vSphere,8,VMware ESXi,8.0.3,Base,P2,The ESXi host must have an accurate DCUI.Access list.,"Ensures that only authorized users have direct console user interface (DCUI) access to the ESXi host when Lockdown Mode is enabled. The root user cannot be removed from the list.

To control ESXi Shell and/or SSH access use the Lockdown Mode Exception Users list.",DCUI.Access,root,root,YES,Audit,"ESXi Advanced
System Settings",Potential for loss of administrative access to hosts. Ensure that the host is attached to the vCenter Server and that access lists and exception lists are configured prior to configuring lockdown mode.,Get-VMHost -Name $ESXi | Get-AdvancedSetting DCUI.Access,Get-VMHost -Name $ESXi | Get-AdvancedSetting DCUI.Access | Set-AdvancedSetting -Value root,TRUE,TRUE,ESXI-80-000189,root,NO,2.2.4,N/A,N/A,TRUE,,,,,,,
esxi-8.lockdown-exception-users,VMware vSphere,8,VMware ESXi,8.0.3,Base,P2,The ESXi host must have an accurate Exception Users list.,"Users on the Lockdown Mode ""Exception Users"" list do not lose their privileges when the host enters lockdown mode, which can potentially defeat the purpose of lockdown mode.",N/A,Null,Null,YES,Audit,ESXi Security Profile,Potential for loss of administrative access to hosts. Ensure that the host is attached to the vCenter Server and that access lists and exception lists are configured prior to configuring lockdown mode.,(Get-View (Get-VMHost -Name $ESXi | Get-View).ConfigManager.HostAccessManager).QueryLockdownExceptions(),(Get-View (Get-VMHost -Name $ESXi | Get-View).ConfigManager.HostAccessManager).UpdateLockdownExceptions($NULL),TRUE,TRUE,ESXI-80-000201,Null,NO,2.2.4,N/A,N/A,TRUE,,,,,,,
esxi-8.lockdown-mode,VMware vSphere,8,VMware ESXi,8.0.3,Base,P0,Enable normal lockdown mode on the ESXi host.,"Enabling lockdown mode deactivates direct access to an ESXi host and requires that the host be managed remotely from vCenter Server. This is done to ensure that the roles and access controls implemented in vCenter are always enforced, and users cannot bypass them by logging into a host directly. By forcing all interactions to occur through vCenter Server, the risk of someone attaining elevated privileges or performing tasks that are not properly audited is greatly reduced.

Note that users listed in the Exception Users list for each host are allowed to override lockdown mode and log in. By default, no users are present on the Exception Users list.

There are three settings for lockdown mode: disabled, normal, and strict. Choosing strict means that if the ESXi host loses contact with vCenter Server, it cannot be managed in any way until that connection is restored. If the connection cannot be restored, the host will need to be rebuilt. This level of lockdown mode is typically not necessary for most deployments and can present significant operational challenges. Therefore, we recommend using normal lockdown mode.",N/A,lockdownDisabled,lockdownNormal,NO,Modify,ESXi Security Profile,"Potential for loss of administrative access to hosts. Ensure that the host is attached to vCenter Server and that access lists and exception lists are configured prior to configuring lockdown mode.

There are some operations, such as backup and troubleshooting, that require direct access to the host. In these cases, Lockdown Mode can be deactivated on a temporary basis for specific hosts as needed, and then re-enabled when the task is completed.",(Get-View (Get-VMHost -Name $ESXi | Get-View).ConfigManager.HostAccessManager).LockdownMode,(Get-View (Get-VMHost -Name $ESXi | Get-View).ConfigManager.HostAccessManager).ChangeLockdownMode('lockdownNormal'),TRUE,TRUE,ESXI-80-000008,lockdownNormal,NO,2.2.4,N/A,N/A,TRUE,,,,,,,
esxi-8.logs-audit-local,VMware vSphere,8,VMware ESXi,8.0.3,Base,P0,The ESXi host must enable audit record logging.,ESXi will store audit records locally.,Syslog.global.auditRecord.storageEnable,FALSE,TRUE,NO,Modify,"ESXi Advanced
System Settings",Additional storage space consumed by logs.,Get-VMHost -Name $ESXi | Get-AdvancedSetting Syslog.global.auditRecord.storageEnable,Get-VMHost -Name $ESXi | Get-AdvancedSetting Syslog.global.auditRecord.storageEnable | Set-AdvancedSetting -Value TRUE,TRUE,TRUE,ESXI-80-000232,TRUE,NO,10.2.1,N/A,N/A,TRUE,,,,,,,
esxi-8.logs-audit-local-capacity,VMware vSphere,8,VMware ESXi,8.0.3,Base,P1,The ESXi host must store one week of audit records.,"If a remote audit record storage facility is available, it is essential to ensure that the local storage capacity is sufficient to hold audit records that may accumulate during anticipated interruptions in the delivery of records to the facility. This ensures that audit records are not lost or overwritten during periods when the remote storage is unavailable, allowing for seamless continuity of the audit trail and compliance requirements.",Syslog.global.auditRecord.storageCapacity,4,100,NO,Modify,"ESXi Advanced
System Settings",Additional storage space consumed by logs.,Get-VMHost -Name $ESXi | Get-AdvancedSetting Syslog.global.auditRecord.storageCapacity,Get-VMHost -Name $ESXi | Get-AdvancedSetting Syslog.global.auditRecord.storageCapacity | Set-AdvancedSetting -Value 100,TRUE,TRUE,ESXI-80-000113,100,NO,10.5.1,"12 months, with
3 immediately available",YES,TRUE,,,,,,,
esxi-8.logs-audit-persistent,VMware vSphere,8,VMware ESXi,8.0.3,Base,P0,Configure a persistent log location for all locally stored audit records on the ESXi host.,"ESXi can be configured to store audit records on an in-memory file system.  This occurs when the host's ""/scratch"" directory is linked to ""/tmp/scratch"". When this is done only a single day's worth of records are stored at any time. In addition audit records will be reinitialized upon each reboot.  This presents a security risk as user activity logged on the host is only stored temporarily and will not persistent across reboots.  This can also complicate auditing and make it harder to monitor events and diagnose issues.  ESXi host audit record logging should always be configured to a persistent datastore.

You can detect if the scratch volume is temporary or persistent by querying the ScratchConfig.CurrentScratchLocation advanced parameter. If, when queried, it returns ""/tmp/scratch"" then the volume is temporary and you should remap the audit record storage to a persistent device.

Cannot be a vSAN datastore. If your only local, non-vSAN storage is SD or USB media (which can become unreliable with repeated writes from logs) you might consider leaving the logs in the ramdisk and ensuring that a remote logging host is configured instead. Document the decision and rationale in preparation for future audits.","ScratchConfig.CurrentScratchLocation
Syslog.global.auditRecord.storageDirectory","Depends on boot device
[] /scratch/auditLog",Persistent Storage Location,NO,Modify,"ESXi Advanced
System Settings",Additional storage space consumed by logs.,"$ESXcli = Get-EsxCli -VMHost $ESXi -V2
$ESXcli.system.syslog.config.get.Invoke() | Select LocalLogOutput,LocalLogOutputIsPersistent

If your LocalLogOutput is set to a directory in /scratch, and LocalLogOutputIsPersistent is true, that means your boot device is of a type and size that makes /scratch persistent. Verify that your audit storage is also on /scratch, and that /scratch points to a VMFS datastore:

Get-VMHost -Name $ESXi | Get-AdvancedSetting ScratchConfig.CurrentScratchLocation
Get-VMHost -Name $ESXi | Get-AdvancedSetting Syslog.global.auditRecord.storageDirectory","Get-VMHost -Name $ESXi | Get-AdvancedSetting Syslog.global.auditRecord.storageDirectory | Set-AdvancedSetting -Value ""<PERSISTENT LOCATION>/audit""",TRUE,FALSE,ESXI-80-000243,Persistent Storage Location,NO,10.5.1,"12 months, with
3 immediately available",YES,TRUE,,,,,,,
esxi-8.logs-audit-remote,VMware vSphere,8,VMware ESXi,8.0.3,Base,P0,The ESXi host must transmit audit records to a remote host.,ESXi will transmit audit records to the configured log collector.,Syslog.global.auditRecord.remoteEnable,FALSE,TRUE,NO,Modify,"ESXi Advanced
System Settings",None,Get-VMHost -Name $ESXi | Get-AdvancedSetting Syslog.global.auditRecord.remoteEnable,Get-VMHost -Name $ESXi | Get-AdvancedSetting Syslog.global.auditRecord.remoteEnable | Set-AdvancedSetting -Value TRUE,TRUE,TRUE,ESXI-80-000233,TRUE,NO,"10.2.1
10.3.3",N/A,N/A,TRUE,,,,,,,
esxi-8.logs-filter,VMware vSphere,8,VMware ESXi,8.0.3,Base,P2,The ESXi host must not enable log filtering.,"You can create log filters to reduce the number of repetitive entries, and to deny specific log events entirely.",N/A,false,false,YES,Audit,"ESXi Advanced
System Settings",None,"$ESXcli = Get-EsxCli -VMHost $ESXi -V2
$ESXcli.system.syslog.config.logfilter.get.invoke() | Select -ExpandProperty LogFilteringEnabled ","$ESXcli = Get-EsxCli -VMHost $ESXi -V2
$arguments = $esxcli.system.syslog.config.logfilter.set.CreateArgs()
$arguments.logfilteringenabled = $false
$ESXcli.system.syslog.config.logfilter.set.invoke($arguments)",TRUE,TRUE,ESXI-80-000246,false,NO,10.2.1,N/A,N/A,TRUE,,,,,,,
esxi-8.logs-level,VMware vSphere,8,VMware ESXi,8.0.3,Base,P2,Set the ESXi host logging informational level to info.,It is important to ensure that sufficient information is present in audit logs for diagnostics and forensics purposes.,Config.HostAgent.log.level,info,info,YES,Audit,"ESXi Advanced
System Settings",Additional storage space consumed by logs.,Get-VMHost -Name $ESXi | Get-AdvancedSetting Config.HostAgent.log.level,Get-VMHost -Name $ESXi | Get-AdvancedSetting Config.HostAgent.log.level | Set-AdvancedSetting -Value info,TRUE,TRUE,"ESXI-80-000015
ESXI-80-000030",info,NO,10.2.1,N/A,N/A,TRUE,,,,,,,
esxi-8.logs-level-global,VMware vSphere,8,VMware ESXi,8.0.3,Base,P2,The ESXi host must log sufficient information for events.,"It is important to ensure that sufficient information is present in audit logs for diagnostics and forensics purposes. The recommendation for this parameter in the Security Configuration Guide has traditionally been ""info"" but with the introduction of the audit logging subsystems there is no longer a need for the extra log traffic. As such, the recommendation has changed to use the product default of ""error"" unless debugging or troubleshooting.",Syslog.global.logLevel,error,error,YES,Audit,"ESXi Advanced
System Settings",Additional storage space consumed by logs.,Get-VMHost -Name $ESXi | Get-AdvancedSetting Syslog.global.logLevel,Get-VMHost -Name $ESXi | Get-AdvancedSetting Syslog.global.logLevel | Set-AdvancedSetting -Value error,TRUE,TRUE,ESXI-80-000235,info,NO,10.2.1,N/A,N/A,TRUE,,,,,,,
esxi-8.logs-persistent,VMware vSphere,8,VMware ESXi,8.0.3,Base,P0,Configure a persistent log location for all locally stored logs on the ESXi host.,"ESXi can be configured to store log files on an in-memory file system. This occurs when the host's ""/scratch"" directory is linked to ""/tmp/scratch"". When this is done, only a single day's worth of logs is stored at any time. Additionally, log files will be reinitialized upon each reboot. This presents a security risk as user activity logged on the host is only stored temporarily and will not persist across reboots. It can also complicate auditing and make it harder to monitor events and diagnose issues. Therefore, it is recommended to configure ESXi host logging to a persistent datastore.

You can detect if the scratch volume is temporary or persistent by querying the ScratchConfig.CurrentScratchLocation advanced parameter. If, when queried, it returns ""/tmp/scratch"" then the volume is temporary and you should remap the audit record storage to a persistent device.

Cannot be a vSAN datastore unless Syslog.global.vsanBacking is set, which has caveats & dependencies. If your only local, non-vSAN storage is SD or USB media (which can become unreliable with repeated writes from logs) you might consider leaving the logs in the ramdisk and ensuring that a remote logging host is configured instead. Document the decision and rationale in preparation for future audits.","LocalLogOutputIsPersistent
ScratchConfig.CurrentScratchLocation
Syslog.global.logDir","Depends on boot device
[] /scratch/log",Persistent Storage Location,NO,Modify,"ESXi Advanced
System Settings",None,"$ESXcli = Get-EsxCli -VMHost $ESXi -V2
$ESXcli.system.syslog.config.get.Invoke() | Select LocalLogOutput,LocalLogOutputIsPersistent

If your LocalLogOutput is set to a directory in /scratch, and LocalLogOutputIsPersistent is true, that means your boot device is of a type and size that makes /scratch persistent. Verify that your log storage is also on /scratch, , and that /scratch points to a VMFS datastore:

Get-VMHost -Name $ESXi | Get-AdvancedSetting ScratchConfig.CurrentScratchLocation
Get-VMHost -Name $ESXi | Get-AdvancedSetting Syslog.global.logDir","Get-VMHost -Name $ESXi | Get-AdvancedSetting Syslog.global.logDir | Set-AdvancedSetting -Value ""<PERSISTENT LOCATION>""
",TRUE,FALSE,ESXI-80-000243,Persistent Storage Location,NO,10.5.1,"12 months, with
3 immediately available",YES,TRUE,,,,,,,
esxi-8.logs-remote,VMware vSphere,8,VMware ESXi,8.0.3,Base,P0,Configure a remote log server for the ESXi host.,"Remote logging to a central log host provides a secure and centralized store for ESXi logs. By gathering host log files onto a central host, you can more easily monitor all hosts using a single tool. Additionally, you can perform aggregate analysis and searching to identify coordinated attacks on multiple hosts. Logging to a secure and centralized log server helps prevent log tampering and ensures a long-term audit record.",Syslog.global.logHost,Undefined,Site-Specific Log Server,NO,Modify,"ESXi Advanced
System Settings",None,Get-VMHost -Name $ESXi | Get-AdvancedSetting Syslog.global.logHost,"Get-VMHost -Name $ESXi | Get-AdvancedSetting Syslog.global.logHost | Set-AdvancedSetting -Value ""<log collector>""",TRUE,FALSE,ESXI-80-000114,Site-Specific Log Server,NO,"10.2.1
10.3.3",N/A,N/A,TRUE,,,,,,,
esxi-8.logs-remote-tls,VMware vSphere,8,VMware ESXi,8.0.3,Base,P2,The ESXi host must verify certificates for TLS remote logging endpoints.,TLS certificates help ensure that the endpoint is authentic and trustworthy.,Syslog.global.certificate.checkSSLCerts,TRUE,TRUE,YES,Audit,"ESXi Advanced
System Settings",None,Get-VMHost -Name $ESXi | Get-AdvancedSetting Syslog.global.certificate.checkSSLCerts,Get-VMHost -Name $ESXi | Get-AdvancedSetting Syslog.global.certificate.checkSSLCerts | Set-AdvancedSetting -Value TRUE,TRUE,TRUE,ESXI-80-000224,TRUE,NO,2.2.7,N/A,N/A,TRUE,,,,,,,
esxi-8.logs-remote-tls-x509,VMware vSphere,8,VMware ESXi,8.0.3,Base,P0,The ESXi host must use strict x509 verification for TLS-enabled remote logging endpoints.,"This ""x509-strict"" option performs additional validity checks on CA root certificates during verification.",Syslog.global.certificate.strictX509Compliance,FALSE,TRUE,NO,Modify,"ESXi Advanced
System Settings",None,Get-VMHost -Name $ESXi | Get-AdvancedSetting Syslog.global.certificate.strictX509Compliance,Get-VMHost -Name $ESXi | Get-AdvancedSetting Syslog.global.certificate.strictX509Compliance | Set-AdvancedSetting -Value TRUE,TRUE,TRUE,ESXI-80-000234,TRUE,NO,2.2.7,N/A,N/A,TRUE,,,,,,,
esxi-8.memeagerzero,VMware vSphere,8,VMware ESXi,8.0.3,Base,P0,The ESXi host must enable volatile key destruction.,"By default, ESXi zeroes out pages allocated for virtual machines (VMs), userspace applications, and kernel threads at the time of allocation. This ensures that no non-zero pages are exposed to VMs or userspace applications. This measure is in place to prevent the exposure of cryptographic keys from VMs or userworlds to other clients.

However, if memory is not reused, these keys can remain present in host memory for an extended period. To address this, MemEagerZero can be configured to enforce the zeroing out of userworld and guest memory pages when a userworld process or guest exits. For kernel threads, memory spaces holding keys are zeroed out as soon as the secret is no longer required.",Mem.MemEagerZero,0,1,NO,Modify,"ESXi Advanced
System Settings","Additional shutdown time required for virtual machines, corresponding to the amount of allocated memory.",Get-VMHost -Name $ESXi | Get-AdvancedSetting Mem.MemEagerZero,Get-VMHost -Name $ESXi | Get-AdvancedSetting Mem.MemEagerZero | Set-AdvancedSetting -Value 1,TRUE,TRUE,ESXI-80-000225,1,NO,3.6.1,N/A,N/A,TRUE,,,,,,,
esxi-8.network-bpdu,VMware vSphere,8,VMware ESXi,8.0.3,Base,P2,Enable the Bridge Protocol Data Unit (BPDU) filter on the ESXi host.,"BPDUs (Bridge Protocol Data Units) are used to transmit Spanning Tree Protocol (STP) information and detect network loops. BPDU Guard and Portfast are commonly enabled on the physical switch directly connected to the ESXi host to reduce spanning tree convergence delay.

However, if a BPDU packet is sent from a virtual machine on the ESXi host to the configured physical switch, it can result in a cascading lockout of all uplink interfaces from the ESXi host. To prevent this type of lockout, BPDU Filter can be enabled on the ESXi host to drop any BPDU packets being sent to the physical switch.

It is important to note that Standard and Distributed Virtual Switches do not support STP and do not generate BPDUs.",Net.BlockGuestBPDU,1,1,YES,Audit,"ESXi Advanced
System Settings","Some network-oriented workloads can legitimately generate BPDU packets. The administrator should verify that there are no legitimate BPDU packets generated by virtual machines on the ESXi host prior to enabling BPDU Filter. If BPDU Filter is enabled in this situation, enabling Reject Forged Transmits on the virtual switch port group adds protection against Spanning Tree loops.",Get-VMHost -Name $ESXi | Get-AdvancedSetting Net.BlockGuestBPDU,Get-VMHost -Name $ESXi | Get-AdvancedSetting Net.BlockGuestBPDU | Set-AdvancedSetting -Value 1,TRUE,TRUE,ESXI-80-000215,1,NO,N/A,N/A,N/A,TRUE,,,,,,,
esxi-8.network-dvfilter,VMware vSphere,8,VMware ESXi,8.0.3,Base,P2,Use of the dvFilter network APIs must be restricted on the ESXi host.,"If you are not using a product such as VMware NSX that utilizes the dvfilter network API, it is recommended not to configure the host to send network information to an IP address. Enabling the API and referencing an IP address that is compromised could potentially provide unauthorized access to the network of other virtual machines (VMs) on the host.

If you are using a product that relies on this API, it is important to verify that the host has been configured correctly to ensure secure network communication.",Net.DVFilterBindIpAddress,"""""","""""",YES,Audit,"ESXi Advanced
System Settings",None,Get-VMHost -Name $ESXi | Get-AdvancedSetting Net.DVFilterBindIpAddress,"Get-VMHost -Name $ESXi | Get-AdvancedSetting Net.DVFilterBindIpAddress | Set-AdvancedSetting -Value """"",TRUE,TRUE,ESXI-80-000219,"""""",NO,N/A,N/A,N/A,TRUE,,,,,,,
esxi-8.network-reject-forged-transmit-standardswitch,VMware vSphere,8,VMware ESXi,8.0.3,Standard Switch,"P1
Upon Feature Enablement",All standard switches and their port groups must be configured to reject forged transmits.,"If the MAC address of a virtual machine operating system changes, it allows the operating system to send frames with an impersonated source MAC address, potentially enabling malicious attacks on devices within a network by impersonating an authorized network adapter.

When the ""Forged transmits"" option is set to ""Accept,"" ESXi does not compare the source and effective MAC addresses.

To protect against MAC impersonation, you can set the ""Forged transmits"" option to ""Reject."" In this case, the host compares the source MAC address being transmitted by the guest operating system with the effective MAC address for its virtual machine adapter to check for a match. If the addresses do not match, the ESXi host drops the packet.",N/A,Accept,Reject,NO,Modify,Virtual Switch Settings,"Some workloads, such as clustered applications and network devices/functions, rely on these techniques as a normal part of their operation. If necessary, it is recommended to create a separate port group that allows this behavior, with only authorized virtual machines connected to it.","Get-VMHost -Name $ESXi | Get-VirtualSwitch -Standard | Get-SecurityPolicy | select VirtualSwitch,ForgedTransmits
Get-VMHost -Name $ESXi | Get-VirtualPortGroup -Standard | Get-SecurityPolicy | select VirtualPortGroup,ForgedTransmits","Get-VMHost -Name $ESXi | Get-VirtualSwitch -Standard | Get-SecurityPolicy | Set-SecurityPolicy -ForgedTransmits $false 
Get-VMHost -Name $ESXi | Get-VirtualPortGroup -Standard | Get-SecurityPolicy | Set-SecurityPolicy -ForgedTransmitsInherited $true",TRUE,TRUE,ESXI-80-000216,Reject,NO,1.4.3,N/A,N/A,TRUE,,,,,,,
esxi-8.network-reject-mac-changes-standardswitch,VMware vSphere,8,VMware ESXi,8.0.3,Standard Switch,"P0
Upon Feature Enablement",All standard switches and their port groups must be configured to reject guest MAC address changes.,"If the virtual machine operating system changes the MAC address, it can send frames with an impersonated source MAC address, enabling it to stage malicious attacks on devices within a network by impersonating a network adapter authorized by the receiving network. To prevent virtual machines from changing their effective MAC address, measures should be taken to enforce MAC address stability or restrict the ability to modify MAC addresses. This helps mitigate the risk of MAC impersonation and potential malicious activities.",N/A,Accept,Reject,NO,Modify,Virtual Switch Settings,"Some workloads, such as clustered applications, network devices/functions, applications licensed by MAC address, and vCenter Server Reduced Downtime Upgrade, rely on these techniques as a normal part of their operation. If necessary, it is recommended to create a separate port group that allows this behavior, with only authorized virtual machines connected to it.","Get-VMHost -Name $ESXi | Get-VirtualSwitch -Standard | Get-SecurityPolicy | select VirtualSwitch,MacChanges
Get-VMHost -Name $ESXi | Get-VirtualPortGroup -Standard | Get-SecurityPolicy | select VirtualPortGroup,MacChanges","Get-VMHost -Name $ESXi | Get-VirtualSwitch -Standard | Get-SecurityPolicy | Set-SecurityPolicy -MacChanges $false
Get-VMHost -Name $ESXi | Get-VirtualPortGroup -Standard | Get-SecurityPolicy | Set-SecurityPolicy -MacChangesInherited $true",TRUE,TRUE,ESXI-80-000217,Reject,NO,1.4.3,N/A,N/A,TRUE,,,,,,,
esxi-8.network-reject-promiscuous-mode-standardswitch,VMware vSphere,8,VMware ESXi,8.0.3,Standard Switch,"P0
Upon Feature Enablement",All standard switches and their port groups must be configured to reject guest promiscuous mode requests.,"When promiscuous mode is enabled for a port group, all virtual machines connected to that port group have the potential to read all packets transmitted across that port group, regardless of the intended recipient.

It is important to consider the potential impact and design considerations before changing the default value of promiscuous mode.",N/A,Reject,Reject,YES,Audit,Virtual Switch Settings,"Certain workloads and types of work, such as DHCP servers, network devices, and security monitoring, incorporate these techniques as a regular part of their operation. If necessary, it is advisable to create a distinct port group that allows this behavior, ensuring that only authorized virtual machines are associated with it.","Get-VMHost -Name $ESXi | Get-VirtualSwitch -Standard | Get-SecurityPolicy | select VirtualSwitch,AllowPromiscuous
Get-VMHost -Name $ESXi | Get-VirtualPortGroup -Standard | Get-SecurityPolicy | select VirtualPortGroup,AllowPromiscuous","Get-VMHost -Name $ESXi | Get-VirtualSwitch -Standard | Get-SecurityPolicy | Set-SecurityPolicy -AllowPromiscuous $false
Get-VMHost -Name $ESXi | Get-VirtualPortGroup -Standard | Get-SecurityPolicy | Set-SecurityPolicy -AllowPromiscuousInherited $true",TRUE,TRUE,ESXI-80-000218,Reject,NO,1.4.5,N/A,N/A,TRUE,,,,,,,
esxi-8.network-vgt,VMware vSphere,8,VMware ESXi,8.0.3,Base,P2,The ESXi host must restrict the use of Virtual Guest Tagging (VGT) on Standard Switches.,"When a port group is set to VLAN 4095, the vSwitch passes all network frames to the attached virtual machines (VMs) without modifying the VLAN tags. In vSphere, this is referred to as VGT. The VM must process the VLAN information itself via an 802.1Q driver in the operating system.

VLAN 4095 must only be implemented if the attached VMs have been specifically authorized and are capable of managing VLAN tags themselves. If VLAN 4095 is enabled inappropriately, it may cause denial of service or allow a VM to interact with traffic on an unauthorized VLAN.",N/A,Not VLAN 4095,Not VLAN 4095,YES,Audit,ESXi Port Group Configuration,None,"Get-VMHost -Name $ESXi | Get-VirtualPortGroup -Standard | select Name,VlanID","Get-VMHost -Name $ESXi | Get-VirtualPortGroup -Standard -Name $PG| Set-VirtualPortGroup -VlanID ""<new VLAN>""",TRUE,FALSE,ESXI-80-000220,Not VLAN 4095,NO,N/A,N/A,N/A,TRUE,,,,,,,
esxi-8.secureboot,VMware vSphere,8,VMware ESXi,8.0.3,Base,P0,The ESXi host must enable Secure Boot.,"Secure Boot is part of the UEFI firmware standard. With UEFI Secure Boot enabled, a host refuses to load any UEFI driver or app unless the operating system bootloader has a valid digital signature. Secure Boot for ESXi requires support from the firmware and it requires that all ESXi kernel modules, drivers, and VIBs be signed by VMware or a partner subordinate. Secure Boot is enabled in the BIOS of the ESXi physical server and supported by the hypervisor boot loader.",N/A,False,True,NO,Modify,ESXi Shell,"Use of UEFI Secure Boot will interfere with %firstboot stanzas in automated ESXi installations, as that script is not properly signed. Workarounds include moving the configuration to external post-install scripts, or enabling Secure Boot after the installation is complete (which can often be automated on server platforms using out-of-band management controller APIs).","(Get-VMHost -Name $ESXi | Get-View).Capability.UefiSecureBoot

This check is available beginning with PowerCLI 13.3.",N/A (Enable in hardware firmware settings),TRUE,FALSE,ESXI-80-000094,TRUE,NO,5.2.3,N/A,N/A,TRUE,,,,,,,
esxi-8.secureboot-enforcement,VMware vSphere,8,VMware ESXi,8.0.3,Base,P0,The ESXi host must enable TPM-based Secure Boot enforcement.,"The TPM-based nature of VMware ESXi Secure Boot Enforcement enhances security beyond standard Secure Boot. It uses a hardware TPM chip to store and verify cryptographic measurements of the entire boot process, from UEFI firmware to the ESXi kernel. This creates a hardware-backed root of trust, making it much harder for attackers to tamper with the boot sequence undetected. Unlike normal Secure Boot, which only checks digital signatures, TPM-based enforcement ensures the integrity of the complete boot chain and enables advanced features like remote attestation for verifying host trustworthiness. This control flips ESXi from merely supporting Secure Boot to requiring it. Without this setting enabled, and configuration encryption, an ESXi host could be subject to offline attacks. An attacker could simply transfer the ESXi install drive to a non-Secure Boot host and boot it up without ESXi complaining.",N/A,False,True,NO,Modify,ESXi Shell,Use of UEFI Secure Boot and TPM-enforced Configuration Encryption render traditional root password recovery efforts unusable. Ensure that you do not lose access to administrator accounts on ESXi.,"$ESXcli = Get-EsxCli -VMHost $ESXi -V2
$ESXcli.system.settings.encryption.get.Invoke() | Select RequireSecureBoot","$ESXcli = Get-EsxCli -VMHost $ESXi -V2
$arguments = $ESXcli.system.settings.encryption.set.CreateArgs()
$arguments.requiresecureboot = $true
$ESXcli.system.settings.encryption.set.Invoke($arguments)",TRUE,TRUE,ESXI-80-000085,TRUE,NO,5.2.3,N/A,N/A,TRUE,,,,,,,
esxi-8.shell-interactive-timeout,VMware vSphere,8,VMware ESXi,8.0.3,Base,P0,Configure the inactivity timeout to automatically terminate idle ESXi host shells.,"If a user forgets to log out of their SSH session, the idle connection will remain open indefinitely, increasing the potential for someone to gain privileged access to the host.",UserVars.ESXiShellInteractiveTimeOut,0,900,NO,Modify,"ESXi Advanced
System Settings",None,Get-VMHost -Name $ESXi | Get-AdvancedSetting UserVars.ESXiShellInteractiveTimeOut,Get-VMHost -Name $ESXi | Get-AdvancedSetting UserVars.ESXiShellInteractiveTimeOut | Set-AdvancedSetting -Value 900,TRUE,TRUE,ESXI-80-000068,900,NO,8.2.8,15 minutes,NO,TRUE,,,,,,,
esxi-8.shell-timeout,VMware vSphere,8,VMware ESXi,8.0.3,Base,P0,Set a timeout to limit how long the ESXi Shell and SSH services are allowed to run.,The ESXiShellTimeOut defines a window of time after which the ESXi Shell and SSH services will automatically be terminated.,UserVars.ESXiShellTimeOut,0,600,NO,Modify,"ESXi Advanced
System Settings",None,Get-VMHost -Name $ESXi | Get-AdvancedSetting UserVars.ESXiShellTimeOut,Get-VMHost -Name $ESXi | Get-AdvancedSetting UserVars.ESXiShellTimeOut | Set-AdvancedSetting -Value 600,TRUE,TRUE,ESXI-80-000195,600,NO,8.2.8,15 minutes,NO,TRUE,,,,,,,
esxi-8.shell-warning,VMware vSphere,8,VMware ESXi,8.0.3,Base,P2,The ESXi host must not suppress warnings that the ESXi shell is enabled.,"Warnings indicating that SSH or the ESXi Shell is enabled can be clues that an attack is in progress. It is important to ensure that SSH and the ESXi Shell are deactivated, and that this variable is not set.",UserVars.SuppressShellWarning,0,0,YES,Audit,"ESXi Advanced
System Settings",None,Get-VMHost -Name $ESXi | Get-AdvancedSetting UserVars.SuppressShellWarning,Get-VMHost -Name $ESXi | Get-AdvancedSetting UserVars.SuppressShellWarning | Set-AdvancedSetting -Value 0,TRUE,TRUE,ESXI-80-000222,0,NO,N/A,N/A,N/A,TRUE,,,,,,,
esxi-8.ssh-fips,VMware vSphere,8,VMware ESXi,8.0.3,SSH,"P2
Upon Feature Enablement",The ESXi host SSH daemon must use FIPS 140-2/140-3 validated cryptographic modules.,"OpenSSH on the ESXi host ships with a FIPS 140-2/140-3 validated cryptographic module, and it is enabled by default. For backward compatibility reasons, this can be deactivated. Therefore, this setting must be audited and corrected if necessary.",N/A,TRUE,TRUE,YES,Audit,ESXi Shell,None,"$ESXcli = Get-EsxCli -VMHost $ESXi -V2
$ESXcli.system.security.fips140.ssh.get.Invoke()","$ESXcli = Get-EsxCli -VMHost $ESXi -V2
$arguments = $ESXcli.system.security.fips140.ssh.set.CreateArgs()
$arguments.enable = $true
$ESXcli.system.security.fips140.ssh.set.Invoke($arguments)",TRUE,TRUE,ESXI-80-000014,TRUE,NO,"2.2.7
8.3.2",N/A,N/A,TRUE,,,,,,,
esxi-8.ssh-fips-ciphers,VMware vSphere,8,VMware ESXi,8.0.3,SSH,"P2
Upon Feature Enablement",The ESXi host Secure Shell (SSH) daemon must be configured to only use FIPS 140-2/140-3 validated ciphers.,System services must be hardened and secured when enabled.,N/A,"aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr","aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr",YES,Audit,esxcli,None,"$ESXcli = Get-EsxCli -VMHost $ESXi -V2
$ESXcli.system.ssh.server.config.list.invoke() | Where-Object {$_.Key -eq 'ciphers'} | Select-Object -ExpandProperty Value","$ESXcli = Get-EsxCli -VMHost $ESXi -V2
$arguments = $ESXcli.system.ssh.server.config.set.CreateArgs()
$arguments.keyword = 'ciphers'
$arguments.value = 'aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr'
$ESXcli.system.ssh.server.config.set.Invoke($arguments)",TRUE,TRUE,ESXI-80-000187,"aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr",NO,"2.2.7
8.3.2",N/A,N/A,TRUE,,,,,,,
esxi-8.ssh-gateway-ports,VMware vSphere,8,VMware ESXi,8.0.3,SSH,"P2
Upon Feature Enablement",The ESXi host Secure Shell (SSH) daemon must be configured to not allow gateway ports.,System services must be hardened and secured when enabled.,N/A,no,no,YES,Audit,esxcli,None,"$ESXcli = Get-EsxCli -VMHost $ESXi -V2
$ESXcli.system.ssh.server.config.list.invoke() | Where-Object {$_.Key -eq 'gatewayports'} | Select-Object -ExpandProperty Value","$ESXcli = Get-EsxCli -VMHost $ESXi -V2
$arguments = $ESXcli.system.ssh.server.config.set.CreateArgs()
$arguments.keyword = 'gatewayports'
$arguments.value = 'no'
$ESXcli.system.ssh.server.config.set.Invoke($arguments)",TRUE,TRUE,ESXI-80-000207,no,NO,N/A,N/A,N/A,TRUE,,,,,,,
esxi-8.ssh-host-based-auth,VMware vSphere,8,VMware ESXi,8.0.3,SSH,"P2
Upon Feature Enablement",The ESXi host Secure Shell (SSH) daemon must not allow host-based authentication.,System services must be hardened and secured when enabled.,N/A,no,no,YES,Audit,esxcli,None,"$ESXcli = Get-EsxCli -VMHost $ESXi -V2
$ESXcli.system.ssh.server.config.list.invoke() | Where-Object {$_.Key -eq 'hostbasedauthentication'} | Select-Object -ExpandProperty Value","$ESXcli = Get-EsxCli -VMHost $ESXi -V2
$arguments = $ESXcli.system.ssh.server.config.set.CreateArgs()
$arguments.keyword = 'hostbasedauthentication'
$arguments.value = 'no'
$ESXcli.system.ssh.server.config.set.Invoke($arguments)",TRUE,TRUE,ESXI-80-000202,no,NO,N/A,N/A,N/A,TRUE,,,,,,,
esxi-8.ssh-idle-timeout-count,VMware vSphere,8,VMware ESXi,8.0.3,SSH,"P2
Upon Feature Enablement",The ESXi host Secure Shell (SSH) daemon must set a timeout count on idle sessions.,"System services must be hardened and secured when enabled. The timeout count, multiplied by the idle timeout interval, is the total number of seconds the session may be idle until it is disconnected.",N/A,3,3,YES,Audit,esxcli,None,"$ESXcli = Get-EsxCli -VMHost $ESXi -V2
$ESXcli.system.ssh.server.config.list.invoke() | Where-Object {$_.Key -eq 'clientalivecountmax'} | Select-Object -ExpandProperty Value","$ESXcli = Get-EsxCli -VMHost $ESXi -V2
$arguments = $ESXcli.system.ssh.server.config.set.CreateArgs()
$arguments.keyword = 'clientalivecountmax'
$arguments.value = '3'
$ESXcli.system.ssh.server.config.set.Invoke($arguments)",TRUE,TRUE,ESXI-80-000210,3,NO,8.2.8,15 minutes,NO,TRUE,,,,,,,
esxi-8.ssh-idle-timeout-interval,VMware vSphere,8,VMware ESXi,8.0.3,SSH,"P2
Upon Feature Enablement",The ESXi host Secure Shell (SSH) daemon must set a timeout interval on idle sessions.,"System services must be hardened and secured when enabled. The timeout count, multiplied by the idle timeout interval, is the total number of seconds the session may be idle until it is disconnected.",N/A,200,200,YES,Audit,esxcli,None,"$ESXcli = Get-EsxCli -VMHost $ESXi -V2
$ESXcli.system.ssh.server.config.list.invoke() | Where-Object {$_.Key -eq 'clientaliveinterval'} | Select-Object -ExpandProperty Value","$ESXcli = Get-EsxCli -VMHost $ESXi -V2
$arguments = $ESXcli.system.ssh.server.config.set.CreateArgs()
$arguments.keyword = 'clientaliveinterval'
$arguments.value = '200'
$ESXcli.system.ssh.server.config.set.Invoke($arguments)",TRUE,TRUE,ESXI-80-000211,200,NO,8.2.8,15 minutes,NO,TRUE,,,,,,,
esxi-8.ssh-login-banner,VMware vSphere,8,VMware ESXi,8.0.3,SSH,"P2
Upon Feature Enablement",The ESXi host Secure Shell (SSH) daemon must display the system login banner before granting access to the system.,"System services must be hardened and secured when enabled. You must set the host's Config.Etc.Issue advanced parameter as well, to provide text to this banner.",N/A,/etc/issue,/etc/issue,YES,Audit,esxcli,None,"$ESXcli = Get-EsxCli -VMHost $ESXi -V2
$ESXcli.system.ssh.server.config.list.invoke() | Where-Object {$_.Key -eq 'banner'} | Select-Object -ExpandProperty Value","$ESXcli = Get-EsxCli -VMHost $ESXi -V2
$arguments = $ESXcli.system.ssh.server.config.set.CreateArgs()
$arguments.keyword = 'banner'
$arguments.value = '/etc/issue'
$ESXcli.system.ssh.server.config.set.Invoke($arguments)",TRUE,TRUE,ESXI-80-000192,/etc/issue,NO,N/A,N/A,N/A,TRUE,,,,,,,
esxi-8.ssh-rhosts,VMware vSphere,8,VMware ESXi,8.0.3,SSH,"P2
Upon Feature Enablement",The ESXi host Secure Shell (SSH) daemon must ignore .rhosts files.,System services must be hardened and secured when enabled.,N/A,yes,yes,YES,Audit,esxcli,None,"$ESXcli = Get-EsxCli -VMHost $ESXi -V2
$ESXcli.system.ssh.server.config.list.invoke() | Where-Object {$_.Key -eq 'ignorerhosts'} | Select-Object -ExpandProperty Value","$ESXcli = Get-EsxCli -VMHost $ESXi -V2
$arguments = $ESXcli.system.ssh.server.config.set.CreateArgs()
$arguments.keyword = 'ignorerhosts'
$arguments.value = 'yes'
$ESXcli.system.ssh.server.config.set.Invoke($arguments)",TRUE,TRUE,ESXI-80-000052,yes,NO,N/A,N/A,N/A,TRUE,,,,,,,
esxi-8.ssh-stream-local-forwarding,VMware vSphere,8,VMware ESXi,8.0.3,SSH,"P2
Upon Feature Enablement",The ESXi host Secure Shell (SSH) daemon must disable stream local forwarding.,System services must be hardened and secured when enabled.,N/A,no,no,YES,Audit,esxcli,None,"$ESXcli = Get-EsxCli -VMHost $ESXi -V2
$ESXcli.system.ssh.server.config.list.invoke() | Where-Object {$_.Key -eq 'allowstreamlocalforwarding'} | Select-Object -ExpandProperty Value","$ESXcli = Get-EsxCli -VMHost $ESXi -V2
$arguments = $ESXcli.system.ssh.server.config.set.CreateArgs()
$arguments.keyword = 'allowstreamlocalforwarding'
$arguments.value = 'no'
$ESXcli.system.ssh.server.config.set.Invoke($arguments)",TRUE,TRUE,N/A,N/A,N/A,N/A,N/A,N/A,TRUE,,,,,,,
esxi-8.ssh-tcp-forwarding,VMware vSphere,8,VMware ESXi,8.0.3,SSH,"P2
Upon Feature Enablement",The ESXi host Secure Shell (SSH) daemon must disable TCP forwarding.,System services must be hardened and secured when enabled.,N/A,no,no,YES,Audit,esxcli,None,"$ESXcli = Get-EsxCli -VMHost $ESXi -V2
$ESXcli.system.ssh.server.config.list.invoke() | Where-Object {$_.Key -eq 'allowtcpforwarding'} | Select-Object -ExpandProperty Value","$ESXcli = Get-EsxCli -VMHost $ESXi -V2
$arguments = $ESXcli.system.ssh.server.config.set.CreateArgs()
$arguments.keyword = 'allowtcpforwarding'
$arguments.value = 'no'
$ESXcli.system.ssh.server.config.set.Invoke($arguments)",TRUE,TRUE,ESXI-80-000230,no,NO,N/A,N/A,N/A,TRUE,,,,,,,
esxi-8.ssh-tunnels,VMware vSphere,8,VMware ESXi,8.0.3,SSH,"P2
Upon Feature Enablement",The ESXi host Secure Shell (SSH) daemon must not permit tunnels.,System services must be hardened and secured when enabled.,N/A,no,no,YES,Audit,esxcli,None,"$ESXcli = Get-EsxCli -VMHost $ESXi -V2
$ESXcli.system.ssh.server.config.list.invoke() | Where-Object {$_.Key -eq 'permittunnel'} | Select-Object -ExpandProperty Value","$ESXcli = Get-EsxCli -VMHost $ESXi -V2
$arguments = $ESXcli.system.ssh.server.config.set.CreateArgs()
$arguments.keyword = 'permittunnel'
$arguments.value = 'no'
$ESXcli.system.ssh.server.config.set.Invoke($arguments)",TRUE,TRUE,ESXI-80-000209,no,NO,N/A,N/A,N/A,TRUE,,,,,,,
esxi-8.ssh-user-environment,VMware vSphere,8,VMware ESXi,8.0.3,SSH,"P2
Upon Feature Enablement",The ESXi host Secure Shell (SSH) daemon must not permit user environment settings.,System services must be hardened and secured when enabled.,N/A,no,no,YES,Audit,esxcli,None,"$ESXcli = Get-EsxCli -VMHost $ESXi -V2
$ESXcli.system.ssh.server.config.list.invoke() | Where-Object {$_.Key -eq 'permituserenvironment'} | Select-Object -ExpandProperty Value","$ESXcli = Get-EsxCli -VMHost $ESXi -V2
$arguments = $ESXcli.system.ssh.server.config.set.CreateArgs()
$arguments.keyword = 'permituserenvironment'
$arguments.value = 'no'
$ESXcli.system.ssh.server.config.set.Invoke($arguments)",TRUE,TRUE,ESXI-80-000204,no,NO,N/A,N/A,N/A,TRUE,,,,,,,
esxi-8.supported,VMware vSphere,8,VMware ESXi,8.0.3,Base,P0,ESXi host is running software that has not reached End of General Support status.,Ensure that ESXi is a version that has not reached the End of General Support status.,N/A,N/A,N/A,YES,Audit,Compare ESXi build numbers to latest available version on customerconnect.vmware.com,"Always read release notes, test, and deploy using staged rollouts.","Get-VMHost -Name $ESXi | Select-Object Name,Version,Build",N/A,FALSE,FALSE,ESXI-80-000221,N/A,NO,6.3.3,N/A,N/A,TRUE,,,,,,,
esxi-8.timekeeping-services,VMware vSphere,8,VMware ESXi,8.0.3,Base,P0,ESXi host must have time synchronization services enabled and running.,"Cryptography, audit logging, cluster operations, and incident response/forensics heavily rely on synchronized time. To ensure this, NTP and/or PTP services must be set to start with the host and must be running.",N/A,"Stopped,
Start and stop manually","Running,
Start and stop with host",NO,Modify,ESXi Services Configuration,None,"Get-VMHostService -VMHost $ESXi | Where-Object{$_.Key -eq ""ntpd""}","Get-VMHostService -VMHost $ESXi -ErrorAction:Stop | Where-Object{$_.Key -eq ""ntpd""} | Set-VMHostService -policy ""on"" -Confirm:$false
Get-VMHostService -VMHost $ESXi -ErrorAction:Stop | Where-Object{$_.Key -eq ""ntpd""} | Restart-VMHostService -Confirm:$false",TRUE,TRUE,ESXI-80-000124,"Running,
Start and stop with host",NO,10.6.1,N/A,N/A,TRUE,,,,,,,
esxi-8.timekeeping-sources,VMware vSphere,8,VMware ESXi,8.0.3,Base,P0,ESXi host must have reliable time synchronization sources.,"Cryptography, audit logging, cluster operations, and incident response/forensics heavily rely on synchronized time. The recommended practice for NTP is to have at least four sources. It is not advisable to have only two sources, as having one source is preferable to having two.

Precision Time Protocol (PTP) is an alternative to NTP that offers sub-millisecond time accuracy. PTP has a different architecture compared to NTP and may not provide the same level of resilience in case of primary server failure. It is suggested to configure NTP as a backup source for PTP, ensuring that a time source remains available even if the accuracy is reduced.",N/A,Undefined,"Site-Specific or:
0.vmware.pool.ntp.org,
1.vmware.pool.ntp.org,
2.vmware.pool.ntp.org,
3.vmware.pool.ntp.org",NO,Modify,ESXi Time Configuration,None,Get-VMHostNtpServer -VMHost $ESXi,"$ntp0 = ""0.vmware.pool.ntp.org""
$ntp1 = ""1.vmware.pool.ntp.org""
$ntp2 = ""2.vmware.pool.ntp.org""
$ntp3 = ""3.vmware.pool.ntp.org""

Add-VMHostNTPServer -NtpServer $ntp0 , $ntp1 , $ntp2 , $ntp3 -VMHost $ESXi -Confirm:$false",TRUE,TRUE,ESXI-80-000124,"Site-Specific or:
0.vmware.pool.ntp.org,
1.vmware.pool.ntp.org,
2.vmware.pool.ntp.org,
3.vmware.pool.ntp.org",NO,"10.6.1
10.6.2",N/A,N/A,TRUE,,,,,,,
esxi-8.tls-profile,VMware vSphere,8,VMware ESXi,8.0.3,Base,P0,The ESXi host must maintain confidentiality and integrity of transmissions by enabling modern TLS ciphers.,"In ESXi 8.0.3 and newer, TLS profiles are available to configure client and server TLS settings to use only strong ciphers.

You can view the entire cipher list and suites using:

$ESXcli = Get-EsxCli -VMHost $ESXi -V2
$arguments = $ESXcli.system.tls.server.get.CreateArgs()
$arguments.showprofiledefaults = $true
$arguments.showcurrentbootprofile = $true
$ESXcli.system.tls.server.get.invoke($arguments)

The host will require a reboot after setting this parameter (and will display in the vSphere Client with the suffix of ""(Reboot Required).""",N/A,COMPATIBLE,NIST_2024,NO,Modify,esxcli,Changes to cipher suites impact connectivity with external systems. The host will need to be rebooted for this change to take effect.,"$ESXcli = Get-EsxCli -VMHost $ESXi -V2
$ESXcli.system.tls.server.get.invoke() | Select-Object -ExpandProperty Profile","$ESXcli = Get-EsxCli -VMHost $ESXi -V2
$arguments = $ESXcli.system.tls.server.set.CreateArgs()
$arguments.profile = ""NIST_2024""
$ESXcli.system.tls.server.set.invoke($arguments)",TRUE,TRUE,ESXI-80-000247,NIST_2024,NO,"2.2.7
4.2.1
8.3.2",N/A,N/A,TRUE,,,,,,,
esxi-8.tls-protocols,VMware vSphere,8,VMware ESXi,8.0.3,Base,P2,The ESXi host must enable the highest version of TLS supported.,"ESXi 8 ships with TLS 1.2 enabled by default, but it is possible to re-enable other protocols if necessary.",UserVars.ESXiVPsDisabledProtocols,"""sslv3,tlsv1,tlsv1.1""","""sslv3,tlsv1,tlsv1.1""",YES,Audit,"ESXi Advanced
System Settings",None,Get-VMHost -Name $ESXi | Get-AdvancedSetting UserVars.ESXiVPsDisabledProtocols,"Get-VMHost -Name $ESXi | Get-AdvancedSetting UserVars.ESXiVPsDisabledProtocols | Set-AdvancedSetting -Value ""sslv3,tlsv1,tlsv1.1""",TRUE,TRUE,ESXI-80-000161,"sslv3,tlsv1,tlsv1.1",NO,"2.2.7
4.2.1
8.3.2",N/A,N/A,TRUE,,,,,,,
esxi-8.tpm-configuration,VMware vSphere,8,VMware ESXi,8.0.3,TPM,"P2
Upon Feature Enablement",The ESXi host must require TPM-based configuration encryption.,"An ESXi host's configuration consists of configuration files for each service that runs on the host. The configuration files typically reside in the /etc/ directory, but they can also reside in other namespaces. The configuration files contain run-time information about the state of the services. Over time, the default values in the configuration files might change, for example, when settings on the ESXi host are changed.

A cron job backs up the ESXi configuration files periodically, when ESXi shuts down gracefully or on demand, and creates an archived configuration file in the boot bank. When ESXi reboots, it reads the archived configuration file and recreates the state that ESXi was in when the backup was taken.

Before vSphere 7.0 Update 2, the archived ESXi configuration file is not encrypted. In vSphere 7.0 Update 2 and later, the archived configuration file is encrypted. When the ESXi host is configured with a Trusted Platform Module (TPM), the TPM is used to ""seal"" the configuration to the host, providing a strong security guarantee and additional protection from offline attacks.

Configuration encryption uses the physical TPM when it is available and supported at install or upgrade time. If the TPM was added or enabled later, the ESXi host must be told to reconfigure to use the newly available TPM. Once the TPM configuration encryption is enabled, it cannot be deactivated.",N/A,Site-Specific,TPM,YES,Audit,ESXi Shell,Use of Secure Boot and TPM-enforced Configuration Encryption render traditional root password recovery efforts unusable. Ensure that you do not lose access to administrator accounts on ESXi.,"$ESXcli = Get-EsxCli -VMHost $ESXi -V2
$ESXcli.system.settings.encryption.get.Invoke() | Select Mode","$ESXcli = Get-EsxCli -VMHost $ESXi -V2
$arguments = $ESXcli.system.settings.encryption.set.CreateArgs()
$arguments.mode = ""TPM""
$ESXcli.system.settings.encryption.set.Invoke($arguments)",TRUE,TRUE,ESXI-80-000238,TPM,NO,5.2.3,N/A,N/A,TRUE,,,,,,,
esxi-8.transparent-page-sharing,VMware vSphere,8,VMware ESXi,8.0.3,Base,P2,The ESXi host must restrict inter-VM transparent page sharing to VMs configured with sched.mem.pshare.salt.,"Transparent Page Sharing (TPS) is a method used to reduce the memory usage of virtual machines. However, under specific conditions, it can potentially be exploited to gain unauthorized access to data on neighboring virtual machines.

Virtual machines that do not have the sched.mem.pshare.salt option set are unable to share memory with any other virtual machines, providing an additional layer of isolation and security.",Mem.ShareForceSalting,2,2,YES,Audit,"ESXi Advanced
System Settings",None,Get-VMHost -Name $ESXi | Get-AdvancedSetting Mem.ShareForceSalting,Get-VMHost -Name $ESXi | Get-AdvancedSetting Mem.ShareForceSalting | Set-AdvancedSetting -Value 2,TRUE,TRUE,ESXI-80-000213,2,NO,N/A,N/A,N/A,TRUE,,,,,,,
esxi-8.updates,VMware vSphere,8,VMware ESXi,8.0.3,Base,P0,ESXi host has all software updates installed.,"By keeping ESXi patches up to date, vulnerabilities in the hypervisor can be mitigated. It is important to note that educated attackers can exploit known vulnerabilities when attempting to gain unauthorized access or elevate privileges on an ESXi host.

When applying updates, it is recommended to update vCenter Server first, if an update is available, and then proceed with updating ESXi. This sequence ensures that the management layer is updated before updating the ESXi hosts.",N/A,Downlevel,Current,NO,Modify,Compare ESXi build numbers to latest available version on customerconnect.vmware.com,vSphere Update releases add and change functionality; Patch releases only resolve issues.,"Get-VMHost -Name $ESXi | Select-Object Name,Version,Build",N/A,FALSE,FALSE,ESXI-80-000221,Current,NO,6.3.3,N/A,N/A,TRUE,,,,,,,
esxi-8.vib-acceptance-level-supported,VMware vSphere,8,VMware ESXi,8.0.3,Base,P2,The ESXi host image profile acceptance level must be PartnerSupported or higher.,"The acceptance level in ESXi controls what can be installed on the system. There are four levels: VMwareCertified, VMwareAccepted, PartnerSupported, and CommunitySupported.

It is important to note that CommunitySupported VIBs (vSphere Installation Bundles) have not undergone testing by VMware or a VMware partner, and they do not have a digital signature. It is considered risky to install CommunitySupported VIBs as their reliability and security cannot be guaranteed.",N/A,PartnerSupported,PartnerSupported or Higher,YES,Audit,ESXi Security Profile,CommunitySupported packages are unsigned and will not be able to be installed.,(Get-EsxCli -VMHost $ESXi -V2).software.acceptance.get.Invoke(),"$ESXcli = Get-EsxCli -VMHost $ESXi -V2
$arguments = $ESXcli.software.acceptance.set.CreateArgs()
$arguments.level = ""PartnerSupported"" # VMwareCertified, VMwareAccepted, PartnerSupported, CommunitySupported
$ESXcli.software.acceptance.set.Invoke($arguments)",TRUE,TRUE,ESXI-80-000133,PartnerSupported or Higher,NO,5.2.3,N/A,N/A,TRUE,,,,,,,
esxi-8.vib-trusted-binaries,VMware vSphere,8,VMware ESXi,8.0.3,Base,P0,Only run binaries delivered via signed VIB.,"ESXi conducts integrity checks of ""vSphere Installable Bundles"" or VIBs, governed by the Acceptance Level (see below). Instructing ESXi to only execute binaries that originated from a valid VIB installed on the host makes it harder for attackers to use prebuilt toolkits.",VMkernel.Boot.execInstalledOnly,False,True,NO,Modify,"ESXi Advanced
System Settings",Third-party unsigned software may not install or execute.,Get-VMHost -Name $ESXi | Get-AdvancedSetting VMkernel.Boot.execInstalledOnly,Get-VMHost -Name $ESXi | Get-AdvancedSetting VMkernel.Boot.execInstalledOnly | Set-AdvancedSetting -Value True,TRUE,TRUE,ESXI-80-000244,True,NO,5.2.3,N/A,N/A,TRUE,,,,,,,
esxi-8.vmk-management,VMware vSphere,8,VMware ESXi,8.0.3,Base,P2,The ESXi host must isolate management communications.,"VMkernel network interfaces that are intended for specialized use can be configured with management capabilities, which may defeat network isolation and security efforts. Ensure that only vmk interfaces intended for management have management services enabled.",N/A,Site-Specific,Site-Specific,YES,Audit,ESXi VMkernel Adapters,Some third-party managed solutions may require this.,"Get-VMHostNetworkAdapter -VMHost $ESXi -VMKernel | Select VMHost,Name,IP,ManagementTrafficEnabled",Get-VMHostNetworkAdapter -VMHost $ESXi -Name $vmkernel_interface | Set-VMHostNetworkAdapter -ManagementTrafficEnabled $false,TRUE,FALSE,ESXI-80-000198,Site-Specific,NO,N/A,N/A,N/A,TRUE,,,,,,,
guest-8.secure-boot,VMware vSphere,8,VMware ESXi,8.0.3,Virtual Machine,P0,The guest OS must enable Secure Boot.,"Secure Boot, supported by all modern guest OSes, uses public key cryptography to validate firmware, boot loader, drivers, and OS kernel. By preventing system booting with uncertain boot chain validity, it effectively restricts malware.",N/A,Site-Specific,TRUE,NO,Modify,VM Settings,Enabling this after guest OS install may involve more process than just checking the box. Refer to your guest OS documentation for instructions.,(Get-VM -Name $VM).ExtensionData.Config.BootOptions.EfiSecureBootEnabled ,"$VMobj = (Get-VM -Name $VM)
$ConfigSpec = New-Object VMware.Vim.VirtualMachineConfigSpec
$bootOptions = New-Object VMware.Vim.VirtualMachineBootOptions
$bootOptions.EfiSecureBootEnabled = $true
$ConfigSpec.BootOptions = $bootOptions
$task = $VMobj.ExtensionData.ReconfigVM_Task($ConfigSpec)",TRUE,FALSE,N/A,N/A,N/A,5.2.3,N/A,N/A,TRUE,,,,,,,
guest-8.tools-add-feature,VMware vSphere,8,VMware ESXi,8.0.3,VMware Tools,P0,The guest OS must limit the automatic addition of VMware Tools features.,"VMware Tools automatic upgrade processes can add or remove features from the VMware Tools installation, which can be helpful but also presents an opportunity to alter the security profile of the guest OS from vSphere.",autoupgrade allow-add-feature,true,false,NO,Modify,tools.conf,Administrators will need to use other methods to update and reconfigure VMware Tools when needed.,C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config get autoupgrade allow-add-feature,C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config set autoupgrade allow-add-feature false,FALSE,FALSE,N/A,N/A,N/A,N/A,N/A,N/A,TRUE,,,,,,,
guest-8.tools-allow-transforms,VMware vSphere,8,VMware ESXi,8.0.3,VMware Tools,P2,The guest OS must limit the use of MSI transforms when reconfiguring VMware Tools.,MSI transforms allow the installation database on Microsoft Windows guest OSes to be changed. This can be helpful but also presents an opportunity to alter the security profile of the guest OS from vSphere.,autoupgrade allow-msi-transforms,false,false,YES,Audit,tools.conf,Administrators will need to use other methods to update and reconfigure VMware Tools when needed.,C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config get autoupgrade allow-msi-transforms,C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config set autoupgrade allow-msi-transforms false,FALSE,FALSE,N/A,N/A,N/A,N/A,N/A,N/A,TRUE,,,,,,,
guest-8.tools-deactivate-appinfo,VMware vSphere,8,VMware ESXi,8.0.3,VMware Tools,P0,The guest OS must deactivate Appinfo information gathering unless required.,Appinfo is a method to do application discovery through VMware Tools. If you are not using this tool deactivate the module to reduce attack surface.,appinfo disabled,false,true,NO,Modify,tools.conf,Products and services within the VMware ecosystem may require this functionality.,C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config get appinfo disabled,C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config set appinfo disabled true,FALSE,FALSE,N/A,N/A,N/A,1.4.5,N/A,N/A,TRUE,,,,,,,
guest-8.tools-deactivate-containerinfo,VMware vSphere,8,VMware ESXi,8.0.3,VMware Tools,P0,The guest OS must deactivate ContainerInfo unless required.,The VMware Tools ContainerInfo plugin for Linux gathers the list of running containers inside a Linux guest operating system.,containerinfo poll-interval,21600,0,NO,Modify,tools.conf,Products and services within the VMware ecosystem may require this functionality.,C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config get containerinfo poll-interval,C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config set containerinfo poll-interval 0,FALSE,FALSE,N/A,N/A,N/A,1.4.5,N/A,N/A,TRUE,,,,,,,
guest-8.tools-deactivate-guestoperations,VMware vSphere,8,VMware ESXi,8.0.3,VMware Tools,Advanced,The guest OS must deactivate Guest Operations unless required.,"Guest Operations are a set of functions that underpin most host-to-guest interaction. Deactivating them reduces attack surface but also drastically reduces functionality. Ensure that your environment does not require these functions. Do not do this on template VMs. For a list of functions see:

https://vdc-download.vmware.com/vmwb-repository/dcr-public/fe08899f-1eec-4d8d-b3bc-a6664c168c2c/7fdf97a1-4c0d-4be0-9d43-2ceebbc174d9/doc/vim.vm.guest.GuestOperationsManager.html",guestoperations disabled,false,true,NO,Modify,tools.conf,Products and services within the VMware ecosystem may require this functionality.,C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config get guestoperations disabled,C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config set guestoperations disabled true,FALSE,FALSE,N/A,N/A,N/A,N/A,N/A,N/A,TRUE,,,,,,,
guest-8.tools-deactivate-gueststoreupgrade,VMware vSphere,8,VMware ESXi,8.0.3,VMware Tools,P0,The guest OS must deactivate Guest Store Upgrade operations unless required.,The GuestStore feature provides a simple and flexible mechanism to distribute VMware specific or custom content from a GuestStore repository to multiple guests simultaneously. If you are not using this feature disable the plugin to reduce attack surface.,gueststoreupgrade policy,manual,off,NO,Modify,tools.conf,Products and services within the VMware ecosystem may require this functionality.,C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config get gueststoreupgrade policy,C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config set gueststoreupgrade policy off,FALSE,FALSE,N/A,N/A,N/A,N/A,N/A,N/A,TRUE,,,,,,,
guest-8.tools-deactivate-servicediscovery,VMware vSphere,8,VMware ESXi,8.0.3,VMware Tools,P0,The guest OS must deactivate Service Discovery unless required.,The VMware Tools Service Discovery plugin connects to Aria Operations and provides additional data to that product about guests and workloads. If you are not using this feature disable the plugin to reduce attack surface.,servicediscovery disabled,false,true,NO,Modify,tools.conf,Products and services within the VMware ecosystem may require this functionality.,C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config get servicediscovery disabled,C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config set servicediscovery disabled true,FALSE,FALSE,N/A,N/A,N/A,1.4.5,N/A,N/A,TRUE,,,,,,,
guest-8.tools-enable-logging,VMware vSphere,8,VMware ESXi,8.0.3,VMware Tools,P2,The guest OS must enable VMware Tools logging.,"Ensure that VMware Tools is logging information as appropriate. Logging in VMware Tools is very customizable, please see the examples in https://github.com/vmware/open-vm-tools/blob/master/open-vm-tools/tools.conf",logging log,true,true,YES,Audit,tools.conf,None,C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config get logging log,C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config set logging log true,FALSE,FALSE,N/A,N/A,N/A,10.2.1,N/A,N/A,TRUE,,,,,,,
guest-8.tools-enable-syslog,VMware vSphere,8,VMware ESXi,8.0.3,VMware Tools,P0,The guest OS must send VMware Tools logs to the system log service.,"By default, VMware Tools sends logs to a file on disk. By setting this parameter it will send them to syslog on Linux guests and the Windows Event Service on Microsoft Windows guests, wherein they can be monitored, managed, and archived centrally.",logging vmsvc.handler,file,syslog,NO,Modify,tools.conf,Processes that rely on these files being in a default location will need to be updated.,"C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config get logging vmsvc.handler
C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config get logging toolboxcmd.handler
C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config get logging vgauthsvc.handler
C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config get logging vmtoolsd.handler","C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config set logging vmsvc.handler syslog
C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config set logging toolboxcmd.handler syslog
C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config set logging vgauthsvc.handler syslog
C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config set logging vmtoolsd.handler syslog",FALSE,FALSE,N/A,N/A,N/A,"10.2.1
10.3.3",N/A,N/A,TRUE,,,,,,,
guest-8.tools-globalconf,VMware vSphere,8,VMware ESXi,8.0.3,VMware Tools,P2,The guest OS must deactivate GlobalConf unless required.,The GlobalConf feature of VMware Tools provides an ability to push tools.conf configurations to virtual machines.,globalconf enabled,false,false,YES,Audit,tools.conf,Administrators will need to use other methods to update and reconfigure VMware Tools when needed.,C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config get globalconf enabled,C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config set globalconf enabled false,FALSE,FALSE,N/A,N/A,N/A,N/A,N/A,N/A,TRUE,,,,,,,
guest-8.tools-prevent-recustomization,VMware vSphere,8,VMware ESXi,8.0.3,VMware Tools,P0,The guest OS on deployed and customized virtual machines must prevent being recustomized.,"The VM deployment process offers many options for vSphere Admins to customize VMs, using scripts and running commands. This can also be an avenue for an adversary to gain access to data inside a VM, by cloning & recustomizing. Once a VM is deployed it should be prevented from being customized again (if you change your mind you can always revert it). Do not do this on template VMs.",deployPkg enable-customization,true,false,NO,Modify,tools.conf,"Once set, VMs will not be able to be customized when they are cloned. Do not set this on template VMs.

This may impact disaster recovery processes that change IP addresses, through VMware Site Recovery Manager or VMware Cloud Disaster Recovery. For more information see: 

https://docs.vmware.com/en/VMware-Cloud-Disaster-Recovery/services/vmware-cloud-disaster-recovery/GUID-94202BE7-FEAF-4E35-8B55-15F6B3798309.html",C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config get deployPkg enable-customization,C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config set deployPkg enable-customization false,FALSE,FALSE,N/A,N/A,N/A,N/A,N/A,N/A,TRUE,,,,,,,
guest-8.tools-remove-feature,VMware vSphere,8,VMware ESXi,8.0.3,VMware Tools,P0,The guest OS must limit the automatic removal of VMware Tools features.,"VMware Tools automatic upgrade processes can add or remove features from the VMware Tools installation, which can be helpful but also presents an opportunity to alter the security profile of the guest OS from vSphere.",autoupgrade allow-remove-feature,true,false,NO,Modify,tools.conf,Administrators will need to use other methods to update and reconfigure VMware Tools when needed.,C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config get autoupgrade allow-remove-feature,C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config set autoupgrade allow-remove-feature false,FALSE,FALSE,N/A,N/A,N/A,N/A,N/A,N/A,TRUE,,,,,,,
guest-8.tools-updates,VMware vSphere,8,VMware ESXi,8.0.3,VMware Tools,P0,The guest OS must ensure that VMware Tools are updated.,"VMware Tools are an important part of the VMware ecosystem, enabling guest OSes to be shut down gracefully, managed throughout their lifecycle, providing drivers for paravirtualized devices, and helping to deploy and customize VMs from templates. Like all other software the VMware Tools need to be managed and updated. Ensure that you are running a supported version for your guest OS, whether it is delivered as part of the Linux distribution or installed by you for Microsoft Windows.",N/A,N/A,N/A,NO,Audit,VM Status,None,"Get-VM -Name $VM | Select-Object -Property Name,@{Name='ToolsVersion';Expression={$_.Guest.ToolsVersion}}","Site-Specific. Multiple ways to update VMware Tools. Drivers for vmxnet3 and pvscsi are also available via Windows Update, please ensure you are importing them into tools such as WSUS.",FALSE,FALSE,N/A,N/A,N/A,6.3.3,N/A,N/A,TRUE,,,,,,,
guest-8.tools-upgrade,VMware vSphere,8,VMware ESXi,8.0.3,VMware Tools,P0,The guest OS must configure automatic VMware Tools upgrades as appropriate for the environment.,"VMware Tools updates can be initiated by vSphere, which can be helpful for maintaining current VMware Tools versions. If VMware Tools is being managed and updated in other ways this functionality should be deactivated. This baseline suggests leaving automatic updates enabled.",autoupgrade allow-upgrade,true,true,YES,Audit,tools.conf,Administrators will need to use other methods to update and reconfigure VMware Tools when needed.,C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config get autoupgrade allow-upgrade,C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe config set autoupgrade allow-upgrade true,FALSE,FALSE,N/A,N/A,N/A,N/A,N/A,N/A,TRUE,,,,,,,
guest-8.virtual-hardware,VMware vSphere,8,VMware ESXi,8.0.3,Virtual Machine,P0,The guest OS must ensure that virtual machine hardware is version 19 or newer where supported.,"Virtual hardware 19 is compatible with ESXi 7.0 Update 2 and later. Newer versions of virtual hardware enable new features and better performance. Consider upgrading to VM Hardware 21 if you are fully updated to vSphere 8. Other VMware guidance urges caution when upgrading; we urge testing of the process. Snapshots capture the virtual hardware version, making testing and rollback easy.

Consider all locations that a virtual machine might run, or need to be restored to.

Changes to the configuration of VMware-supplied virtual appliances are not supported and may cause service disruptions.

This entry is intentionally categorized as ""in-guest"" due to the driver and other updates that will occur when a VM is upgraded, despite the impact being minimal.",N/A,Site-Specific,vmx-21,NO,Modify,VM Compatibility,"Changing VM hardware versions changes device versions inside the guest, which may have repercussions. Test, and remember that snapshots also capture the VM version, too, so it can be reverted.

Changes to the configuration of VMware-supplied virtual appliances are not supported and may cause service disruptions.",(Get-VM -Name $VM | Get-View).Config.Version,Set-VM -Name $VM -HardwareVersion vmx-21,TRUE,TRUE,N/A,N/A,N/A,N/A,N/A,N/A,TRUE,,,,,,,
vcenter-8.administration-client-session-timeout,VMware vSphere,8,VMware vCenter,8.0.3,Base,P0,The vCenter Server must terminate vSphere Client sessions after 15 minutes of inactivity.,"Idle vSphere Client sessions can be left open indefinitely if a user forgets to log out, thereby increasing the risk of unauthorized privileged access.","""Session Timeout""",120 minutes,15 minutes,NO,Modify,vSphere Client Configuration,None,N/A (No public API available),N/A (No public API available),FALSE,FALSE,VCSA-80-000089,15 minutes,NO,8.2.8,15 minutes,NO,TRUE,,,,,,,
vcenter-8.administration-failed-login-interval,VMware vSphere,8,VMware vCenter,8.0.3,Base,P1,The vCenter Server must set the interval for counting failed login attempts to at least 15 minutes.,"By limiting the number of failed login attempts, the risk of unauthorized access via user password guessing, otherwise known as brute-forcing, is reduced.",Time interval between failures,180,900,NO,Modify,vCenter Server SSO Configuration,None,Get-SsoLockoutPolicy | Select FailedAttemptIntervalSec,Get-SsoLockoutPolicy | Set-SsoLockoutPolicy -FailedAttemptIntervalSec 900,TRUE,TRUE,VCSA-80-000145,900,NO,8.3.4,30 minutes,NO,TRUE,,,,,,,
vcenter-8.administration-login-message-details,VMware vSphere,8,VMware vCenter,8.0.3,Base,P1,Configure the vCenter Server login banner details for the vSphere Client.,"vCenter Server can display a login message, which serves to deter illegal activities and communicate system usage obligations to authorized users. This configuration sets the detailed text linked from the vSphere Client login page message.","""Details of Login Message""",Not Configured,"Consult your organization's legal advisors for text that is applicable to your environment.

An example is: ""Authorized users only. Actual or attempted unauthorized use of this system is prohibited and may result in criminal, civil, security, or administrative proceedings and/or penalties. Use of this information system indicates consent to monitoring and recording, without notice or permission. Users have no expectation of privacy in any use of this system. Any information stored on, or transiting this system, or obtained by monitoring and/or recording, may be disclosed to law enforcement and/or used in accordance with Federal law, State statute, and organization policy. If you are not an authorized user of this system, exit the system at this time.""",NO,Modify,vCenter Server SSO Configuration,None,"N/A (No public API available)

Can be configured using ""/opt/vmware/bin/sso-config.sh -set_logon_banner -title <logon_banner_title> <logonBannerFile>"" from an appliance shell. Please deactivate the shell again when you are done.","N/A (No public API available)

Can be configured using ""/opt/vmware/bin/sso-config.sh -set_logon_banner -title <logon_banner_title> <logonBannerFile>"" from an appliance shell. Please deactivate the shell again when you are done.",FALSE,FALSE,VCSA-80-000024,N/A,YES,N/A,N/A,N/A,TRUE,,,,,,,
vcenter-8.administration-login-message-enable,VMware vSphere,8,VMware vCenter,8.0.3,Base,P1,Enable the vCenter Server login banner for the vSphere Client.,"vCenter Server can show a login message, useful for deterring intruders and communicating usage obligations to authorized users. This configuration enables the display of this message on the vSphere Client login page.","""Show Login Message""",FALSE,TRUE,NO,Modify,vCenter Server SSO Configuration,None,"N/A (No public API available)

Can be configured using ""/opt/vmware/bin/sso-config.sh -set_logon_banner -title <logon_banner_title> <logonBannerFile>"" from an appliance shell. Please deactivate the shell again when you are done.","N/A (No public API available)

Can be configured using ""/opt/vmware/bin/sso-config.sh -set_logon_banner -title <logon_banner_title> <logonBannerFile>"" from an appliance shell. Please deactivate the shell again when you are done.",FALSE,FALSE,VCSA-80-000024,TRUE,NO,N/A,N/A,N/A,TRUE,,,,,,,
vcenter-8.administration-login-message-text,VMware vSphere,8,VMware vCenter,8.0.3,Base,P1,Configure the vCenter Server login banner text for the vSphere Client.,"vCenter Server allows a login message, which deters intruders and communicates obligations to authorized users. This configuration establishes the text displayed on the vSphere Client login page.","""Login Message""",Not Configured,"Consult your organization's legal advisors for specific text.

An example is: ""Use of this system indicates awareness of, and consent to, the organizational policies governing this system.""",NO,Modify,vCenter Server SSO Configuration,None,"N/A (No public API available)

Can be configured using ""/opt/vmware/bin/sso-config.sh -set_logon_banner -title <logon_banner_title> <logonBannerFile>"" from an appliance shell. Please deactivate the shell again when you are done.","N/A (No public API available)

Can be configured using ""/opt/vmware/bin/sso-config.sh -set_logon_banner -title <logon_banner_title> <logonBannerFile>"" from an appliance shell. Please deactivate the shell again when you are done.",FALSE,FALSE,VCSA-80-000024,Standard Mandatory DOD Notice and Consent Banner,YES,N/A,N/A,N/A,TRUE,,,,,,,
vcenter-8.administration-sso-groups,VMware vSphere,8,VMware vCenter,8.0.3,Base,P0,The vCenter Server must separate authentication and authorization for administrators.,"Combining authentication and authorization, as done in services like Active Directory, risks infrastructure breaches if compromised. Hence, vCenter Server should segregate these for administrators. Consider local SSO groups for authorization to better manage risk where feasible.",N/A,Not Configured,Not Configured,NO,Modify,vCenter Server SSO Configuration,Provisioning vCenter Server access will require interaction with vCenter Server SSO. Automation is possible with PowerCLI.,N/A (No public API available),N/A (No public API available),FALSE,FALSE,VCSA-80-000298,Not Configured,NO,N/A,N/A,N/A,TRUE,,,,,,,
vcenter-8.administration-sso-lockout-policy-max-attempts,VMware vSphere,8,VMware vCenter,8.0.3,Base,P2,The vCenter Server must lock an account after a specified number of failed login attempts.,"Repeated failed logins for an account may signal security issues. To limit brute force attempts, lock the account after a certain threshold, balancing between avoiding automatic connection retries and potential denial-of-service attacks.",Maximum number of failed login attempts,5,5,YES,Audit,vCenter Server SSO Configuration,None,Get-SsoLockoutPolicy | Select MaxFailedAttempts,Get-SsoLockoutPolicy | Set-SsoLockoutPolicy -MaxFailedAttempts 5,TRUE,TRUE,VCSA-80-000023,3,YES,8.3.4,10 attempts,NO,TRUE,,,,,,,
vcenter-8.administration-sso-lockout-policy-unlock-time,VMware vSphere,8,VMware vCenter,8.0.3,Base,P0,The vCenter Server must unlock accounts after a specified timeout period.,Repeated failed logins may suggest security threats. Due to the importance of vCenter Server accounts should not automatically unlock when they have been locked due to multiple login failures. Ensure that you have your administrator@vsphere.local information and that it is valid.,Unlock time,300,0,NO,Modify,vCenter Server SSO Configuration,There is the opportunity for denial-of-service when accounts do not automatically unlock.,Get-SsoLockoutPolicy | Select AutoUnlockIntervalSec,Get-SsoLockoutPolicy | Set-SsoLockoutPolicy -AutoUnlockIntervalSec 0,TRUE,TRUE,VCSA-80-000266,0,NO,8.3.4,30 minutes,NO,TRUE,,,,,,,
vcenter-8.administration-sso-password-lifetime,VMware vSphere,8,VMware vCenter,8.0.3,Base,P1,The vCenter Server must be configured with an appropriate maximum password age.,"Modern best practices for passwords (NIST 800-63B Section 5.1.1.2, among other guidance) indicates that with adequate password entropy, security is not improved by arbitrarily requiring users to change their passwords at certain intervals. Many automated security tools and regulatory compliance frameworks do not reflect this guidance, and may override this recommendation.",Maximum Lifetime,90,9999,NO,Modify,vCenter Server SSO Configuration,None,Get-SsoPasswordPolicy | Select PasswordLifetimeDays,Get-SsoPasswordPolicy | Set-SsoPasswordPolicy -PasswordLifetimeDays 9999,TRUE,TRUE,VCSA-80-000079,90,YES,8.3.9,90 days,YES,TRUE,,,,,,,
vcenter-8.administration-sso-password-policy,VMware vSphere,8,VMware vCenter,8.0.3,Base,P1,The vCenter Server must enforce password complexity.,"Modern best practices for passwords (NIST 800-63B Section 5.1.1.2, among other guidance) suggests that composition rules (requiring mixtures of character classes, for example) should not be imposed on systems because they tend to not improve the security of passwords and discourage the use of more secure passphrases. Many regulatory compliance frameworks do not reflect this guidance, and may override this recommendation.

Password strength and complexity rules apply to accounts created in vSphere SSO, including administrator@vsphere.local. They do not apply to Active Directory users when vCenter Server is joined to a domain, as those password policies are enforced by AD.","Maximum Length,
Minimum Length,
Character Requirements","Maximum Length: 20
Minimum Length: 8
At least 1 special 
At least 2 alphabetic
At least 1 uppercase
At least 1 lowercase
At least 1 numeric
3 identical adjacent","Maximum Length: 64
Minimum Length: 15
At least 1 special 
At least 2 alphabetic
At least 1 uppercase
At least 1 lowercase
At least 1 numeric
3 identical adjacent",NO,Modify,vCenter Server SSO Configuration,Other products and services within the VMware ecosystem may not expect changes to password complexity requirements and may fail installation.,Get-SsoPasswordPolicy,Get-SsoPasswordPolicy | Set-SsoPasswordPolicy -MinLength 15 -MaxLength 64 -MinNumericCount 1 -MinSpecialCharCount 1 -MinAlphabeticCount 2 -MinUppercaseCount 1 -MinLowercaseCount 1 -MaxIdenticalAdjacentCharacters 3,TRUE,TRUE,"VCSA-80-000069
VCSA-80-000071
VCSA-80-000072
VCSA-80-000073
VCSA-80-000074","Maximum Length: 64
Minimum Length: 15
At least 1 special 
At least 2 alphabetic
At least 1 uppercase
At least 1 lowercase
At least 1 numeric
3 identical adjacent",NO,"8.3.1
8.3.6","Maximum Length: 64
Minimum Length: 12
At least 1 special 
At least 2 alphabetic
At least 1 uppercase
At least 1 lowercase
At least 1 numeric
3 identical adjacent",NO,TRUE,,,,,,,
vcenter-8.administration-sso-password-reuse,VMware vSphere,8,VMware vCenter,8.0.3,Base,P2,Configure the password history setting to restrict the reuse of passwords on the vCenter Server.,Password complexity rules may lead users to reuse old passwords. Configuring the password history setting on the vCenter Server can help prevent this.,Restrict Reuse,5,5,YES,Audit,vCenter Server SSO Configuration,None,Get-SsoPasswordPolicy | Select ProhibitedPreviousPasswordsCount,Get-SsoPasswordPolicy | Set-SsoPasswordPolicy -ProhibitedPreviousPasswordsCount 5,TRUE,TRUE,VCSA-80-000070,5,NO,8.3.7,4,NO,TRUE,,,,,,,
vcenter-8.etc-issue,VMware vSphere,8,VMware vCenter,8.0.3,Base,P1,Configure the vCenter Server login banner text for access via SSH.,"vCenter Server allows a login message, which deters intruders and communicates obligations to authorized users. This configuration establishes the text displayed when a client connects via SSH. The default text leaks information to attackers about system configuration and should be changed.",etc.issue,"""VMware vCenter Server 8.0.2.00000Type: vCenter Server with an embedded Platform Services Controller""","Consult your organization's legal advisors for text that is applicable to your environment.

An example is: ""Authorized users only. Actual or attempted unauthorized use of this system is prohibited and may result in criminal, civil, security, or administrative proceedings and/or penalties. Use of this information system indicates consent to monitoring and recording, without notice or permission. Users have no expectation of privacy in any use of this system. Any information stored on, or transiting this system, or obtained by monitoring and/or recording, may be disclosed to law enforcement and/or used in accordance with Federal law, State statute, and organization policy. If you are not an authorized user of this system, exit the system at this time.""",NO,Modify,vCenter Server Advanced Settings,None,Get-AdvancedSetting -Entity $VC -Name etc.issue,"Get-AdvancedSetting -Entity $VC -Name etc.issue | Set-AdvancedSetting -Value ""****************************************************************************`n* Authorized users only. Actual or attempted unauthorized use of this      *`n* system is prohibited and may result in criminal, civil, security, or     *`n* administrative proceedings and/or penalties. Use of this information     *`n* system indicates consent to monitoring and recording, without notice     *`n* or permission. Users have no expectation of privacy. Any information     *`n* stored on or transiting this system, or obtained by monitoring and/or    *`n* recording, may be disclosed to law enforcement and/or used in accordance *`n* with Federal law, State statute, and organization policy. If you are not *`n* an authorized user of this system, exit the system at this time.         *`n****************************************************************************`n""",TRUE,TRUE,PHTN-40-000005,Standard Mandatory DOD Notice and Consent Banner,YES,N/A,N/A,N/A,TRUE,,,,,,,
vcenter-8.events-database-retention,VMware vSphere,8,VMware vCenter,8.0.3,Base,P2,The vCenter server must have task and event retention set to an apppropriate interval.,"vCenter Server retains task and event data, which ages out to save storage space. The age is configurable. This only impacts local storage of event data on the vCenter Server Appliance.",Task Retention,30,30,YES,Audit,vCenter Server Database Settings,None,N/A (No public API available),N/A (No public API available),FALSE,FALSE,VCSA-80-000293,30,NO,10.5.1,"12 months, with
3 immediately available",YES,TRUE,,,,,,,
vcenter-8.events-remote-logging,VMware vSphere,8,VMware vCenter,8.0.3,Base,P2,Enable remote logging of vCenter Server events.,Remote logging to a central host enhances vCenter Server's security by storing logs securely. It simplifies monitoring across hosts and supports aggregate analysis for detecting coordinated attacks. Centralized logging prevents tampering and serves as a reliable long-term audit record.,vpxd.event.syslog.enabled,true,true,YES,Audit,vCenter Server Advanced Settings,None,Get-AdvancedSetting -Entity $VC -Name vpxd.event.syslog.enabled,Get-AdvancedSetting -Entity $VC -Name vpxd.event.syslog.enabled | Set-AdvancedSetting -Value true,TRUE,TRUE,VCSA-80-000280,TRUE,NO,"10.2.1
10.3.3",N/A,N/A,TRUE,,,,,,,
vcenter-8.fips-enable,VMware vSphere,8,VMware vCenter,8.0.3,Base,Advanced,The vCenter Server must enable FIPS-validated cryptography.,FIPS cryptography makes a number of changes to the system to remove weaker ciphers. Enabling this will cause vCenter Server to reboot.,N/A,false,true,NO,Modify,API/PowerCLI,Certain cipher suites will become unavailable and may impact interoperability.,Invoke-GetSystemGlobalFips,"$spec = Initialize-SystemSecurityGlobalFipsUpdateSpec -Enabled $true
Invoke-SetSystemGlobalFips -SystemSecurityGlobalFipsUpdateSpec $spec",FALSE,FALSE,VCSA-80-000077,TRUE,NO,"2.2.7
4.2.1
8.3.2",N/A,N/A,TRUE,,,,,,,
vcenter-8.logs-level-global,VMware vSphere,8,VMware vCenter,8.0.3,Base,P2,The vCenter Server must produce audit records containing information to establish what type of events occurred.,It is important to ensure that sufficient information is present in audit logs for diagnostics and forensics purposes.,config.log.level,info,info,YES,Audit,vCenter Server Advanced Settings,None,Get-AdvancedSetting -Entity $VC -Name config.log.level,Get-AdvancedSetting -Entity $VC -Name config.log.level | Set-AdvancedSetting -Value info,TRUE,TRUE,VCSA-80-000034,info,NO,"10.2.1
10.3.3",N/A,N/A,TRUE,,,,,,,
vcenter-8.network-mac-learning,VMware vSphere,8,VMware vCenter,8.0.3,Distributed Switch,"P2
Upon Feature Enablement",All distributed switch port groups must deactivate MAC Learning unless used intentionally.,"MAC Learning enables a distributed switch to provide network connectivity to systems where more than one MAC address is used on a vNIC. This can be useful in special cases like nested virtualization (running ESXi inside ESXi, for example). MAC learning also supports unknown unicast flooding. Normally, when a packet that is received by a port has an unknown destination MAC address, the packet is dropped. With unknown unicast flooding enabled, the port floods unknown unicast traffic to every port on the switch that has MAC learning and unknown unicast flooding enabled. This property is enabled by default, but only if MAC learning is enabled. It is recommended to disable MAC Learning unless it is in use intentionally for a known workload that requires it.",N/A,Disabled,Disabled,YES,Audit,Distributed Switch Port Group Settings,Some workloads do legitimately use these network tactics and will be negatively affected by the defaults/desired state.,(Get-VDPortgroup -Name $VDPG).ExtensionData.Config.DefaultPortConfig.MacManagementPolicy.MacLearningPolicy | Select-Object -ExpandProperty Enabled,"$VDPGview = Get-VDPortgroup -Name $VDPG | Get-View 
$ConfigSpec = New-Object VMware.Vim.DVPortgroupConfigSpec
$ConfigSpec.DefaultPortConfig = New-Object VMware.Vim.VMwareDVSPortSetting
$ConfigSpec.DefaultPortConfig.MacManagementPolicy = New-Object VMware.Vim.DVSMacManagementPolicy
$ConfigSpec.DefaultPortConfig.MacManagementPolicy.MacLearningPolicy = New-Object VMware.Vim.DVSMacLearningPolicy
$ConfigSpec.DefaultPortConfig.MacManagementPolicy.MacLearningPolicy.Enabled = $false
$ConfigSpec.ConfigVersion = $VDPGview.Config.ConfigVersion
$VDPGview.ReconfigureDVPortgroup_Task($ConfigSpec)",TRUE,TRUE,N/A,N/A,N/A,1.4.5,N/A,N/A,TRUE,,,,,,,
vcenter-8.network-reject-forged-transmit-dvportgroup,VMware vSphere,8,VMware vCenter,8.0.3,Distributed Switch,"P2
Upon Feature Enablement",All distributed switches and their port groups must be configured to reject forged transmits.,"A virtual machine can impersonate network adapters by changing MAC addresses, posing security threats. By setting the Forged Transmits option to Reject on all distributed switches and port groups, ESXi verifies MAC addresses and prevents such impersonation.",N/A,Reject,Reject,YES,Audit,Distributed Switch Port Group Settings,Some workloads do legitimately use these network tactics and will be negatively affected by the defaults/desired state.,"Get-VDSwitch -Name $VDS | Get-VDSecurityPolicy
Get-VDPortgroup -Name $VDPG | Get-VDSecurityPolicy","Get-VDSwitch -Name $VDS | Get-VDSecurityPolicy | Set-VDSecurityPolicy -ForgedTransmits $false
Get-VDPortgroup -Name $VDPG | Get-VDSecurityPolicy | Set-VDSecurityPolicy -ForgedTransmits $false",TRUE,TRUE,VCSA-80-000268,Reject,NO,1.4.3,N/A,N/A,TRUE,,,,,,,
vcenter-8.network-reject-mac-changes-dvportgroup,VMware vSphere,8,VMware vCenter,8.0.3,Distributed Switch,"P2
Upon Feature Enablement",All distributed switches and their port groups must be configured to reject guest MAC address changes.,"Allowing virtual machines to change MAC addresses poses security risks, enabling potential network adapter impersonation. Rejecting MAC changes on all distributed switches and port groups prevents this, but may impact certain applications like Microsoft Clustering or MAC address-dependent licensing. Exceptions should be made as necessary.",N/A,Reject,Reject,YES,Audit,Distributed Switch Port Group Settings,Some workloads do legitimately use these network tactics and will be negatively affected by the defaults/desired state.,"Get-VDSwitch -Name $VDS | Get-VDSecurityPolicy
Get-VDPortgroup -Name $VDPG | Get-VDSecurityPolicy","Get-VDSwitch -Name $VDS | Get-VDSecurityPolicy | Set-VDSecurityPolicy -MacChanges $false
Get-VDPortgroup -Name $VDPG | Get-VDSecurityPolicy | Set-VDSecurityPolicy -MacChanges $false",TRUE,TRUE,VCSA-80-000269,Reject,NO,1.4.3,N/A,N/A,TRUE,,,,,,,
vcenter-8.network-reject-promiscuous-mode-dvportgroup,VMware vSphere,8,VMware vCenter,8.0.3,Distributed Switch,"P2
Upon Feature Enablement",All distributed switches and their port groups must be configured to reject guest promiscuous mode requests.,"Enabling promiscuous mode on a port group allows all connected virtual machines to read all network packets, posing a potential security risk. Although sometimes necessary for debugging or monitoring, the default setting - reject - is recommended. Exceptions can be made for specific port groups as required.",N/A,Reject,Reject,YES,Audit,Distributed Switch Port Group Settings,Some workloads do legitimately use these network tactics and will be negatively affected by the defaults/desired state.,"Get-VDSwitch -Name $VDS | Get-VDSecurityPolicy
Get-VDPortgroup -Name $VDPG | Get-VDSecurityPolicy","Get-VDSwitch -Name $VDS | Get-VDSecurityPolicy | Set-VDSecurityPolicy -AllowPromiscuous $false
Get-VDPortgroup -Name $VDPG | Get-VDSecurityPolicy | Set-VDSecurityPolicy -AllowPromiscuous $false",TRUE,TRUE,VCSA-80-000270,Reject,NO,1.4.5,N/A,N/A,TRUE,,,,,,,
vcenter-8.network-reset-port,VMware vSphere,8,VMware vCenter,8.0.3,Distributed Switch,"P2
Upon Feature Enablement",The vCenter Server must reset port configuration when virtual machines are disconnected.,"When a virtual machine is disconnected from the virtual switch port it is desirable to reset the port configuration, so that another virtual machine that attaches has a port in a known state.",N/A,Enabled,Enabled,YES,Audit,Distributed Switch Settings,None,(Get-VDPortgroup -Name $VDPG).ExtensionData.Config.Policy | Select-Object -ExpandProperty PortConfigResetAtDisconnect,"$VDPGview = Get-VDPortgroup -Name $VDPG | Get-View 
$ConfigSpec = New-Object VMware.Vim.DVPortgroupConfigSpec
$ConfigSpec.DefaultPortConfig = New-Object VMware.Vim.VMwareDVSPortSetting
$ConfigSpec.Policy = New-Object VMware.Vim.VMwareDVSPortgroupPolicy
$ConfigSpec.Policy.PortConfigResetAtDisconnect = $true
$ConfigSpec.ConfigVersion = $VDPGview.Config.ConfigVersion
$VDPGview.ReconfigureDVPortgroup_Task($ConfigSpec)",TRUE,TRUE,VCSA-80-000302,Enabled,NO,N/A,N/A,N/A,TRUE,,,,,,,
vcenter-8.network-restrict-discovery-protocol,VMware vSphere,8,VMware vCenter,8.0.3,Distributed Switch,"P1
Upon Feature Enablement",The vCenter Server must deactivate CDP/LLDP on distributed switches unless used intentionally.,"vSphere Distributed Virtual Switch can engage in CDP or LLDP, potentially sharing sensitive unencrypted information, like IP addresses and system names, on the network. As it can aid adversaries in understanding or impersonating your environment, However, it is also extremely helpful for legitimate use cases. It is recommended to keep it deactivated unless necessary for troubleshooting or configuration validation.",N/A,listen,none,NO,Modify,Distributed Switch Settings,None,(Get-VDSwitch -Name $VDS).ExtensionData.config.LinkDiscoveryProtocolConfig | Select-Object -ExpandProperty Operation,"$VDview = Get-VDSwitch -Name $VDS | Get-View
$ConfigSpec = New-Object VMware.Vim.VMwareDVSConfigSpec
$ConfigSpec.LinkDiscoveryProtocolConfig = New-Object VMware.Vim.LinkDiscoveryProtocolConfig
$ConfigSpec.LinkDiscoveryProtocolConfig.Protocol = 'cdp'
$ConfigSpec.LinkDiscoveryProtocolConfig.Operation = 'none'
$ConfigSpec.ConfigVersion = $VDview.Config.ConfigVersion
$VDview.ReconfigureDvs_Task($ConfigSpec)",TRUE,TRUE,VCSA-80-000299,none,NO,1.4.5,N/A,N/A,TRUE,,,,,,,
vcenter-8.network-restrict-netflow-usage,VMware vSphere,8,VMware vCenter,8.0.3,Distributed Switch,"P2
Upon Feature Enablement",The vCenter Server must ensure that NetFlow traffic is being sent to authorized collectors.,"vSphere Distributed Switch can export unencrypted NetFlow data, revealing details about virtual network and traffic patterns. It is essential to verify that NetFlow usage is authorized and correctly configured to prevent information leaks.",N/A,Not Configured,Not Configured,YES,Audit,Distributed Switch Settings,Legitimate network monitoring tools may require this functionality.,"(Get-VDSwitch -Name $VDS).ExtensionData.config.IpfixConfig.CollectorIpAddress | Select-Object -ExpandProperty CollectorIpAddress

(Get-VDPortgroup -Name $VDPG).ExtensionData.Config.DefaultPortConfig.IpfixEnabled | Select-Object -ExpandProperty Value","$VDPGview = Get-VDPortgroup -Name $VDPG | Get-View 
$ConfigSpec = New-Object VMware.Vim.DVPortgroupConfigSpec
$ConfigSpec.DefaultPortConfig = New-Object VMware.Vim.VMwareDVSPortSetting
$ConfigSpec.DefaultPortConfig.IpfixEnabled = New-Object VMware.Vim.BoolPolicy
$ConfigSpec.DefaultPortConfig.IpfixEnabled.Inherited = $false
$ConfigSpec.DefaultPortConfig.IpfixEnabled.Value = $false
$ConfigSpec.ConfigVersion = $VDPGview.Config.ConfigVersion
$VDPGview.ReconfigureDVPortgroup_Task($ConfigSpec)",TRUE,TRUE,VCSA-80-000271,Not Configured,NO,1.4.5,N/A,N/A,TRUE,,,,,,,
vcenter-8.network-restrict-port-level-overrides,VMware vSphere,8,VMware vCenter,8.0.3,Distributed Switch,"P2
Upon Feature Enablement","The vCenter Server must not override port group settings at the port level on distributed switches, except for block ports.","While port-level configuration overrides may be needed for unique VM setups, they must be closely monitored to prevent unauthorized use. Unmonitored overrides could allow broader access if a less secure Distributed Switch configuration is exploited.",N/A,"Block Ports Override: TRUE
All Other Overrides: FALSE","Block Ports Override: TRUE
All Other Overrides: FALSE",YES,Audit,Distributed Switch Port Group Settings,None,(Get-VDPortgroup -Name $VDPG).ExtensionData.Config.Policy,"$VDPGview = Get-VDPortgroup -Name $VDPG | Get-View 
$ConfigSpec = New-Object VMware.Vim.DVPortgroupConfigSpec
$ConfigSpec.DefaultPortConfig = New-Object VMware.Vim.VMwareDVSPortSetting
$ConfigSpec.Policy = New-Object VMware.Vim.VMwareDVSPortgroupPolicy
$ConfigSpec.Policy.UplinkTeamingOverrideAllowed = $false
$ConfigSpec.Policy.BlockOverrideAllowed = $true
$ConfigSpec.Policy.LivePortMovingAllowed = $false
$ConfigSpec.Policy.VlanOverrideAllowed = $false
$ConfigSpec.Policy.SecurityPolicyOverrideAllowed = $false
$ConfigSpec.Policy.VendorConfigOverrideAllowed = $false
$ConfigSpec.Policy.ShapingOverrideAllowed = $false
$ConfigSpec.Policy.IpfixOverrideAllowed = $false
$ConfigSpec.Policy.TrafficFilterOverrideAllowed = $false
$ConfigSpec.ConfigVersion = $VDPGview.Config.ConfigVersion
$VDPGview.ReconfigureDVPortgroup_Task($ConfigSpec)",TRUE,TRUE,VCSA-80-000301,"Block Ports Override: TRUE
All Other Overrides: FALSE",NO,N/A,N/A,N/A,TRUE,,,,,,,
vcenter-8.network-restrict-port-mirroring,VMware vSphere,8,VMware vCenter,8.0.3,Distributed Switch,"P2
Upon Feature Enablement",The vCenter Server must remove unauthorized port mirroring sessions on distributed switches.,"vSphere Distributed Switch can mirror traffic between ports, enabling traffic observation. To maintain security, any unauthorized port mirroring sessions on distributed switches must be promptly removed.",N/A,Not Configured,Not Configured,YES,Audit,Distributed Switch Settings,None,(Get-VDSwitch -Name $VDS).ExtensionData.config.VspanSession,N/A,TRUE,FALSE,VCSA-80-000300,Not Configured,NO,1.4.5,N/A,N/A,TRUE,,,,,,,
vcenter-8.network-vgt,VMware vSphere,8,VMware vCenter,8.0.3,Distributed Switch,"P2
Upon Feature Enablement",The vCenter Server must restrict the use of Virtual Guest Tagging (VGT) on Distributed Switches.,"Setting a port group to VLAN 4095 allows Virtual Guest Tagging (VGT), requiring the VM to process VLAN tags. This should only be enabled for VMs authorized and equipped to manage VLAN tags, as inappropriate use can cause service denial or unauthorized VLAN traffic interaction.",N/A,Not Configured,Not Configured,YES,Audit,Distributed Switch Port Group Settings,None,"Get-VDPortgroup -Name $VDPG | Where {$_.ExtensionData.Config.Uplink -ne ""True""} | Select Name,VlanConfiguration","Get-VDPortgroup $VDPG | Set-VDVlanConfiguration -VlanId ""<New VLAN#>""",TRUE,FALSE,VCSA-80-000273,Not Configured,NO,N/A,N/A,N/A,TRUE,,,,,,,
vcenter-8.supported,VMware vSphere,8,VMware vCenter,8.0.3,Base,P2,vCenter Server is a version that has not reached End of General Support status.,Ensure that vCenter Server is of a version that has not reached End of General Support status.,Product Version & Build Number,N/A,N/A,YES,Audit,vCenter Server Virtual Appliance Management Interface,None,N/A,N/A,FALSE,FALSE,N/A,N/A,N/A,6.3.3,N/A,N/A,TRUE,,,,,,,
vcenter-8.tls-profile,VMware vSphere,8,VMware vCenter,8.0.3,Base,P0,The vCenter Server must maintain confidentiality and integrity of transmissions by enabling modern TLS ciphers.,"In vCenter Server 8.0.3 and newer, TLS profiles are available to configure client and server TLS settings to use only strong ciphers.

To view the current settings, in the vSphere Client go to Developer Center, then to API Explorer. Select ""appliance"" from the ""Select API"" drop down list then scroll down to the ""tls/profiles/global"" section. Expand the GET call and click Execute.

To update this parameter, in the vSphere Client go to Developer Center, then to API Explorer. Select ""appliance"" from the ""Select API"" drop down list then scroll down to the ""tls/profiles/global"" section. Expand the PUT call and enter the following in the value box:

{
    ""profile"": ""NIST_2024""
}

Click Execute to configure a new global TLS profile. The vCenter Server will restart services after setting this parameter, disconnecting clients.",N/A,COMPATIBLE,NIST_2024,NO,Modify,vSphere Client Developer Center,Changes to cipher suites impact connectivity with external systems.,N/A (Use API Explorer method in Discussion),N/A (Use API Explorer method in Discussion),TRUE,FALSE,VCSA-80-000009,NIST_2024,NO,"2.2.7
4.2.1
8.3.2",N/A,N/A,TRUE,,,,,,,
vcenter-8.vami-access-ssh,VMware vSphere,8,VMware vCenter,8.0.3,VAMI,P2,The vCenter Server SSH service must be deactivated.,"vCenter Server, delivered as an appliance, is intended for management via VAMI, vSphere Client, and APIs. While SSH is a support tool, it should be deactivated unless required, except for vCenter Server High Availability (not vSphere HA!) which necessitates its use.","VAMI, SSH Login",Deactivated,Deactivated,YES,Audit,vCenter Server Virtual Appliance Management Interface,None,"(Get-CisService -Name ""com.vmware.appliance.access.ssh"").get()","(Get-CisService -Name ""com.vmware.appliance.access.ssh"").set($false)",TRUE,TRUE,VCSA-80-000303,Deactivated,NO,N/A,N/A,N/A,FALSE,,,,,,,
vcenter-8.vami-administration-password-expiration,VMware vSphere,8,VMware vCenter,8.0.3,VAMI,P0,The vCenter Server root account password expiration must be configured appropriately.,"Modern best practices for passwords (NIST 800-63B Section 5.1.1.2, among other guidance) indicates that with adequate password entropy, security is not improved by arbitrarily requiring users to change their passwords at certain intervals. Many automated security tools and regulatory compliance frameworks do not reflect this guidance, and may override this recommendation.","VAMI, Password Expires",Yes,No,NO,Modify,vCenter Server Virtual Appliance Management Interface,Failure to reset the password before the expiration means that recovery procedures will be necessary.,N/A,N/A,FALSE,FALSE,N/A,N/A,N/A,N/A,N/A,N/A,TRUE,,,,,,,
vcenter-8.vami-backup,VMware vSphere,8,VMware vCenter,8.0.3,VAMI,P0,Configure File-Based Backup and Recovery to a secure location unless alternate backup methods are in use.,"File-Based Backup and Recovery, which allows vCenter Server and configuration recovery via the vCenter Server installer, plays a crucial role in safeguarding your environment. It should be appropriately configured. Because this backup method contains information about privileged access to the vSphere cluster it should always be stored securely.","VAMI, Backup",Not Configured,Configured,NO,Modify,vCenter Server Virtual Appliance Management Interface,None,N/A,N/A,FALSE,FALSE,VCSA-80-000292,Configured,NO,N/A,N/A,N/A,TRUE,,,,,,,
vcenter-8.vami-firewall-restrict-access,VMware vSphere,8,VMware vCenter,8.0.3,Base,P0,The vCenter Server must configure the firewall to only allow traffic from authorized networks.,"Ensures that all incoming and outgoing network traffic is blocked unless explicitly allowed, reducing the attack surface and helping to prevent unauthorized access to the system. Note that outgoing/egress traffic is not blocked, nor are related/established connections, so vCenter Server will still be able to communicate with systems where it initiates the connection. Perimeter firewalls should be used to curtail those types of connections.",N/A,Connections allowed from any IP address,Connections allowed only from authorized infrastructure and administration workstations,NO,Modify,VAMI ,"Loss of connectivity. Ensure that you configure an allow rule for yourself prior to configuring a ""deny all"" rule.",N/A,N/A,FALSE,FALSE,N/A,N/A,N/A,"1.3.1
1.4.1
1.4.2
1.4.4",N/A,N/A,TRUE,,,,,,,
vcenter-8.vami-syslog,VMware vSphere,8,VMware vCenter,8.0.3,VAMI,P0,Configure a remote log server for the vCenter Server.,Remote logging to a central host enhances vCenter Server's security by storing logs securely. It simplifies monitoring across hosts and supports aggregate analysis for detecting coordinated attacks. Centralized logging prevents tampering and serves as a reliable long-term audit record.,"VAMI, Syslog",Not Configured,Site-Specific Log Server,NO,Modify,vCenter Server Virtual Appliance Management Interface,None,"(Get-CisService -Name ""com.vmware.appliance.logging.forwarding"").get()",N/A,TRUE,FALSE,VCSA-80-000148,Site-Specific Log Server,NO,"10.2.1
10.3.3",N/A,N/A,TRUE,,,,,,,
vcenter-8.vami-time,VMware vSphere,8,VMware vCenter,8.0.3,VAMI,P0,vCenter Server must have reliable time synchronization sources.,"Cryptography, audit logging, cluster operations, and incident response/forensics heavily rely on synchronized time. The recommended practice for NTP is to have at least four sources. It is not advisable to have only two sources, as having one source is preferable to having two.","VAMI, Time",Undefined,"Site-Specific or:
0.vmware.pool.ntp.org,
1.vmware.pool.ntp.org,
2.vmware.pool.ntp.org,
3.vmware.pool.ntp.org",NO,Audit,vCenter Server Virtual Appliance Management Interface,None,"(Get-CisService -Name ""com.vmware.appliance.timesync"").get()
(Get-CisService -Name ""com.vmware.appliance.ntp"").get()","(Get-CisService -Name ""com.vmware.appliance.timesync"").set(""NTP"")
(Get-CisService -Name ""com.vmware.appliance.ntp"").set(""0.vmware.pool.ntp.org,1.vmware.pool.ntp.org,2.vmware.pool.ntp.org,3.vmware.pool.ntp.org"")",TRUE,FALSE,VCSA-80-000158,"Site-Specific or:
0.vmware.pool.ntp.org,
1.vmware.pool.ntp.org,
2.vmware.pool.ntp.org,
3.vmware.pool.ntp.org",NO,"10.6.1
10.6.2",N/A,N/A,TRUE,,,,,,,
vcenter-8.vami-updates,VMware vSphere,8,VMware vCenter,8.0.3,VAMI,P0,vCenter Server has all software updates installed.,"By keeping vCenter Server patches up to date, vulnerabilities can be mitigated. It is important to note that educated attackers can exploit known vulnerabilities when attempting to gain unauthorized access or elevate privileges.

When applying updates, it is recommended to update vCenter Server first, if an update is available, and then proceed with updating ESXi. This sequence ensures that the management layer is updated before updating the ESXi hosts.",Product Version & Build Number,N/A,N/A,NO,Modify,vCenter Server Virtual Appliance Management Interface,None,N/A,N/A,FALSE,FALSE,N/A,N/A,N/A,6.3.3,N/A,N/A,TRUE,,,,,,,
vcenter-8.vpxuser-rotation,VMware vSphere,8,VMware vCenter,8.0.3,Base,P2,The vCenter Server must configure the vpxuser password to be rotated on an appropriate interval.,Ensures that the vCenter Server is properly rotating the password it automatically sets on the ESXi hosts.,VirtualCenter.VimPasswordExpirationInDays,30,30,YES,Audit,vCenter Server Advanced Settings,None,Get-AdvancedSetting -Entity $VC -Name VirtualCenter.VimPasswordExpirationInDays,Get-AdvancedSetting -Entity $VC -Name VirtualCenter.VimPasswordExpirationInDays | Set-AdvancedSetting -Value 30,TRUE,TRUE,VCSA-80-000275,30,NO,N/A,N/A,N/A,TRUE,,,,,,,
vm-8.deactivate-console-copy,VMware vSphere,8,VMware ESXi,8.0.3,Virtual Machine,P2,Virtual machines must have console copy operations deactivated.,"Deactivating console copy operations on virtual machines prevents data copying between the VM and the local client, regardless of whether the user is accessing through Web Console, VMRC, or another method.",isolation.tools.copy.disable,TRUE,TRUE or Undefined,YES,Audit,VM Advanced Parameters,None,Get-VM -Name $VM | Get-AdvancedSetting isolation.tools.copy.disable,Get-VM -Name $VM | Get-AdvancedSetting -Name isolation.tools.copy.disable | Remove-AdvancedSetting,TRUE,TRUE,VMCH-80-000189,TRUE,NO,3.4.2,N/A,N/A,TRUE,,,,,,,
vm-8.deactivate-console-paste,VMware vSphere,8,VMware ESXi,8.0.3,Virtual Machine,P2,Virtual machines must have console paste operations deactivated.,"By disabling console paste operations on virtual machines, data transfer from the local client to the VM is blocked, whether the user is using Web Console, VMRC, or another console.",isolation.tools.paste.disable,TRUE,TRUE or Undefined,YES,Audit,VM Advanced Parameters,None,Get-VM -Name $VM | Get-AdvancedSetting isolation.tools.paste.disable,Get-VM -Name $VM | Get-AdvancedSetting -Name isolation.tools.paste.disable | Remove-AdvancedSetting,TRUE,TRUE,VMCH-80-000192,TRUE,NO,3.4.2,N/A,N/A,TRUE,,,,,,,
vm-8.deactivate-disk-shrinking-shrink,VMware vSphere,8,VMware ESXi,8.0.3,Virtual Machine,P2,Virtual machines must have virtual disk shrinking operations deactivated.,Disabling virtual disk shrinking on virtual machines helps avoid disk unavailability issues. The ability to perform this operation is typically limited for non-administrative users in the guest environment.,isolation.tools.diskShrink.disable,TRUE,TRUE or Undefined,YES,Audit,VM Advanced Parameters,None,Get-VM -Name $VM | Get-AdvancedSetting isolation.tools.diskShrink.disable,Get-VM -Name $VM | Get-AdvancedSetting -Name isolation.tools.diskShrink.disable | Remove-AdvancedSetting,TRUE,TRUE,VMCH-80-000193,TRUE,NO,N/A,N/A,N/A,TRUE,,,,,,,
vm-8.deactivate-disk-shrinking-wiper,VMware vSphere,8,VMware ESXi,8.0.3,Virtual Machine,P2,Virtual machines must have virtual disk wiping operations deactivated.,Disabling virtual disk wiping on virtual machines helps avoid disk unavailability issues. The ability to perform this operation is typically limited for non-administrative users in the guest environment.,isolation.tools.diskWiper.disable,TRUE,TRUE or Undefined,YES,Audit,VM Advanced Parameters,None,Get-VM -Name $VM | Get-AdvancedSetting isolation.tools.diskWiper.disable,Get-VM -Name $VM | Get-AdvancedSetting -Name isolation.tools.diskWiper.disable | Remove-AdvancedSetting,TRUE,TRUE,VMCH-80-000194,TRUE,NO,N/A,N/A,N/A,TRUE,,,,,,,
vm-8.deactivate-non-essential-3d-features,VMware vSphere,8,VMware ESXi,8.0.3,Virtual Machine,P2,Virtual machines must have 3D graphics features deactivated when not required.,"Turning off 3D graphics features on virtual machines that don't need them reduces potential attack vectors, enhancing overall system security.",mks.enable3d,FALSE,FALSE,YES,Audit,VM Advanced Parameters,GPU and Virtual Desktops may require this functionality.,Get-VM -Name $VM | Get-AdvancedSetting mks.enable3d,Get-VM -Name $VM | Get-AdvancedSetting mks.enable3d | Set-AdvancedSetting -Value $false,TRUE,TRUE,VMCH-80-000202,FALSE,NO,N/A,N/A,N/A,TRUE,,,,,,,
vm-8.dvfilter,VMware vSphere,8,VMware ESXi,8.0.3,Virtual Machine,P2,"Virtual machines must limit access through the ""dvfilter"" network Application Programming Interface (API).","The dvFilter interface is used by tools like NSX to filter and inspect network traffic. Other tools may use it, too. Ensure that those tools are authorized.",ethernet*.filter*.name,Not Present,Not Present,YES,Audit,VM Advanced Parameters,"Legitimate network tools, including NSX, may require this functionality.","Get-VM -Name $VM | Get-AdvancedSetting ""ethernet*.filter*.name*""","Get-VM -Name $VM | Get-AdvancedSetting ""ethernet*.filter*.name*"" | Remove-AdvancedSetting",TRUE,FALSE,VMCH-80-000200,Not Present,NO,N/A,N/A,N/A,TRUE,,,,,,,
vm-8.efi-boot-types,VMware vSphere,8,VMware ESXi,8.0.3,Virtual Machine,Advanced,Virtual machines must prevent booting from unauthorized sources. ,"Unauthorized access to a virtual machine may occur when its primary boot volume is unavailable, and the EFI firmware seeks alternative boot sources, such as network boot. This can be mitigated through network controls, as well as with the advanced parameters bios.bootDeviceClasses, bios.bootOrder, and bios.hddOrder.

bios.bootDeviceClasses has the format ""allow:XXXX"" or ""deny:XXXX"" where XXXX is a comma-delimited list of boot classes. Boot classes are net (network PXE boot), usb (from attached USB devices), pcmcia (PCMCIA expansion cards, not used nowadays), cd (from attached virtual CD/DVD devices), hd (from attached virtual hard disks), fd (from attached virtual floppy devices), reserved (from unknown devices), efishell (into the EFI shell), all, or any (same as all).

Use of allow or deny also implicitly states the opposite. For example, deny:all disallows all boot, deny:net disallows network boot but allows all others, allow:hd allows only hd boot denies all others, allow:hd,cd allows hd then cd device boot and denies all others.

New virtual machines may require CD/DVD boot, and some dynamic environments, such as labs, may use network boot, and those environments should be set accordingly and have the rationale documented.",bios.bootDeviceClasses,allow:all,"allow:hd
once the guest OS is installed",NO,Modify,VM Advanced Parameters,"The virtual machine will no longer be able to boot from unspecified sources, which may negatively impact situations where PXE boot or recovery media is required. However, the parameter is easily changed at scale through PowerCLI. An alternate approach is to specify denied methods, such as ""deny:net""",Get-VM -Name $VM | Get-AdvancedSetting bios.bootDeviceClasses,"Get-VM -Name $VM | Get-AdvancedSetting bios.bootDeviceClasses | Set-AdvancedSetting -Value ""allow:hd""",TRUE,TRUE,N/A,N/A,N/A,N/A,N/A,N/A,TRUE,,,,,,,
vm-8.ft-encrypted,VMware vSphere,8,VMware ESXi,8.0.3,Virtual Machine,P1,Virtual machines must require encryption for Fault Tolerance.,"Requiring encryption for Fault Tolerance in VMs ensures secure data transmission. While the default 'opportunistic' encryption likely results in encryption due to ubiquitous AES-NI support in vSphere-compatible hardware, enforcing 'required' encryption guarantees no unencrypted operations.",VM Configuration,ftEncryptionOpportunistic,ftEncryptionRequired,NO,Modify,VM Settings,None,(Get-VM -Name $VM).ExtensionData.Config.FtEncryptionMode,"$VMview = Get-VM -Name $VM | Get-View 
$ConfigSpec = New-Object VMware.Vim.VirtualMachineConfigSpec
$ConfigSpec.FtEncryptionMode = New-object VMware.Vim.VirtualMachineConfigSpecEncryptedFtModes
$ConfigSpec.FtEncryptionMode = ""ftEncryptionRequired"" 
$VMview.ReconfigVM_Task($ConfigSpec)",TRUE,TRUE,VMCH-80-000204,ftEncryptionRequired,NO,"2.2.7
4.2.1",N/A,N/A,TRUE,,,,,,,
vm-8.isolation-device-connectable-deactivate,VMware vSphere,8,VMware ESXi,8.0.3,Virtual Machine,P2,"Virtual machines must prevent unauthorized removal, connection and modification of devices.","Preventing unauthorized device modifications in virtual machines blocks non-admin users or processes from connecting, disconnecting, or adjusting device settings. This measure curbs unauthorized access and operation disruption, reducing denial of service risks, as well as some avenues for exfiltrating data.",isolation.device.connectable.disable,TRUE,TRUE or Undefined,YES,Audit,VM Advanced Parameters,None,Get-VM -Name $VM | Get-AdvancedSetting isolation.device.connectable.disable,Get-VM -Name $VM | Get-AdvancedSetting -Name isolation.device.connectable.disable | Remove-AdvancedSetting,TRUE,TRUE,VMCH-80-000197,TRUE,NO,N/A,N/A,N/A,TRUE,,,,,,,
vm-8.isolation-tools-dnd-deactivate,VMware vSphere,8,VMware ESXi,8.0.3,Virtual Machine,P2,Virtual machines must have console drag and drop operations deactivated.,"Deactivating drag and drop operations in a virtual machine's console stops users from transferring data between the VM and the local client, regardless of the console type, enhancing data security.",isolation.tools.dnd.disable,TRUE,TRUE or Undefined,YES,Audit,VM Advanced Parameters,None,Get-VM -Name $VM | Get-AdvancedSetting isolation.tools.dnd.disable,Get-VM -Name $VM | Get-AdvancedSetting -Name isolation.tools.dnd.disable | Remove-AdvancedSetting,TRUE,TRUE,VMCH-80-000191,TRUE,NO,N/A,N/A,N/A,TRUE,,,,,,,
vm-8.limit-console-connections,VMware vSphere,8,VMware ESXi,8.0.3,Virtual Machine,P0,Virtual machines must limit console sharing.,"Limiting VM console sharing to one user prevents multiple observers, enhancing security. However, this might inadvertently create a potential pathway for service denial.",RemoteDisplay.maxConnections,-1,1,NO,Modify,VM Advanced Parameters,"May create a denial-of-service condition where the console is unusable because someone is connected, or a disconnected console session persists. Other products, such as VMware Cloud Director, may require this set to a greater value.",Get-VM -Name $VM | Get-AdvancedSetting RemoteDisplay.maxConnections,Get-VM -Name $VM | Get-AdvancedSetting RemoteDisplay.maxConnections | Set-AdvancedSetting -Value 1,TRUE,TRUE,VMCH-80-000195,1,NO,N/A,N/A,N/A,TRUE,,,,,,,
vm-8.limit-setinfo-size,VMware vSphere,8,VMware ESXi,8.0.3,Virtual Machine,P2,Virtual machines must limit informational messages from the virtual machine to the VMX file.,Limiting VM informational messages to the VMX file prevents it from exceeding its default size of 1MB. This control prevents potential denial of service situations that could arise if the datastore becomes full.,tools.setInfo.sizeLimit,1048576,1048576 or Undefined,YES,Audit,VM Advanced Parameters,None,Get-VM -Name $VM | Get-AdvancedSetting tools.setInfo.sizeLimit,Get-VM -Name $VM | Get-AdvancedSetting -Name tools.setInfo.sizeLimit | Remove-AdvancedSetting,TRUE,TRUE,VMCH-80-000196,1048576,NO,N/A,N/A,N/A,TRUE,,,,,,,
vm-8.log-enable,VMware vSphere,8,VMware ESXi,8.0.3,Virtual Machine,P2,Virtual machines must enable diagnostic logging.,Diagnostic logging for virtual machines helps with forensics and troubleshooting.,Enable Logging,TRUE,TRUE,YES,Audit,VM Settings,None,"Get-VM -Name $VM | Where {$_.ExtensionData.Config.Flags.EnableLogging -ne ""True""}","$VMview = Get-VM -Name $VM | Get-View 
$ConfigSpec = New-Object VMware.Vim.VirtualMachineConfigSpec
$ConfigSpec.Flags = New-Object VMware.Vim.VirtualMachineFlagInfo
$ConfigSpec.Flags.EnableLogging = $true
$VMview.ReconfigVM_Task($ConfigSpec)",TRUE,TRUE,VMCH-80-000207,TRUE,NO,10.5.1,"12 months, with
3 immediately available",YES,TRUE,,,,,,,
vm-8.log-retention,VMware vSphere,8,VMware ESXi,8.0.3,Virtual Machine,P2,Virtual machines must limit the number of retained diagnostic logs.,"By restricting the quantity of retained diagnostic logs, we can avoid filling up the datastore without compromising diagnostic functionality.",log.keepOld,10,10 or Undefined,YES,Audit,VM Advanced Parameters,None,Get-VM -Name $VM | Get-AdvancedSetting log.keepOld,Get-VM -Name $VM | Get-AdvancedSetting -Name log.keepOld | Remove-AdvancedSetting,TRUE,TRUE,VMCH-80-000206,10,NO,10.5.1,"12 months, with
3 immediately available",YES,TRUE,,,,,,,
vm-8.log-rotation-size,VMware vSphere,8,VMware ESXi,8.0.3,Virtual Machine,P2,Virtual machines must limit the size of diagnostic logs.,"Limiting the size of diagnostic logs on VMs prevents excessive space consumption, particularly on long-running VMs. As per VMware guidelines, the recommended minimum limit is 2MB.",log.rotateSize,2048000,2048000 or Undefined,YES,Audit,VM Advanced Parameters,None,Get-VM -Name $VM | Get-AdvancedSetting log.rotateSize,Get-VM -Name $VM | Get-AdvancedSetting -Name log.rotateSize | Remove-AdvancedSetting,TRUE,TRUE,VMCH-80-000205,2048000,NO,10.5.1,"12 months, with
3 immediately available",YES,TRUE,,,,,,,
vm-8.pci-passthrough,VMware vSphere,8,VMware ESXi,8.0.3,Virtual Machine,P0,Virtual machines must limit PCI device passthrough functionality.,"DirectPath I/O features enable VMs to directly access system hardware, impacting risk mitigation tools like vMotion, DRS, and High Availability. It also potentially gives attackers privileged hardware access. Ensure only necessary VMs have this privilege, compensating with guest OS security controls.",N/A,Not Present,Not Present,YES,Audit,VM Settings,"Passthrough devices, such as GPUs, would be negatively affected if they are disconnected. Audit and document the business need for these VMs.",Get-VM -Name $VM | Get-PassthroughDevice,Get-VM -Name $VM | Get-PassthroughDevice | Remove-PassthroughDevice,TRUE,FALSE,VMCH-80-000214,Not Present,NO,N/A,N/A,N/A,TRUE,,,,,,,
vm-8.remove-unnecessary-devices,VMware vSphere,8,VMware ESXi,8.0.3,Virtual Machine,P0,Virtual machines must remove unnecessary virtual hardware.,"Eliminate unnecessary virtual hardware from VMs to reduce potential attack surfaces. Rarely-used ports, temporary CD/DVD drives, and hardware introduced via migrations could be vulnerable. Removing these decreases risk of software introduction or data exfiltration from a protected environment.",N/A,Configured,Not Present,NO,Modify,VM Settings,"Removing the CD-ROM device may impact VMware Tools installation and maintenance.

Removing XHCI controllers may impact console keyboard and mouse connectivity for some guest OSes.","$VMview = Get-VM -Name $VM | Get-View
$UnnecessaryHardware = ""VirtualUSBController|VirtualUSBXHCIController|VirtualParallelPort|VirtualFloppy|VirtualSerialPort|VirtualHdAudioCard|VirtualAHCIController|VirtualEnsoniq1371|VirtualCdrom""

$VMview.Config.Hardware.Device | Where-Object {$_.GetType().Name -match $UnnecessaryHardware} | Foreach-Object {
	$devname = $_.GetType().Name
	Write-Host ""$VM`: [WARNING] VM has a $devname device. Please evaluate and consider removing."" -ForegroundColor Yellow
}",N/A,TRUE,TRUE,"VMCH-80-000209
VMCH-80-000210
VMCH-80-000211
VMCH-80-000212
VMCH-80-000213
VMCH-80-000214",Not Present,NO,N/A,N/A,N/A,TRUE,,,,,,,
vm-8.restrict-host-info,VMware vSphere,8,VMware ESXi,8.0.3,Virtual Machine,P2,Virtual machines must not be able to obtain host information from the hypervisor.,"Preventing VMs from obtaining host information from the hypervisor mitigates risk of advanced attacks, as it denies adversaries crucial details about the physical host.",tools.guestlib.enableHostInfo,FALSE,FALSE or Undefined,YES,Audit,VM Advanced Parameters,None,Get-VM -Name $VM | Get-AdvancedSetting tools.guestlib.enableHostInfo,Get-VM -Name $VM | Get-AdvancedSetting tools.guestlib.enableHostInfo | Remove-AdvancedSetting,TRUE,TRUE,VMCH-80-000198,FALSE,NO,1.4.5,N/A,N/A,TRUE,,,,,,,
vm-8.transparentpagesharing-inter-vm-enabled,VMware vSphere,8,VMware ESXi,8.0.3,Virtual Machine,P2,Virtual machines must restrict sharing of memory pages between VMs.,"Transparent Page Sharing (TPS) reduces VM memory footprint but could enable unauthorized data access in some very limited conditions. To bolster security, VMs should be configured with the sched.mem.pshare.salt option, preventing memory sharing with other VMs.",sched.mem.pshare.salt,Not Present,Not Present,YES,Audit,VM Advanced Parameters,None,Get-VM -Name $VM | Get-AdvancedSetting sched.mem.pshare.salt,Get-VM -Name $VM | Get-AdvancedSetting -Name sched.mem.pshare.salt | Remove-AdvancedSetting,TRUE,TRUE,VMCH-80-000199,Not Present,NO,N/A,N/A,N/A,TRUE,,,,,,,
vm-8.vmotion-encrypted,VMware vSphere,8,VMware ESXi,8.0.3,Virtual Machine,P1,Virtual machines must require encryption for vMotion.,"Requiring encryption for vMotion in virtual machines guarantees secure data transfer. The default 'opportunistic' encryption likely results in encryption due to widespread AES-NI support in vSphere-compatible hardware. However, enforcing 'required' encryption prevents any unencrypted operations.",VM Configuration,opportunistic,required,NO,Modify,VM Settings,None,(Get-VM -Name $VM).ExtensionData.Config.MigrateEncryption,"$VMview = Get-VM -Name $VM | Get-View 
$ConfigSpec = New-Object VMware.Vim.VirtualMachineConfigSpec
$ConfigSpec.MigrateEncryption = New-Object VMware.Vim.VirtualMachineConfigSpecEncryptedVMotionModes
$ConfigSpec.MigrateEncryption = ""required""
$VMview.ReconfigVM_Task($ConfigSpec)",TRUE,TRUE,VMCH-80-000203,required,NO,"2.2.7
4.2.1",N/A,N/A,TRUE,,,,,,,
vm-8.vmrc-lock,VMware vSphere,8,VMware ESXi,8.0.3,Virtual Machine,P0,Virtual machines must be configured to lock when the last console connection is closed.,Locking virtual machines when the last console connection closes can prevent potential unauthorized access from attackers exploiting logged-in console sessions.,tools.guest.desktop.autolock,FALSE,TRUE,NO,Modify,VM Settings,None,Get-VM -Name $VM | Get-AdvancedSetting tools.guest.desktop.autolock,Get-VM -Name $VM | Get-AdvancedSetting -Name tools.guest.desktop.autolock | Set-AdvancedSetting -Value $true,TRUE,TRUE,VMCH-80-000201,TRUE,NO,N/A,N/A,N/A,TRUE,,,,,,,
vsan-8.data-at-rest,VMware vSAN,8,VMware vSAN,8.0.3,Base,P0,vSAN must protect data at rest.,"vSAN Data-at-Rest encryption helps maintain the confidentiality of sensitive data while it resides on storage devices and reduce the risk of unauthorized access or exposure in the event of physical theft or loss. This configuration parameter can be altered while the cluster is operational. Enabling data-at-rest protections will reformat disk groups (for vSAN OSA) and rewrite stored objects (for vSAN ESA), which may take considerable time, but it will be done in the background. Workloads do not need to be powered off. vSAN ESA 8.0.2 introduced the ability to enable data-at-rest protections on an existing vSAN ESA datastore; vSAN ESA 8.0.3 introduced the ability to disable it again. It is recommended that you run the latest version of vSAN if using ESA.",N/A,Disabled,Enabled,NO,Modify,"vSAN Configuration,
Data Services","All encryption comes at the cost of CPU cycles and potential storage latency. How much this impacts workloads depends on a variety of factors, such as the configuration of the underlying hardware and the type and frequency of storage I/O by the workload.",N/A,N/A,FALSE,FALSE,N/A,N/A,N/A,"3.3.2
3.3.3
3.5.1",N/A,N/A,TRUE,,,,,,,
vsan-8.data-in-transit,VMware vSAN,8,VMware vSAN,8.0.3,Base,P0,vSAN must protect storage-related network communications.,"vSAN Data-in-Transit encryption helps ensure that sensitive data remains confidential while traversing the network, reducing the risk of unauthorized access or interception. This configuration parameter can be altered while the cluster is operational.",N/A,Disabled,Enabled,NO,Modify,"vSAN Configuration,
Data Services","All encryption comes at the cost of CPU cycles and potential storage latency. How much this impacts workloads depends on a variety of factors, such as the configuration of the underlying hardware and the type and frequency of storage I/O by the workload.",N/A,N/A,FALSE,FALSE,N/A,N/A,N/A,"3.3.2
3.3.3
3.5.1",N/A,N/A,TRUE,,,,,,,
vsan-8.file-services-access-control-nfs,VMware vSAN,8,VMware vSAN,8.0.3,File Service - NFS,"P0
Upon Feature Enablement",NFS file shares on vSAN File Services must be configured to restrict access.,"When configuring an NFS file share the ""Customize net access"" option should be selected with a restrictive set of permissions configured.",N/A,No Access,Customize Net Access,NO,Modify,vSAN File Share Configuration,Loss of connectivity to clients.,N/A,N/A,FALSE,FALSE,N/A,N/A,N/A,"3.3.2
3.3.3
3.5.1",N/A,N/A,TRUE,,,,,,,
vsan-8.file-services-authentication-smb,VMware vSAN,8,VMware vSAN,8.0.3,File Service - SMB,"P0
Upon Feature Enablement",SMB file shares on vSAN File Services must accept only encrypted SMB authentication communications. ,When configuring an SMB file share the Protocol Encryption option must be enabled.,N/A,Disabled,Enabled,NO,Modify,vSAN File Share Configuration,None.,N/A,N/A,FALSE,FALSE,N/A,N/A,N/A,3.6.1,N/A,N/A,TRUE,,,,,,,
vsan-8.force-provisioning,VMware vSAN,8,VMware vSAN,8.0.3,Base,P2,vSAN must not provision storage when storage policy requirements cannot be met.,"If the storage policy ""Force Provisioning"" option is set to Yes, the object is provisioned even if the Failures to tolerate, Number of disk stripes per object, and Flash read cache reservation policies specified in the storage policy cannot be satisfied by the datastore. While this might be helpful in bootstrapping scenarios and during an outage when standard provisioning is no longer possible, normal operations should not permit storage policy violations.",N/A,Disabled,Disabled,YES,Audit,"Policies and Profiles,
VM Storage Policies",None,N/A,N/A,FALSE,FALSE,N/A,N/A,N/A,N/A,N/A,N/A,TRUE,,,,,,,
vsan-8.iscsi-mutual-chap,VMware vSAN,8,VMware vSAN,8.0.3,iSCSI Target,"P0
Upon Feature Enablement",vSAN iSCSI target must enable bidirectional/mutual CHAP authentication.,"Mutual CHAP provides an additional layer of protection by requiring both the initiator (client) and the target (server) to verify their identities to each other, thereby ensuring data transmitted between the two is not intercepted or altered by unauthorized entities.",N/A,Disabled,Enabled,NO,Modify,vSAN iSCSI Target Configuration,May be more difficult to configure clients.,N/A,N/A,FALSE,FALSE,N/A,N/A,N/A,3.6.1,N/A,N/A,TRUE,,,,,,,
vsan-8.object-checksum,VMware vSAN,8,VMware vSAN,8.0.3,Base,P2,vSAN must calculate object checksums to protect data integrity.,"vSAN uses end-to-end checksum to ensure the integrity of data by confirming that each copy of a file is exactly the same as the source file. The system checks the validity of the data during read/write operations, and if an error is detected, vSAN repairs the data or reports the error. Integrity problems cannot be detected if the vSAN policy disables checksums. For vSAN Express Storage Architecture, object checksums are always computed, and cannot be deactivated.",N/A,Disabled,Disabled,YES,Audit,"Policies and Profiles,
VM Storage Policies",None,N/A,N/A,FALSE,FALSE,N/A,N/A,N/A,N/A,N/A,N/A,TRUE,,,,,,,
vsan-8.operations-reserve,VMware vSAN,8,VMware vSAN,8.0.3,Base,P0,vSAN must reserve space to complete internal maintenance operations.,vSAN Operations Reserve capacity setting helps ensure that vSAN always has sufficient free space to maintain the availability and reliability of the vSAN datastore and prevent potential data loss or service disruptions due to insufficient capacity during operations like policy changes. This configuration parameter can be altered while the cluster is operational.,N/A,Disabled,Enabled,NO,Modify,"vSAN Configuration,
Reservations and Alerts",Enabling this will reduce the usable capacity of the vSAN datastore.,N/A,N/A,FALSE,FALSE,N/A,N/A,N/A,N/A,N/A,N/A,TRUE,,,,,,,
