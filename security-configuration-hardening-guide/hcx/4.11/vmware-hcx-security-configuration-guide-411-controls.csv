SCG ID,"Secure Controls
Framework ID",DISA STIG ID,PCI DSS 4.0.1 ID,"Component
Name",Component Version,Feature/Function,Description/Title,Discussion,Potential Functional Impact if Default Value is Changed,"Implementation
Priority",Configuration Parameter,Installation Default Value,Baseline Suggested Value,Is the Default?,Action Needed,Setting Location,PowerCLI Command Assessment,PowerCLI Command Remediation
hcx-4.log-forwarding,"MON-01, MON-01.2, MON-01.4, MON-02, MON-03",N/A,"10.2.1
10.3.3",HCX,4.11.3,Base,HCX Appliances Must Configure Log Forwarding,"All HCX appliances (Manager, Connector, and Service Mesh appliances) should be configured to forward their logs to a central, remote syslog server (e.g., VCF Operations for Logs or another SIEM solution). This ensures logs are preserved and aggregated for analysis. This is configured in the VAMI of the HCX Manager/Connector.",None.,P0,"VAMI, Syslog",Not Configured,Site-Specific Log Server,NO,Modify,HCX Manager Virtual Appliance Management Interface [HCX VAMI (https://<hcx-fqdn>:9443)],"(Get-CisService -Name ""com.vmware.appliance.logging.forwarding"").get()",N/A
hcx-4.login-message,SEA-18,N/A,2.2.6,HCX,4.11.3,Base,HCX Appliances Must Configure Login Banner,"A login banner should be configured for all HCX appliances (Manager and Connector) for both UI and SSH access. This banner should display an appropriate legal notice and warning, stating that the system is for authorized use only.",None.,P1,"""Details of Login Message"" [Login Banner (UI and SSH)]",Not Configured,Text containing an appropriate legal notice and warning for authorized use.,YES,Audit,"For VAMI UI: Edit the file /etc/vmware/welcome on the appliance. 
For SSH: Edit the file /etc/issue.net on the HCX Mgr appliance",N/A,N/A
hcx-4.migration-service-encryption,"NET-14.2, CRY-01, CRY-03, CRY-01.1, CRY-04",N/A,"2.2.7
4.2.1",HCX,4.11.3,Interconnect (IX),HCX Migration Service Must Enable Encryption,"HCX Migration Service  traffic between the source and destination Interconnext (IX) appliances can be encrypted. This setting, configured per Service Mesh, enables Suite-B cryptography encryption to secure data transfer between the site pairs.",Enabling migration service encryption increases CPU usage on the HCX Interconnect appliances.,P0,Migration Service Encryption (Service Mesh),Disabled for Private Network. Enabled for Public Network.,Verify that encryption is enabled when creating a Service Mesh. If not Enable encryption.,NO,Modify,HCX Manager Service Mesh Feature,N/A,N/A
hcx-4.network-extension-encryption,"NET-14.2, CRY-01, CRY-03, CRY-01.1, CRY-04",N/A,"2.2.7
4.2.1",HCX,4.11.3,Network Extension (NE),HCX Network Extension Must Enable Encryption,"HCX Network Extension (L2 stretch) traffic between the source and destination Network Extension (NE) appliances can be encrypted. This setting, configured per Service Mesh, enables Suite-B IPsec encryption for all stretched network traffic.",Enabling network extension encryption increases CPU usage on the HCX Network Extension appliances.,P0,Network Extension Encryption (IPsec),Disabled for Private Network. Enabled for Public Network.,Verify that encryption is enabled when creating a Service Mesh. If not Enable encryption.,NO,Modify,HCX Manager Service Mesh Feature,N/A,N/A
hcx-4.service-resilience-ne,BCD-02.2,N/A,2.2.6,HCX,4.11.3,Network Extension,HCX Service Mesh Should Enable High Availability (HA),"HCX Service Mesh appliances (e.g., Network Extension, Interconnect) can be deployed in a High Availability (HA) configuration. This pairs an active appliance with a standby, which takes over if the active one fails.",None.,P0,HCX Service Mesh High Availability (HA),Not Enabled ,Enable the High Availability (HA) option when creating or editing a Service Mesh.,NO,Modify,HCX Manager Service Mesh Feature,N/A,N/A
hcx-4.ssh,"CFG-03, NET-14.8, IAC-16, NET-14.2",N/A,2.2.4,HCX,4.11.3,Base,HCX Appliances Must Secure or Disable SSH,"The SSH service on the HCX Manager and Connector appliances is enabled by default for troubleshooting. For a hardened environment, SSH should be disabled if not actively needed, or secured by using key-based authentication and disabling root login.",None.,P0,SSH Service,Enabled,Deactivated,NO,Modify,HCX Manager Virtual Appliance Management Interface [HCX VAMI (https://<hcx-fqdn>:9443)],N/A,N/A
hcx-4.supported,"VPM-04, VPM-04.1, VPM-05",N/A,6.3.3,HCX,4.11.3,Base,HCX Components Must Maintain Support and Version Interoperability,"All HCX components (Manager, Connector) and their paired VMware Cloud Foundation components (vCenter, ESX, NSX) must be running versions that are on the official VMware Cloud Foundation Product Interoperability Matrix.",None.,P0,Component Version & Interoperability,N/A,"All components (HCX, vCenter, NSX) must be on the Supported Product Interoperability Matrix.",NO,Modify,HCX Manager Virtual Appliance Management Interface to get current version information.,N/A,N/A
hcx-4.time,"MON-07.1, SEA-20",N/A,"10.6.1
10.6.2",HCX,4.11.3,Base,HCX Appliances Must Synchronize Clocks Using NTP,"All HCX appliances (Manager and Connector) and all related VMware Cloud Foundation components must have their clocks synchronized to a reliable, central Network Time Protocol (NTP) server.",None.,P0,NTP Server Configuration,Not Configured,Site-Specific,NO,Modify,HCX Manager Virtual Appliance Management Interface [HCX VAMI (https://<hcx-fqdn>:9443)],N/A,N/A
hcx-4.vami-account-lockout-duration,"IAC-22, IAC-10, IAC-10.1",N/A,8.3.4,HCX,4.11.3,Base,HCX Appliances Must Configure Account Lockout Duration,"This setting defines the period, in seconds, that an HCX appliance (Manager and Connector) user account remains locked after the maximum number of failed login attempts is exceeded. This applies to the admin and root user accounts for the appliance's OS and VAMI. Use following command> sed -i 's/^unlock_time.*/unlock_time = 0/' /etc/security/faillock.conf","Changes to password settings on the appliances may impact connectivity of other solutions, and may negatively impact automated deployment of subordinate HCX components, and will need to be reconfigured after an update or upgrade.",Advanced,unlock_time,86400,0,NO,Modify,/etc/security/faillock.conf,N/A,N/A
hcx-4.vami-account-lockout-max-attempts,"IAC-22, IAC-10, IAC-10.1",N/A,8.3.4,HCX,4.11.3,Base,HCX Appliances Must Configure Maximum Failed Login Attempts,This setting specifies the number of consecutive failed login attempts allowed for an HCX appliance (Manager or Connector) user account before the account is locked. This applies to both the admin and root user accounts.,"Changes to password settings on the appliances may impact connectivity of other solutions, and may negatively impact automated deployment of subordinate HCX components, and will need to be reconfigured after an update or upgrade.",Advanced,deny,3,3,YES,Audit,/etc/security/faillock.conf,N/A,N/A
hcx-4.vami-account-lockout-reset,"IAC-22, IAC-10",N/A,8.3.4,HCX,4.11.3,Base,HCX Appliances Must Configure Account Lockout Reset Timer,"This setting defines the time in seconds after which the failed login attempt counter is reset to zero. This works in conjunction with the account-lockout-max-attempts setting to prevent ""low and slow"" brute-force attacks.  [use following command> sed -i 's/^fail_interval.*/fail_interval = 900/' /etc/security/faillock.conf]","Changes to password settings on the appliances may impact connectivity of other solutions, and may negatively impact automated deployment of subordinate HCX components, and will need to be reconfigured after an update or upgrade.",Advanced,/etc/security/faillock.conf,NA,900,NO,Modify,/etc/security/faillock.conf,N/A,N/A
hcx-4.vami-password-complexity,IAC-10.1,N/A,"8.3.1
8.3.6",HCX,4.11.3,Base,HCX Appliances Must Enforce Password Complexity,"The HCX Manager appliance (Cloud and Connector) OS enforces complexity rules for local user accounts (admin, root). These rules should be configured to require a minimum length and a mix of uppercase, lowercase, numbers, and special characters.","Changes to password settings on the appliances may impact connectivity of other solutions, and may negatively impact automated deployment of subordinate HCX components, and will need to be reconfigured after an update or upgrade.",Advanced,"Maximum Length,
Minimum Length,
Character Requirements","Minimum Length: 8
At least 1 special 
At least 1 uppercase
At least 1 lowercase
At least 1 numeric
","Maximum Length: 64
Minimum Length: 15
At least 1 special 
At least 1 uppercase
At least 1 lowercase
At least 1 numeric",NO,Modify,/etc/security/pwquality.conf,N/A,N/A
hcx-4.vami-password-history,IAC-10.1,N/A,8.3.7,HCX,4.11.3,Base,HCX Appliances Must Enforce Password History,"This setting, configured in the appliance's OS, defines the number of previous passwords to remember for local users (admin, root). This prevents users from reusing recent passwords when a change is forced. [run following command to confirm: cat /etc/pam.d/system-password]","Changes to password settings on the appliances may impact connectivity of other solutions, and may negatively impact automated deployment of subordinate HCX components, and will need to be reconfigured after an update or upgrade.",Advanced,remember,5,5,YES,Audit,/etc/pam.d/system-password,N/A,N/A
hcx-4.vami-password-max-age,IAC-10.1,N/A,8.3.9,HCX,4.11.3,Base,HCX Appliances Must Configure Password Maximum Age,"This setting defines the maximum number of days for which a local user account password (admin, root) on the HCX appliance remains valid. This forces regular password rotation, limiting the risk of a compromised password. Command to test for admin user> chage -l admin and for root user chage -l root","Changes to password settings on the appliances may impact connectivity of other solutions, and may negatively impact automated deployment of subordinate HCX components, and will need to be reconfigured after an update or upgrade.",Advanced,Password expires,99999,99999,YES,Modify,cli,N/A,N/A
hcx-4.vami-updates,"VPM-04, VPM-04.1, VPM-05",N/A,6.3.3,HCX,4.11.3,Base,HCX Appliances Must Manage Updates and Patches,HCX appliance updates (for Manager and Connector) are managed via the appliance VAMI (port 9443). Administrators should regularly check for and apply the latest security patches and updates from the official VMware Cloud Foundation repository.,None.,P0,Product Version & Build Number (Appliance Updates),N/A,Regularly check for and apply security patches and updates,NO,Modify,HCX Manager Virtual Appliance Management Interface [HCX VAMI (https://<hcx-fqdn>:9443)],N/A,N/A
